<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Auxeira ESG Education Impact Dashboard</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns/dist/chartjs-adapter-date-fns.bundle.min.js"></script>
    <script src="https://js.paystack.co/v1/inline.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <style>
        :root {
            --terminal-dark: #0a0a0a;
            --terminal-darker: #050505;
            --terminal-blue: #00d4ff;
            --terminal-purple: #8b5cf6;
            --terminal-green: #00ff88;
            --terminal-gold: #ffd700;
            --terminal-white: #ffffff;
            --terminal-gray: #666666;
            --glass-bg: rgba(255, 255, 255, 0.05);
            --glass-border: rgba(255, 255, 255, 0.1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, var(--terminal-dark) 0%, var(--terminal-darker) 100%);
            color: var(--terminal-white);
            min-height: 100vh;
            overflow-x: hidden;
        }

        .terminal-header {
            background: var(--glass-bg);
            backdrop-filter: blur(20px);
            border-bottom: 1px solid var(--glass-border);
            padding: 1rem 2rem;
            position: sticky;
            top: 0;
            z-index: 1000;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            font-size: 1.8rem;
            font-weight: bold;
            background: linear-gradient(45deg, var(--terminal-blue), var(--terminal-purple));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .profile-completion {
            background: var(--glass-bg);
            border: 1px solid var(--glass-border);
            border-radius: 20px;
            padding: 0.5rem 1rem;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .profile-completion:hover {
            background: var(--terminal-blue);
            color: var(--terminal-dark);
        }

        .data-refresh {
            font-size: 0.8rem;
            opacity: 0.7;
            color: var(--terminal-green);
        }

        .main-container {
            display: flex;
            min-height: calc(100vh - 80px);
        }

        .sidebar {
            width: 280px;
            background: var(--glass-bg);
            backdrop-filter: blur(20px);
            border-right: 1px solid var(--glass-border);
            padding: 2rem 0;
            position: sticky;
            top: 80px;
            height: calc(100vh - 80px);
            overflow-y: auto;
        }

        .nav-item {
            padding: 1rem 2rem;
            cursor: pointer;
            transition: all 0.3s ease;
            border-left: 3px solid transparent;
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .nav-item:hover, .nav-item.active {
            background: var(--glass-bg);
            border-left-color: var(--terminal-blue);
            color: var(--terminal-blue);
        }

        .content-area {
            flex: 1;
            padding: 2rem;
            overflow-y: auto;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
            animation: fadeIn 0.5s ease-in-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .glass-card {
            background: var(--glass-bg);
            backdrop-filter: blur(20px);
            border: 1px solid var(--glass-border);
            border-radius: 16px;
            padding: 2rem;
            margin-bottom: 2rem;
            transition: all 0.3s ease;
        }

        .glass-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 40px rgba(0, 212, 255, 0.1);
        }

        .hero-impact {
            text-align: center;
            padding: 3rem 0;
            background: linear-gradient(135deg, var(--terminal-blue), var(--terminal-purple));
            border-radius: 20px;
            margin-bottom: 3rem;
            position: relative;
            overflow: hidden;
        }

        .hero-impact::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><defs><pattern id="grid" width="10" height="10" patternUnits="userSpaceOnUse"><path d="M 10 0 L 0 0 0 10" fill="none" stroke="rgba(255,255,255,0.1)" stroke-width="0.5"/></pattern></defs><rect width="100" height="100" fill="url(%23grid)"/></svg>');
            opacity: 0.3;
        }

        .hero-content {
            position: relative;
            z-index: 2;
        }

        .impact-number {
            font-size: 4rem;
            font-weight: bold;
            color: var(--terminal-white);
            text-shadow: 0 0 20px rgba(255, 255, 255, 0.5);
        }

        .impact-label {
            font-size: 1.2rem;
            opacity: 0.9;
            margin-top: 0.5rem;
        }

        .story-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 2rem;
            margin: 2rem 0;
        }

        .story-card {
            background: var(--glass-bg);
            border: 1px solid var(--glass-border);
            border-radius: 16px;
            padding: 2rem;
            transition: all 0.3s ease;
            cursor: pointer;
            position: relative;
            overflow: hidden;
        }

        .story-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 4px;
            height: 100%;
            background: linear-gradient(45deg, var(--terminal-blue), var(--terminal-purple));
        }

        .story-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 20px 40px rgba(139, 92, 246, 0.2);
        }

        .story-title {
            font-size: 1.3rem;
            font-weight: bold;
            margin-bottom: 1rem;
            color: var(--terminal-blue);
        }

        .story-content {
            line-height: 1.6;
            margin-bottom: 1.5rem;
        }

        .story-metrics {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding-top: 1rem;
            border-top: 1px solid var(--glass-border);
        }

        .metric-item {
            text-align: center;
        }

        .metric-value {
            font-size: 1.5rem;
            font-weight: bold;
            color: var(--terminal-green);
        }

        .metric-label {
            font-size: 0.9rem;
            opacity: 0.7;
        }

        .chart-container {
            background: var(--glass-bg);
            border-radius: 16px;
            padding: 2rem;
            margin: 2rem 0;
            position: relative;
        }

        .chart-title {
            font-size: 1.4rem;
            font-weight: bold;
            margin-bottom: 1.5rem;
            color: var(--terminal-blue);
            text-align: center;
        }

        .btn-primary {
            background: linear-gradient(45deg, var(--terminal-blue), var(--terminal-purple));
            border: none;
            border-radius: 25px;
            padding: 0.8rem 2rem;
            font-weight: bold;
            transition: all 0.3s ease;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(0, 212, 255, 0.3);
        }

        .btn-premium {
            background: linear-gradient(45deg, var(--terminal-gold), #ff6b35);
            border: none;
            border-radius: 25px;
            padding: 0.8rem 2rem;
            font-weight: bold;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .btn-premium::before {
            content: '👑';
            margin-right: 0.5rem;
        }

        .btn-premium:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(255, 215, 0, 0.3);
        }

        .premium-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(10px);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            border-radius: 16px;
            z-index: 10;
        }

        .premium-lock {
            font-size: 3rem;
            color: var(--terminal-gold);
            margin-bottom: 1rem;
        }

        .premium-text {
            text-align: center;
            margin-bottom: 2rem;
        }

        .opportunity-card {
            background: var(--glass-bg);
            border: 1px solid var(--glass-border);
            border-radius: 16px;
            padding: 1.5rem;
            margin-bottom: 1rem;
            transition: all 0.3s ease;
        }

        .opportunity-card:hover {
            transform: translateX(10px);
            border-color: var(--terminal-blue);
        }

        .opportunity-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }

        .opportunity-title {
            font-size: 1.2rem;
            font-weight: bold;
            color: var(--terminal-blue);
        }

        .compatibility-score {
            background: var(--terminal-green);
            color: var(--terminal-dark);
            padding: 0.3rem 0.8rem;
            border-radius: 20px;
            font-weight: bold;
            font-size: 0.9rem;
        }

        .opportunity-details {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 1rem;
            margin-bottom: 1rem;
        }

        .opportunity-metric {
            text-align: center;
        }

        .opportunity-metric-value {
            font-size: 1.1rem;
            font-weight: bold;
            color: var(--terminal-white);
        }

        .opportunity-metric-label {
            font-size: 0.8rem;
            opacity: 0.7;
        }

        .portfolio-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
            margin: 2rem 0;
        }

        .portfolio-item {
            background: var(--glass-bg);
            border: 1px solid var(--glass-border);
            border-radius: 16px;
            padding: 1.5rem;
            transition: all 0.3s ease;
        }

        .portfolio-item:hover {
            transform: scale(1.02);
            box-shadow: 0 15px 30px rgba(0, 212, 255, 0.1);
        }

        .portfolio-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }

        .company-name {
            font-size: 1.2rem;
            font-weight: bold;
            color: var(--terminal-blue);
        }

        .health-indicator {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: var(--terminal-green);
        }

        .health-indicator.warning {
            background: var(--terminal-gold);
        }

        .health-indicator.danger {
            background: #ff4757;
        }

        .portfolio-metrics {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 1rem;
            margin-bottom: 1rem;
        }

        /* Leaderboard Improvements */
        .leaderboard-item {
            display: flex;
            align-items: center;
            padding: 1.5rem;
            background: var(--glass-bg);
            border: 1px solid var(--glass-border);
            border-radius: 12px;
            margin-bottom: 1rem;
            transition: all 0.3s ease;
            color: var(--terminal-white);
        }

        .leaderboard-item:hover {
            background: rgba(0, 212, 255, 0.1);
        }

        .rank-number {
            font-size: 1.8rem;
            font-weight: bold;
            color: var(--terminal-gold);
            margin-right: 1.5rem;
            min-width: 50px;
            text-align: center;
        }

        .rank-change {
            margin-left: auto;
            font-size: 1.2rem;
            font-weight: bold;
        }

        .rank-up {
            color: var(--terminal-green);
        }

        .rank-down {
            color: #ff4757;
        }

        .rank-same {
            color: var(--terminal-gray);
        }

        .leaderboard-user {
            flex: 1;
        }

        .leaderboard-user-name {
            font-size: 1.2rem;
            font-weight: bold;
            margin-bottom: 0.3rem;
            color: var(--terminal-white);
        }

        .leaderboard-user-details {
            font-size: 0.9rem;
            color: var(--terminal-gray);
        }

        .collaboration-card {
            background: var(--glass-bg);
            border: 1px solid var(--glass-border);
            border-radius: 16px;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            transition: all 0.3s ease;
        }

        .collaboration-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 30px rgba(139, 92, 246, 0.2);
        }

        .collab-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }

        .collab-title {
            font-size: 1.2rem;
            font-weight: bold;
            color: var(--terminal-purple);
        }

        .alignment-score {
            background: var(--terminal-purple);
            color: var(--terminal-white);
            padding: 0.3rem 0.8rem;
            border-radius: 20px;
            font-weight: bold;
            font-size: 0.9rem;
        }

        /* Collaboration Zone - Events Section */
        .collaboration-header {
            display: flex;
            align-items: center;
            margin-bottom: 1.5rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid var(--glass-border);
        }

        .collaboration-icon {
            font-size: 1.5rem;
            color: var(--terminal-blue);
            margin-right: 1rem;
        }

        .collaboration-title {
            font-size: 1.4rem;
            font-weight: bold;
            color: var(--terminal-white);
        }

        .discussion-item {
            display: flex;
            padding: 1.2rem;
            background: var(--glass-bg);
            border-radius: 12px;
            margin-bottom: 1rem;
            transition: all 0.3s ease;
            border-left: 3px solid transparent;
        }

        .discussion-item:hover {
            background: rgba(0, 212, 255, 0.05);
            border-left-color: var(--terminal-blue);
        }

        .discussion-avatar {
            font-size: 1.8rem;
            margin-right: 1rem;
            width: 50px;
            text-align: center;
        }

        .discussion-content {
            flex: 1;
        }

        .discussion-author {
            font-weight: bold;
            font-size: 1.1rem;
            color: var(--terminal-blue);
            margin-bottom: 0.3rem;
        }

        .discussion-text {
            color: var(--terminal-white);
            margin-bottom: 0.5rem;
            line-height: 1.4;
        }

        .discussion-meta {
            font-size: 0.85rem;
            color: var(--terminal-gray);
        }

        .event-match-score {
            background: var(--terminal-green);
            color: var(--terminal-dark);
            padding: 0.2rem 0.6rem;
            border-radius: 12px;
            font-size: 0.8rem;
            font-weight: bold;
            margin-left: 0.5rem;
        }

        .event-ai-recommendation {
            font-size: 0.85rem;
            color: var(--terminal-blue);
            margin-top: 0.3rem;
            font-style: italic;
        }

        .report-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 2rem;
            margin: 2rem 0;
        }

        .report-card {
            background: var(--glass-bg);
            border: 1px solid var(--glass-border);
            border-radius: 16px;
            padding: 2rem;
            transition: all 0.3s ease;
            position: relative;
            cursor: pointer;
        }

        .report-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 40px rgba(0, 212, 255, 0.1);
        }

        .report-title {
            font-size: 1.3rem;
            font-weight: bold;
            color: var(--terminal-blue);
            margin-bottom: 1rem;
        }

        .report-description {
            line-height: 1.6;
            margin-bottom: 1.5rem;
            opacity: 0.9;
        }

        .report-price {
            font-size: 1.2rem;
            font-weight: bold;
            color: var(--terminal-gold);
            margin-bottom: 1rem;
        }

        .free-badge {
            background: var(--terminal-green);
            color: var(--terminal-dark);
            padding: 0.3rem 0.8rem;
            border-radius: 20px;
            font-weight: bold;
            font-size: 0.9rem;
        }

        .premium-badge {
            background: var(--terminal-gold);
            color: var(--terminal-dark);
            padding: 0.3rem 0.8rem;
            border-radius: 20px;
            font-weight: bold;
            font-size: 0.9rem;
        }

        .tag {
            font-size: 0.8rem;
            padding: 0.2rem 0.6rem;
            border-radius: 12px;
            margin-right: 0.5rem;
            margin-bottom: 0.5rem;
            display: inline-block;
        }

        .tag-narrative { background: rgba(0, 255, 136, 0.2); color: var(--terminal-green); }
        .tag-sdg { background: rgba(0, 212, 255, 0.2); color: var(--terminal-blue); }
        .tag-peer { background: rgba(139, 92, 246, 0.2); color: var(--terminal-purple); }
        .tag-benchmarking { background: rgba(0, 212, 255, 0.2); color: var(--terminal-blue); }
        .tag-gri { background: rgba(0, 212, 255, 0.2); color: var(--terminal-blue); }
        .tag-iris { background: rgba(139, 92, 246, 0.2); color: var(--terminal-purple); }
        .tag-tcfd { background: rgba(255, 69, 58, 0.2); color: #ff453a; }
        .tag-sasb { background: rgba(255, 159, 10, 0.2); color: #ff9f0a; }
        .tag-sdg17 { background: rgba(139, 92, 246, 0.2); color: var(--terminal-purple); }
        .tag-unesco { background: rgba(0, 212, 255, 0.2); color: var(--terminal-blue); }
        .tag-quantitative { background: rgba(0, 255, 136, 0.2); color: var(--terminal-green); }
        .tag-multi-sdg { background: rgba(139, 92, 246, 0.2); color: var(--terminal-purple); }
        .tag-cdp { background: rgba(0, 212, 255, 0.2); color: var(--terminal-blue); }
        .tag-morningstar { background: rgba(139, 92, 246, 0.2); color: var(--terminal-purple); }
        .tag-sfdr { background: rgba(255, 69, 58, 0.2); color: #ff453a; }
        .tag-ifrs { background: rgba(255, 159, 10, 0.2); color: #ff9f0a; }
        .tag-risk { background: rgba(255, 69, 58, 0.2); color: #ff453a; }
        .tag-esg { background: rgba(0, 255, 136, 0.2); color: var(--terminal-green); }
        .tag-benchmarked { background: rgba(0, 212, 255, 0.2); color: var(--terminal-blue); }

        .modal {
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(10px);
        }

        .modal-content {
            background: var(--terminal-dark);
            border: 1px solid var(--glass-border);
            border-radius: 16px;
            color: var(--terminal-white);
        }

        .modal-header {
            border-bottom: 1px solid var(--glass-border);
        }

        .modal-footer {
            border-top: 1px solid var(--glass-border);
        }

        .form-control {
            background: var(--glass-bg);
            border: 1px solid var(--glass-border);
            color: var(--terminal-white);
            border-radius: 8px;
        }

        .form-control:focus {
            background: var(--glass-bg);
            border-color: var(--terminal-blue);
            color: var(--terminal-white);
            box-shadow: 0 0 0 0.2rem rgba(0, 212, 255, 0.25);
        }

        .form-select {
            background: var(--glass-bg);
            border: 1px solid var(--glass-border);
            color: var(--terminal-white);
        }

        .form-select:focus {
            background: var(--glass-bg);
            border-color: var(--terminal-blue);
            color: var(--terminal-white);
            box-shadow: 0 0 0 0.2rem rgba(0, 212, 255, 0.25);
        }

        .progress {
            background: var(--glass-bg);
            border-radius: 10px;
            height: 8px;
        }

        .progress-bar {
            background: linear-gradient(45deg, var(--terminal-blue), var(--terminal-purple));
            border-radius: 10px;
        }

        .actuarial-calculator {
            background: var(--glass-bg);
            border: 1px solid var(--glass-border);
            border-radius: 16px;
            padding: 2rem;
            margin: 2rem 0;
        }

        .calculator-controls {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin-bottom: 2rem;
        }

        .control-group {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .control-label {
            font-weight: bold;
            color: var(--terminal-blue);
        }

        .slider {
            -webkit-appearance: none;
            width: 100%;
            height: 6px;
            border-radius: 3px;
            background: var(--glass-bg);
            outline: none;
        }

        .slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: var(--terminal-blue);
            cursor: pointer;
        }

        .slider::-moz-range-thumb {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: var(--terminal-blue);
            cursor: pointer;
            border: none;
        }

        /* Report Generation Status */
        #report-status {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            backdrop-filter: blur(10px);
            z-index: 9999;
            justify-content: center;
            align-items: center;
        }

        .report-status-content {
            background: var(--glass-bg);
            border: 1px solid var(--glass-border);
            border-radius: 16px;
            padding: 3rem;
            text-align: center;
            max-width: 500px;
            width: 90%;
        }

        .ai-thinking {
            font-size: 4rem;
            margin-bottom: 1.5rem;
        }

        .countdown-timer {
            font-size: 3rem;
            font-weight: bold;
            color: var(--terminal-blue);
            margin-bottom: 1rem;
        }

        .progress-container {
            width: 100%;
            background: var(--glass-bg);
            border-radius: 10px;
            height: 10px;
            margin: 1.5rem 0;
            overflow: hidden;
        }

        #progress-bar {
            height: 100%;
            background: linear-gradient(45deg, var(--terminal-blue), var(--terminal-purple));
            width: 0%;
            transition: width 0.3s ease;
        }

        @media (max-width: 768px) {
            .main-container {
                flex-direction: column;
            }

            .sidebar {
                width: 100%;
                height: auto;
                position: static;
                order: 2;
            }

            .content-area {
                order: 1;
                padding: 1rem;
            }

            .terminal-header {
                padding: 1rem;
                flex-direction: column;
                gap: 1rem;
            }

            .user-info {
                width: 100%;
                justify-content: space-between;
            }

            .story-grid, .portfolio-grid, .report-grid {
                grid-template-columns: 1fr;
            }

            .impact-number {
                font-size: 2.5rem;
            }

            .calculator-controls {
                grid-template-columns: 1fr;
            }

            .report-status-content {
                padding: 2rem;
                margin: 1rem;
            }

            .ai-thinking {
                font-size: 3rem;
            }

            .countdown-timer {
                font-size: 2rem;
            }
        }

        /* High contrast mode for accessibility */
        @media (prefers-contrast: high) {
            :root {
                --glass-bg: rgba(255, 255, 255, 0.15);
                --glass-border: rgba(255, 255, 255, 0.3);
            }
        }

        /* Reduced motion for accessibility */
        @media (prefers-reduced-motion: reduce) {
            *, *::before, *::after {
                animation-duration: 0.01ms !important;
                animation-iteration-count: 1 !important;
                transition-duration: 0.01ms !important;
            }
        }
    </style>
</head>
<body>
    <!-- Terminal Header -->
    <div class="terminal-header">
        <div class="logo">
            <i class="fas fa-chart-line"></i> Auxeira ESG Education
        </div>
        <div class="user-info">
            <div class="profile-completion" onclick="showProfileModal()">
                <i class="fas fa-user-circle"></i>
                Profile: 65% Complete
                <div class="progress mt-1">
                    <div class="progress-bar" style="width: 65%"></div>
                </div>
            </div>
            <div class="data-refresh">
                <i class="fas fa-sync-alt"></i>
                Data Refreshed: <span id="lastUpdate">2 hours ago</span>
            </div>
        </div>
    </div>

    <!-- Main Container -->
    <div class="main-container">
        <!-- Sidebar Navigation -->
        <div class="sidebar">
            <div class="nav-item active" onclick="showTab('overview')">
                <i class="fas fa-tachometer-alt"></i>
                <span>Overview</span>
            </div>
            <div class="nav-item" onclick="showTab('opportunity-ripple')">
                <i class="fas fa-handshake"></i>
                <span>Opportunity Ripple</span>
            </div>
            <div class="nav-item" onclick="showTab('portfolio')">
                <i class="fas fa-briefcase"></i>
                <span>Portfolio</span>
            </div>
            <div class="nav-item" onclick="showTab('leaderboard')">
                <i class="fas fa-trophy"></i>
                <span>Leaderboard</span>
            </div>
            <div class="nav-item" onclick="showTab('collaboration')">
                <i class="fas fa-users"></i>
                <span>Collaboration Zone</span>
            </div>
            <div class="nav-item" onclick="showTab('reports')">
                <i class="fas fa-file-alt"></i>
                <span>Impact Reports</span>
            </div>
        </div>

        <!-- Content Area -->
        <div class="content-area">
            <!-- Overview Tab -->
            <div id="overview" class="tab-content active">
                <!-- Hero Impact Section -->
                <div class="hero-impact">
                    <div class="hero-content">
                        <div class="impact-number" id="heroImpactNumber">285,000</div>
                        <div class="impact-label">Lives Transformed Through Education</div>
                        <div class="mt-3">
                            <span style="font-size: 1.1rem; opacity: 0.9;">Your R2.4M Investment • 5.8x Impact ROI • 94% Literacy Improvement</span>
                        </div>
                    </div>
                </div>

                <!-- Visual Analytics Section -->
                <div class="row mb-4">
                    <div class="col-md-6">
                        <div class="chart-container">
                            <div class="chart-title">Students Reached by Region</div>
                            <canvas id="regionChart" aria-label="Bar chart showing students reached by region"></canvas>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="chart-container">
                            <div class="chart-title">Impact ROI Trends (3 Years)</div>
                            <canvas id="roiChart" aria-label="Line chart showing ROI trends over 3 years"></canvas>
                        </div>
                    </div>
                </div>

                <!-- Impact Report Teaser -->
                <div class="glass-card">
                    <div class="d-flex justify-content-between align-items-center mb-3">
                        <h3 style="color: var(--terminal-blue);">
                            <i class="fas fa-heart"></i> Impact Report
                        </h3>
                        <span class="badge bg-warning text-dark">Premium Feature</span>
                    </div>
                    <div class="row">
                        <div class="col-md-8">
                            <p class="mb-3">Are you maximizing learning outcomes? Our Impact Report reveals untapped opportunities in your education portfolio, mapping clear actionable strategies for 2024.</p>
                            <div class="mb-3">
                                <strong>What's New:</strong> 
                                <ul class="mt-2">
                                    <li>12 new partnership opportunities identified</li>
                                    <li>3 underperforming programs with 40% improvement potential</li>
                                    <li>Regional expansion into Nigeria showing 200% ROI potential</li>
                                </ul>
                            </div>
                            <div class="mb-3">
                                <strong>What's Next:</strong> Strategic recommendations for Q1 2024 based on UNESCO frameworks and real-time policy changes.
                            </div>
                        </div>
                        <div class="col-md-4 text-center">
                            <div style="filter: blur(3px); opacity: 0.7;">
                                <canvas id="previewChart" width="200" height="150"></canvas>
                            </div>
                            <button class="btn btn-premium mt-3" onclick="showPremiumModal('impact-report')">
                                Unlock Full Report - $149
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Living Stories Grid -->
                <div class="story-grid">
                    <div class="story-card" onclick="playStoryAudio('nomsa')">
                        <div class="story-title">Gates Foundation Empowers Nomsa's Teaching Revolution in South Africa</div>
                        <div class="story-content">
                            From a rural classroom with 45 students and no electricity, Nomsa Mthembu transformed into a digital literacy champion. Through your education investment, she now trains 200+ teachers monthly using solar-powered tablets, reaching 12,000 students across KwaZulu-Natal.
                        </div>
                        <div class="story-metrics">
                            <div class="metric-item">
                                <div class="metric-value">12,000</div>
                                <div class="metric-label">Students Reached</div>
                            </div>
                            <div class="metric-item">
                                <div class="metric-value">200+</div>
                                <div class="metric-label">Teachers Trained</div>
                            </div>
                            <div class="metric-item">
                                <div class="metric-value">85%</div>
                                <div class="metric-label">Literacy Gain</div>
                            </div>
                        </div>
                        <div class="mt-2 text-center">
                            <i class="fas fa-play-circle" style="color: var(--terminal-blue);"></i>
                            <small>Click to hear Nomsa's story</small>
                        </div>
                    </div>

                    <div class="story-card" onclick="playStoryAudio('stem-sisters')">
                        <div class="story-title">STEM Sisters: Breaking Barriers in Nigerian Tech Education</div>
                        <div class="story-content">
                            In Lagos, 16-year-old Amina Yusuf leads a coding club of 150 girls. Your investment in gender-focused STEM education helped establish 25 similar clubs across Nigeria, with 89% of participants now pursuing tech careers—a 340% increase from 2021.
                        </div>
                        <div class="story-metrics">
                            <div class="metric-item">
                                <div class="metric-value">3,750</div>
                                <div class="metric-label">Girls in STEM</div>
                            </div>
                            <div class="metric-item">
                                <div class="metric-value">89%</div>
                                <div class="metric-label">Tech Career Rate</div>
                            </div>
                            <div class="metric-item">
                                <div class="metric-value">340%</div>
                                <div class="metric-label">Growth Rate</div>
                            </div>
                        </div>
                        <div class="mt-2 text-center">
                            <i class="fas fa-play-circle" style="color: var(--terminal-purple);"></i>
                            <small>Listen to Amina's journey</small>
                        </div>
                    </div>

                    <div class="story-card" onclick="playStoryAudio('climate-champions')">
                        <div class="story-title">Climate Champions: Kenya's Green Education Revolution</div>
                        <div class="story-content">
                            In Nairobi's Kibera slum, environmental science teacher James Kiprotich uses VR headsets to show students melting glaciers. His climate education program, funded through your ESG portfolio, now operates in 80 schools, training 15,000 young climate advocates.
                        </div>
                        <div class="story-metrics">
                            <div class="metric-item">
                                <div class="metric-value">15,000</div>
                                <div class="metric-label">Climate Advocates</div>
                            </div>
                            <div class="metric-item">
                                <div class="metric-value">80</div>
                                <div class="metric-label">Schools</div>
                            </div>
                            <div class="metric-item">
                                <div class="metric-value">92%</div>
                                <div class="metric-label">Engagement Rate</div>
                            </div>
                        </div>
                        <div class="mt-2 text-center">
                            <i class="fas fa-play-circle" style="color: var(--terminal-green);"></i>
                            <small>Experience the VR classroom</small>
                        </div>
                    </div>
                </div>

                <!-- Key Metrics Dashboard -->
                <div class="row">
                    <div class="col-md-3">
                        <div class="glass-card text-center">
                            <div class="metric-value" style="font-size: 2.5rem; color: var(--terminal-green);">5.8x</div>
                            <div class="metric-label">Impact ROI</div>
                            <small class="text-muted">vs 2.14x Financial ROI</small>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="glass-card text-center">
                            <div class="metric-value" style="font-size: 2.5rem; color: var(--terminal-blue);">94%</div>
                            <div class="metric-label">Literacy Improvement</div>
                            <small class="text-muted">Above UNESCO targets</small>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="glass-card text-center">
                            <div class="metric-value" style="font-size: 2.5rem; color: var(--terminal-purple);">87</div>
                            <div class="metric-label">ESG Score</div>
                            <small class="text-muted">Top 10% globally</small>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="glass-card text-center">
                            <div class="metric-value" style="font-size: 2.5rem; color: var(--terminal-gold);">12.5K</div>
                            <div class="metric-label">Teachers Trained</div>
                            <small class="text-muted">Multiplier effect: 285K students</small>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Opportunity Ripple Tab -->
            <div id="opportunity-ripple" class="tab-content">
                <div class="d-flex justify-content-between align-items-center mb-4">
                    <h2 style="color: var(--terminal-blue);">
                        <i class="fas fa-handshake"></i> Opportunity Ripple
                    </h2>
                    <div>
                        <button class="btn btn-outline-primary me-2">
                            <i class="fas fa-filter"></i> Filter
                        </button>
                        <button class="btn btn-primary">
                            <i class="fas fa-plus"></i> Add Opportunity Alert
                        </button>
                    </div>
                </div>

                <!-- Opportunity Cards -->
                <div class="opportunity-card">
                    <div class="opportunity-header">
                        <div class="opportunity-title">EduTech Kenya - Digital Literacy Platform</div>
                        <div class="compatibility-score">94% Match</div>
                    </div>
                    <div class="opportunity-details">
                        <div class="opportunity-metric">
                            <div class="opportunity-metric-value">$2.5M</div>
                            <div class="opportunity-metric-label">Funding Round</div>
                        </div>
                        <div class="opportunity-metric">
                            <div class="opportunity-metric-value">Series A</div>
                            <div class="opportunity-metric-label">Stage</div>
                        </div>
                        <div class="opportunity-metric">
                            <div class="opportunity-metric-value">50K</div>
                            <div class="opportunity-metric-label">Students Reached</div>
                        </div>
                        <div class="opportunity-metric">
                            <div class="opportunity-metric-value">SDG 4</div>
                            <div class="opportunity-metric-label">Primary Goal</div>
                        </div>
                    </div>
                    <p class="mb-3">Revolutionary mobile-first platform bringing quality education to rural Kenya. 89% improvement in math scores, 94% teacher satisfaction. Seeking growth capital for expansion across East Africa.</p>
                    <div class="d-flex gap-2">
                        <button class="btn btn-primary">View Full Prospectus</button>
                        <button class="btn btn-outline-primary">Schedule Due Diligence</button>
                        <button class="btn btn-outline-success">Express Interest</button>
                    </div>
                </div>

                <div class="opportunity-card">
                    <div class="opportunity-header">
                        <div class="opportunity-title">TeacherTech Nigeria - AI-Powered Training</div>
                        <div class="compatibility-score">91% Match</div>
                    </div>
                    <div class="opportunity-details">
                        <div class="opportunity-metric">
                            <div class="opportunity-metric-value">$1.8M</div>
                            <div class="opportunity-metric-label">Funding Round</div>
                        </div>
                        <div class="opportunity-metric">
                            <div class="opportunity-metric-value">Seed</div>
                            <div class="opportunity-metric-label">Stage</div>
                        </div>
                        <div class="opportunity-metric">
                            <div class="opportunity-metric-value">5K</div>
                            <div class="opportunity-metric-label">Teachers Trained</div>
                        </div>
                        <div class="opportunity-metric">
                            <div class="opportunity-metric-value">SDG 4, 5</div>
                            <div class="opportunity-metric-label">Impact Goals</div>
                        </div>
                    </div>
                    <p class="mb-3">AI-driven professional development platform for teachers in underserved communities. 78% improvement in teaching effectiveness, 85% retention rate. Focus on female teacher empowerment.</p>
                    <div class="d-flex gap-2">
                        <button class="btn btn-primary">View Full Prospectus</button>
                        <button class="btn btn-outline-primary">Schedule Due Diligence</button>
                        <button class="btn btn-outline-success">Express Interest</button>
                    </div>
                </div>

                <div class="opportunity-card">
                    <div class="opportunity-header">
                        <div class="opportunity-title">GreenSchools Ghana - Sustainable Education</div>
                        <div class="compatibility-score">88% Match</div>
                    </div>
                    <div class="opportunity-details">
                        <div class="opportunity-metric">
                            <div class="opportunity-metric-value">$3.2M</div>
                            <div class="opportunity-metric-label">Funding Round</div>
                        </div>
                        <div class="opportunity-metric">
                            <div class="opportunity-metric-value">Series A</div>
                            <div class="opportunity-metric-label">Stage</div>
                        </div>
                        <div class="opportunity-metric">
                            <div class="opportunity-metric-value">25K</div>
                            <div class="opportunity-metric-label">Students Impacted</div>
                        </div>
                        <div class="opportunity-metric">
                            <div class="opportunity-metric-value">SDG 4, 13</div>
                            <div class="opportunity-metric-label">Impact Goals</div>
                        </div>
                    </div>
                    <p class="mb-3">Solar-powered schools with integrated climate education curriculum. 92% energy independence, 40% reduction in operational costs. Expanding to 100 schools across West Africa.</p>
                    <div class="d-flex gap-2">
                        <button class="btn btn-primary">View Full Prospectus</button>
                        <button class="btn btn-outline-primary">Schedule Due Diligence</button>
                        <button class="btn btn-outline-success">Express Interest</button>
                    </div>
                </div>
            </div>

            <!-- Portfolio Tab -->
            <div id="portfolio" class="tab-content">
                <div class="d-flex justify-content-between align-items-center mb-4">
                    <h2 style="color: var(--terminal-blue);">
                        <i class="fas fa-briefcase"></i> Education Portfolio
                    </h2>
                    <div>
                        <button class="btn btn-outline-primary me-2">
                            <i class="fas fa-download"></i> Export Report
                        </button>
                        <button class="btn btn-primary">
                            <i class="fas fa-plus"></i> Add Investment
                        </button>
                    </div>
                </div>

                <!-- Portfolio Overview -->
                <div class="row mb-4">
                    <div class="col-md-3">
                        <div class="glass-card text-center">
                            <div class="metric-value" style="font-size: 2rem; color: var(--terminal-green);">$12.8M</div>
                            <div class="metric-label">Total Portfolio Value</div>
                            <small class="text-success">+18.5% YoY</small>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="glass-card text-center">
                            <div class="metric-value" style="font-size: 2rem; color: var(--terminal-blue);">15</div>
                            <div class="metric-label">Active Investments</div>
                            <small class="text-muted">Across 8 countries</small>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="glass-card text-center">
                            <div class="metric-value" style="font-size: 2rem; color: var(--terminal-purple);">285K</div>
                            <div class="metric-label">Students Reached</div>
                            <small class="text-info">+45% this quarter</small>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="glass-card text-center">
                            <div class="metric-value" style="font-size: 2rem; color: var(--terminal-gold);">87</div>
                            <div class="metric-label">Avg ESG Score</div>
                            <small class="text-warning">Top 10% globally</small>
                        </div>
                    </div>
                </div>

                <!-- CEO Report Teaser -->
                <div class="glass-card mb-4">
                    <div class="d-flex justify-content-between align-items-center mb-3">
                        <h4 style="color: var(--terminal-purple);">
                            <i class="fas fa-chart-line"></i> Executive Portfolio Analysis
                        </h4>
                        <span class="badge bg-warning text-dark">Premium Report</span>
                    </div>
                    <div class="row">
                        <div class="col-md-8">
                            <p>Comprehensive portfolio analysis with strategic opportunities, risk assessment, and 5-year projections. Includes competitive benchmarking against leading education funds.</p>
                            <div class="mb-2"><strong>Key Insights:</strong></div>
                            <ul>
                                <li>3 underperforming assets with 60% upside potential</li>
                                <li>Opportunity to lead $15M Series B in top performer</li>
                                <li>Geographic diversification recommendations for risk mitigation</li>
                                <li>ESG compliance gaps and remediation strategies</li>
                            </ul>
                        </div>
                        <div class="col-md-4 text-center">
                            <div style="filter: blur(2px);">
                                <canvas id="portfolioPreview" width="200" height="120"></canvas>
                            </div>
                            <button class="btn btn-premium mt-3" onclick="showPremiumModal('portfolio-analysis')">
                                Generate Report - $299
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Actuarial Calculator -->
                <div class="actuarial-calculator">
                    <h4 style="color: var(--terminal-blue); margin-bottom: 1.5rem;">
                        <i class="fas fa-calculator"></i> Dynamic Portfolio Calculator
                    </h4>
                    <div class="calculator-controls">
                        <div class="control-group">
                            <label class="control-label">Investment Amount ($M)</label>
                            <input type="range" class="slider" id="investmentSlider" min="0.5" max="10" step="0.1" value="2.5">
                            <span id="investmentValue">$2.5M</span>
                        </div>
                        <div class="control-group">
                            <label class="control-label">Time Horizon (Years)</label>
                            <input type="range" class="slider" id="timeSlider" min="1" max="10" step="1" value="5">
                            <span id="timeValue">5 years</span>
                        </div>
                        <div class="control-group">
                            <label class="control-label">Risk Tolerance</label>
                            <select class="form-select" id="riskSelect">
                                <option value="conservative">Conservative</option>
                                <option value="moderate" selected>Moderate</option>
                                <option value="aggressive">Aggressive</option>
                            </select>
                        </div>
                        <div class="control-group">
                            <label class="control-label">Geographic Focus</label>
                            <select class="form-select" id="geoSelect">
                                <option value="africa" selected>Sub-Saharan Africa</option>
                                <option value="asia">Southeast Asia</option>
                                <option value="latam">Latin America</option>
                                <option value="global">Global</option>
                            </select>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-6">
                            <canvas id="projectionChart"></canvas>
                        </div>
                        <div class="col-md-6">
                            <div class="glass-card">
                                <h5 style="color: var(--terminal-green);">Projected Outcomes (5 Years)</h5>
                                <div class="row">
                                    <div class="col-6">
                                        <div class="metric-item">
                                            <div class="metric-value" id="projectedROI">4.2x</div>
                                            <div class="metric-label">Expected ROI</div>
                                        </div>
                                    </div>
                                    <div class="col-6">
                                        <div class="metric-item">
                                            <div class="metric-value" id="projectedStudents">125K</div>
                                            <div class="metric-label">Students Reached</div>
                                        </div>
                                    </div>
                                    <div class="col-6">
                                        <div class="metric-item">
                                            <div class="metric-value" id="projectedESG">92</div>
                                            <div class="metric-label">ESG Score</div>
                                        </div>
                                    </div>
                                    <div class="col-6">
                                        <div class="metric-item">
                                            <div class="metric-value" id="projectedRisk">Medium</div>
                                            <div class="metric-label">Risk Level</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Portfolio Companies Grid -->
                <div class="portfolio-grid">
                    <div class="portfolio-item">
                        <div class="portfolio-header">
                            <div class="company-name">EduTech Solutions</div>
                            <div class="health-indicator"></div>
                        </div>
                        <div class="portfolio-metrics">
                            <div class="metric-item">
                                <div class="metric-value">$2.1M</div>
                                <div class="metric-label">Investment</div>
                            </div>
                            <div class="metric-item">
                                <div class="metric-value">3.2x</div>
                                <div class="metric-label">Current Multiple</div>
                            </div>
                            <div class="metric-item">
                                <div class="metric-value">45K</div>
                                <div class="metric-label">Students</div>
                            </div>
                            <div class="metric-item">
                                <div class="metric-value">89</div>
                                <div class="metric-label">ESG Score</div>
                            </div>
                        </div>
                        <div class="d-flex gap-2">
                            <button class="btn btn-sm btn-outline-primary">View Details</button>
                            <button class="btn btn-sm btn-outline-success">Follow-on</button>
                        </div>
                    </div>

                    <div class="portfolio-item">
                        <div class="portfolio-header">
                            <div class="company-name">TeacherTrain Africa</div>
                            <div class="health-indicator warning"></div>
                        </div>
                        <div class="portfolio-metrics">
                            <div class="metric-item">
                                <div class="metric-value">$1.5M</div>
                                <div class="metric-label">Investment</div>
                            </div>
                            <div class="metric-item">
                                <div class="metric-value">1.8x</div>
                                <div class="metric-label">Current Multiple</div>
                            </div>
                            <div class="metric-item">
                                <div class="metric-value">12K</div>
                                <div class="metric-label">Teachers</div>
                            </div>
                            <div class="metric-item">
                                <div class="metric-value">76</div>
                                <div class="metric-label">ESG Score</div>
                            </div>
                        </div>
                        <div class="d-flex gap-2">
                            <button class="btn btn-sm btn-outline-primary">View Details</button>
                            <button class="btn btn-sm btn-outline-warning">Support Plan</button>
                        </div>
                    </div>

                    <div class="portfolio-item">
                        <div class="portfolio-header">
                            <div class="company-name">Digital Literacy Hub</div>
                            <div class="health-indicator"></div>
                        </div>
                        <div class="portfolio-metrics">
                            <div class="metric-item">
                                <div class="metric-value">$3.2M</div>
                                <div class="metric-label">Investment</div>
                            </div>
                            <div class="metric-item">
                                <div class="metric-value">4.1x</div>
                                <div class="metric-label">Current Multiple</div>
                            </div>
                            <div class="metric-item">
                                <div class="metric-value">78K</div>
                                <div class="metric-label">Students</div>
                            </div>
                            <div class="metric-item">
                                <div class="metric-value">94</div>
                                <div class="metric-label">ESG Score</div>
                            </div>
                        </div>
                        <div class="d-flex gap-2">
                            <button class="btn btn-sm btn-outline-primary">View Details</button>
                            <button class="btn btn-sm btn-outline-success">Exit Prep</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Leaderboard Tab - IMPROVED -->
            <div id="leaderboard" class="tab-content">
                <div class="d-flex justify-content-between align-items-center mb-4">
                    <h2 style="color: var(--terminal-blue);">
                        <i class="fas fa-trophy"></i> ESG Education Leaderboard
                    </h2>
                    <div>
                        <select class="form-select" style="width: auto; display: inline-block;">
                            <option>Impact ROI</option>
                            <option>Students Reached</option>
                            <option>ESG Score</option>
                            <option>Portfolio Value</option>
                        </select>
                    </div>
                </div>

                <!-- Your Ranking -->
                <div class="glass-card mb-4" style="border: 2px solid var(--terminal-blue);">
                    <h4 style="color: var(--terminal-gold);">Your Current Ranking</h4>
                    <div class="row">
                        <div class="col-md-3 text-center">
                            <div class="metric-value" style="font-size: 3rem; color: var(--terminal-gold);">#7</div>
                            <div class="metric-label">Global Rank</div>
                            <div class="rank-change rank-up">
                                <i class="fas fa-arrow-up"></i> +2
                            </div>
                        </div>
                        <div class="col-md-9">
                            <div class="row">
                                <div class="col-md-3">
                                    <div class="metric-item">
                                        <div class="metric-value">5.8x</div>
                                        <div class="metric-label">Impact ROI</div>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="metric-item">
                                        <div class="metric-value">285K</div>
                                        <div class="metric-label">Students</div>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="metric-item">
                                        <div class="metric-value">87</div>
                                        <div class="metric-label">ESG Score</div>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="metric-item">
                                        <div class="metric-value">$12.8M</div>
                                        <div class="metric-label">Portfolio</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Top Performers -->
                <div class="leaderboard-item">
                    <div class="rank-number">#1</div>
                    <div class="leaderboard-user">
                        <div class="leaderboard-user-name">Gates Foundation Education Fund</div>
                        <div class="leaderboard-user-details">Impact ROI: 8.2x • Students: 2.1M • ESG: 96</div>
                    </div>
                    <div class="rank-change rank-same">
                        <i class="fas fa-minus"></i>
                    </div>
                </div>

                <div class="leaderboard-item">
                    <div class="rank-number">#2</div>
                    <div class="leaderboard-user">
                        <div class="leaderboard-user-name">Mastercard Foundation</div>
                        <div class="leaderboard-user-details">Impact ROI: 7.8x • Students: 1.8M • ESG: 94</div>
                    </div>
                    <div class="rank-change rank-up">
                        <i class="fas fa-arrow-up"></i>
                    </div>
                </div>

                <div class="leaderboard-item">
                    <div class="rank-number">#3</div>
                    <div class="leaderboard-user">
                        <div class="leaderboard-user-name">Omidyar Network Education</div>
                        <div class="leaderboard-user-details">Impact ROI: 7.1x • Students: 950K • ESG: 92</div>
                    </div>
                    <div class="rank-change rank-down">
                        <i class="fas fa-arrow-down"></i>
                    </div>
                </div>

                <div class="leaderboard-item">
                    <div class="rank-number">#4</div>
                    <div class="leaderboard-user">
                        <div class="leaderboard-user-name">Chan Zuckerberg Initiative</div>
                        <div class="leaderboard-user-details">Impact ROI: 6.9x • Students: 1.2M • ESG: 91</div>
                    </div>
                    <div class="rank-change rank-up">
                        <i class="fas fa-arrow-up"></i>
                    </div>
                </div>

                <div class="leaderboard-item">
                    <div class="rank-number">#5</div>
                    <div class="leaderboard-user">
                        <div class="leaderboard-user-name">NewSchools Venture Fund</div>
                        <div class="leaderboard-user-details">Impact ROI: 6.5x • Students: 780K • ESG: 89</div>
                    </div>
                    <div class="rank-change rank-same">
                        <i class="fas fa-minus"></i>
                    </div>
                </div>

                <div class="leaderboard-item">
                    <div class="rank-number">#6</div>
                    <div class="leaderboard-user">
                        <div class="leaderboard-user-name">Reach Capital</div>
                        <div class="leaderboard-user-details">Impact ROI: 6.2x • Students: 650K • ESG: 88</div>
                    </div>
                    <div class="rank-change rank-down">
                        <i class="fas fa-arrow-down"></i>
                    </div>
                </div>

                <div class="leaderboard-item" style="background: rgba(0, 212, 255, 0.1); border: 2px solid var(--terminal-blue);">
                    <div class="rank-number" style="color: var(--terminal-blue);">#7</div>
                    <div class="leaderboard-user">
                        <div class="leaderboard-user-name" style="color: var(--terminal-blue);">Your Fund</div>
                        <div class="leaderboard-user-details">Impact ROI: 5.8x • Students: 285K • ESG: 87</div>
                    </div>
                    <div class="rank-change rank-up">
                        <i class="fas fa-arrow-up"></i> +2
                    </div>
                </div>

                <div class="leaderboard-item">
                    <div class="rank-number">#8</div>
                    <div class="leaderboard-user">
                        <div class="leaderboard-user-name">Rockefeller Foundation</div>
                        <div class="leaderboard-user-details">Impact ROI: 5.6x • Students: 420K • ESG: 86</div>
                    </div>
                    <div class="rank-change rank-down">
                        <i class="fas fa-arrow-down"></i>
                    </div>
                </div>

                <div class="leaderboard-item">
                    <div class="rank-number">#9</div>
                    <div class="leaderboard-user">
                        <div class="leaderboard-user-name">Ford Foundation</div>
                        <div class="leaderboard-user-details">Impact ROI: 5.4x • Students: 380K • ESG: 85</div>
                    </div>
                    <div class="rank-change rank-same">
                        <i class="fas fa-minus"></i>
                    </div>
                </div>

                <div class="leaderboard-item">
                    <div class="rank-number">#10</div>
                    <div class="leaderboard-user">
                        <div class="leaderboard-user-name">MacArthur Foundation</div>
                        <div class="leaderboard-user-details">Impact ROI: 5.2x • Students: 350K • ESG: 84</div>
                    </div>
                    <div class="rank-change rank-up">
                        <i class="fas fa-arrow-up"></i>
                    </div>
                </div>
            </div>

            <!-- Collaboration Zone Tab - IMPROVED -->
            <div id="collaboration" class="tab-content">
                <div class="d-flex justify-content-between align-items-center mb-4">
                    <h2 style="color: var(--terminal-blue);">
                        <i class="fas fa-users"></i> Collaboration Zone
                    </h2>
                    <button class="btn btn-primary" onclick="showCreateCollabModal()">
                        <i class="fas fa-plus"></i> Create New Collaboration
                    </button>
                </div>

                <!-- AI-Powered Events Section -->
                <div class="collaboration-card">
                    <div class="collaboration-header">
                        <i class="fas fa-calendar collaboration-icon"></i>
                        <div class="collaboration-title">AI-Recommended Events</div>
                    </div>
                    
                    <div id="ai-events-container">
                        <!-- Events will be dynamically populated by AI -->
                    </div>
                </div>

                <!-- Network Insights -->
                <div class="collaboration-card">
                    <div class="collaboration-header">
                        <i class="fas fa-chart-network collaboration-icon"></i>
                        <div class="collaboration-title">Network Insights</div>
                    </div>
                    <div class="row">
                        <div class="col-md-6">
                            <div class="metric-item">
                                <div class="metric-value" style="color: var(--terminal-green);">87%</div>
                                <div class="metric-label">Connection Strength</div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="metric-item">
                                <div class="metric-value" style="color: var(--terminal-blue);">+12</div>
                                <div class="metric-label">New Connections This Month</div>
                            </div>
                        </div>
                    </div>
                    <div class="mt-3">
                        <h5>Top Collaboration Opportunities</h5>
                        <ul>
                            <li>Gates Foundation - Digital Literacy Initiative (95% alignment)</li>
                            <li>Mastercard Foundation - Youth Employment Program (92% alignment)</li>
                            <li>UNESCO - Policy Development Working Group (88% alignment)</li>
                        </ul>
                    </div>
                </div>

                <!-- Expert Directory -->
                <div class="collaboration-card">
                    <div class="collaboration-header">
                        <i class="fas fa-user-tie collaboration-icon"></i>
                        <div class="collaboration-title">Expert Directory</div>
                    </div>
                    <div class="input-group mb-3">
                        <input type="text" class="form-control" placeholder="Search for experts by skill, location, or expertise">
                        <button class="btn btn-primary" type="button">
                            <i class="fas fa-search"></i>
                        </button>
                    </div>
                    <div class="row">
                        <div class="col-md-6">
                            <div class="discussion-item">
                                <div class="discussion-avatar">👨‍💼</div>
                                <div class="discussion-content">
                                    <div class="discussion-author">Dr. Amina Jalloh</div>
                                    <div class="discussion-text">Education Policy & Curriculum Development</div>
                                    <div class="discussion-meta">Sierra Leone • Available for Consultancy</div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="discussion-item">
                                <div class="discussion-avatar">👩‍💻</div>
                                <div class="discussion-content">
                                    <div class="discussion-author">Prof. Kwame Osei</div>
                                    <div class="discussion-text">EdTech & Digital Learning Solutions</div>
                                    <div class="discussion-meta">Ghana • Seeking Research Partners</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Active Collaborations -->
                <div class="collaboration-card">
                    <div class="collab-header">
                        <div class="collab-title">EduTech Kenya Series A - Co-Investment</div>
                        <div class="alignment-score">94% Aligned</div>
                    </div>
                    <div class="row mb-3">
                        <div class="col-md-8">
                            <p>Seeking co-Impact Donors for $2.5M Series A in Kenya's leading digital literacy platform. Strong ESG alignment with SDG 4 focus and proven 89% improvement in math scores.</p>
                            <div class="mb-2">
                                <strong>Lead Impact Donor:</strong> Acumen Academy Fund<br>
                                <strong>Target:</strong> $2.5M • <strong>Committed:</strong> $1.8M (72%)
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="text-center">
                                <div class="progress mb-2">
                                    <div class="progress-bar" style="width: 72%"></div>
                                </div>
                                <div class="metric-value">$700K</div>
                                <div class="metric-label">Remaining</div>
                            </div>
                        </div>
                    </div>
                    <div class="d-flex gap-2">
                        <button class="btn btn-primary">View Prospectus</button>
                        <button class="btn btn-outline-success">Pledge Investment</button>
                        <button class="btn btn-outline-primary">Join Due Diligence</button>
                    </div>
                </div>

                <div class="collaboration-card">
                    <div class="collab-header">
                        <div class="collab-title">Teacher Training Nigeria - Seeking Entrepreneurs</div>
                        <div class="alignment-score">88% Aligned</div>
                    </div>
                    <div class="row mb-3">
                        <div class="col-md-8">
                            <p>Fully funded $1.2M initiative seeking experienced entrepreneurs and researchers to scale AI-powered teacher training across Nigeria. Focus on female teacher empowerment.</p>
                            <div class="mb-2">
                                <strong>Funding Status:</strong> Fully Funded<br>
                                <strong>Seeking:</strong> 2 Entrepreneurs, 1 Research Partner
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="text-center">
                                <div class="metric-value">3/5</div>
                                <div class="metric-label">Positions Filled</div>
                                <div class="mt-2">
                                    <span class="badge bg-success">2 Entrepreneurs</span>
                                    <span class="badge bg-warning">1 Researcher Needed</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="d-flex gap-2">
                        <button class="btn btn-primary">View Details</button>
                        <button class="btn btn-outline-primary">Recommend Partner</button>
                        <button class="btn btn-outline-info">Join Advisory</button>
                    </div>
                </div>
            </div>

            <!-- Impact Reports Tab -->
            <div id="reports" class="tab-content">
                <div class="mb-5">
                    <h2 class="mb-3" style="color: var(--terminal-blue); font-size: 2.5rem;">AI-Generated Impact Reports</h2>
                    <p class="text-gray-400" style="font-size: 1.1rem;">Personalized insights powered by NanoGPT-5 + ScraperAPI • 15 Report Types</p>
                </div>

                <!-- Free Reports Section -->
                <div class="mb-5">
                    <h3 class="mb-4" style="color: var(--terminal-green); font-size: 1.8rem;">🎁 Free Reports</h3>
                    <div class="report-grid">
                        
                        <!-- FREE: Impact Report -->
                        <div class="report-card" style="border: 2px solid var(--terminal-green);" onclick="generateReport('impact_report')">
                            <div class="d-flex justify-content-between align-items-start mb-4">
                                <div style="font-size: 3rem;">❤️</div>
                                <span class="free-badge">FREE</span>
                            </div>
                            <h3 class="report-title">Impact Report</h3>
                            <p class="report-description">Immersive 800-word narrative blending your goals with real-world transformation stories and ROI projections</p>
                            <div class="mb-3">
                                <span class="tag tag-narrative">Narrative</span>
                                <span class="tag tag-sdg">SDG Aligned</span>
                            </div>
                        </div>

                        <!-- FREE: Comparative Benchmark -->
                        <div class="report-card" style="border: 2px solid var(--terminal-green);" onclick="generateReport('comparative_benchmark')">
                            <div class="d-flex justify-content-between align-items-start mb-4">
                                <div style="font-size: 3rem;">📊</div>
                                <span class="free-badge">FREE</span>
                            </div>
                            <h3 class="report-title">Comparative Benchmark</h3>
                            <p class="report-description">Compare your impact metrics to peers with efficiency ratios, policy alignment scores, and recommendations</p>
                            <div class="mb-3">
                                <span class="tag tag-peer">Peer Analysis</span>
                                <span class="tag tag-benchmarking">Benchmarking</span>
                            </div>
                        </div>

                    </div>
                </div>

                <!-- Premium Reports Section -->
                <div>
                    <h3 class="mb-4" style="color: var(--terminal-gold); font-size: 1.8rem;">⭐ Premium Reports</h3>
                    <div class="report-grid">
                        
                        <!-- 1. Scalability & Impact Expansion ($399) -->
                        <div class="report-card" onclick="generateReport('scalability_expansion')">
                            <div class="d-flex justify-content-between align-items-start mb-4">
                                <div style="font-size: 2.5rem;">📈</div>
                                <span class="premium-badge">$399</span>
                            </div>
                            <h3 class="report-title">Scalability & Impact Expansion</h3>
                            <p class="report-description">Forecast scalability with growth matrix, cost projections, and 3-year impact scenarios</p>
                            <div class="mb-3">
                                <span class="tag tag-gri">GRI</span>
                                <span class="tag tag-iris">IRIS+</span>
                            </div>
                        </div>

                        <!-- 2. Stakeholder Engagement ($349) -->
                        <div class="report-card" onclick="generateReport('stakeholder_engagement')">
                            <div class="d-flex justify-content-between align-items-start mb-4">
                                <div style="font-size: 2.5rem;">🤝</div>
                                <span class="premium-badge">$349</span>
                            </div>
                            <h3 class="report-title">Stakeholder Engagement</h3>
                            <p class="report-description">Evaluate community and government buy-in with stakeholder maps and engagement scores</p>
                            <div class="mb-3">
                                <span class="tag tag-iris">IRIS+</span>
                                <span class="tag tag-sdg">SDG</span>
                            </div>
                        </div>

                        <!-- 3. Risk-Adjusted ROI ($499) -->
                        <div class="report-card" onclick="generateReport('risk_adjusted_roi')">
                            <div class="d-flex justify-content-between align-items-start mb-4">
                                <div style="font-size: 2.5rem;">⚖️</div>
                                <span class="premium-badge">$499</span>
                            </div>
                            <h3 class="report-title">Risk-Adjusted ROI</h3>
                            <p class="report-description">Compute risk-adjusted returns with TCFD/SASB compliance and mitigation strategies</p>
                            <div class="mb-3">
                                <span class="tag tag-tcfd">TCFD</span>
                                <span class="tag tag-sasb">SASB</span>
                            </div>
                        </div>

                        <!-- 4. Cross-Sector Collaboration ($449) -->
                        <div class="report-card" onclick="generateReport('cross_sector_collaboration')">
                            <div class="d-flex justify-content-between align-items-start mb-4">
                                <div style="font-size: 2.5rem;">🔗</div>
                                <span class="premium-badge">$449</span>
                            </div>
                            <h3 class="report-title">Cross-Sector Collaboration</h3>
                            <p class="report-description">Identify partnership opportunities with synergy scores and collaboration plans</p>
                            <div class="mb-3">
                                <span class="tag tag-sdg17">SDG 17</span>
                            </div>
                        </div>

                        <!-- 5. Policy Alignment ($299) -->
                        <div class="report-card" onclick="generateReport('policy_alignment')">
                            <div class="d-flex justify-content-between align-items-start mb-4">
                                <div style="font-size: 2.5rem;">📜</div>
                                <span class="premium-badge">$299</span>
                            </div>
                            <h3 class="report-title">Policy Alignment</h3>
                            <p class="report-description">Map investments to compliant policies with risk heatmaps and forecasts</p>
                            <div class="mb-3">
                                <span class="tag tag-unesco">UNESCO</span>
                            </div>
                        </div>

                        <!-- 6. ROI & Metrics Dashboard ($399) -->
                        <div class="report-card" onclick="generateReport('roi_metrics_dashboard')">
                            <div class="d-flex justify-content-between align-items-start mb-4">
                                <div style="font-size: 2.5rem;">💰</div>
                                <span class="premium-badge">$399</span>
                            </div>
                            <h3 class="report-title">ROI & Metrics Dashboard</h3>
                            <p class="report-description">Data-rich report with IRR/MOIC analysis and global fund benchmarks</p>
                            <div class="mb-3">
                                <span class="tag tag-quantitative">Quantitative</span>
                            </div>
                        </div>

                        <!-- 7. Cross-Impact Opportunity ($449) -->
                        <div class="report-card" onclick="generateReport('cross_impact_opportunity')">
                            <div class="d-flex justify-content-between align-items-start mb-4">
                                <div style="font-size: 2.5rem;">🌐</div>
                                <span class="premium-badge">$449</span>
                            </div>
                            <h3 class="report-title">Cross-Impact Opportunity</h3>
                            <p class="report-description">Uncover SDG synergies (education + climate/gender) with opportunity matrices</p>
                            <div class="mb-3">
                                <span class="tag tag-multi-sdg">Multi-SDG</span>
                            </div>
                        </div>

                        <!-- 8. Materiality Assessment ($499) -->
                        <div class="report-card" onclick="generateReport('materiality_assessment')">
                            <div class="d-flex justify-content-between align-items-start mb-4">
                                <div style="font-size: 2.5rem;">🎯</div>
                                <span class="premium-badge">$499</span>
                            </div>
                            <h3 class="report-title">Materiality Assessment</h3>
                            <p class="report-description">Identify financially material ESG issues with SASB/GRI alignment</p>
                            <div class="mb-3">
                                <span class="tag tag-sasb">SASB</span>
                                <span class="tag tag-gri">GRI</span>
                            </div>
                        </div>

                        <!-- 9. Carbon & Decarbonization ($449) -->
                        <div class="report-card" onclick="generateReport('carbon_decarbonization')">
                            <div class="d-flex justify-content-between align-items-start mb-4">
                                <div style="font-size: 2.5rem;">🌱</div>
                                <span class="premium-badge">$449</span>
                            </div>
                            <h3 class="report-title">Carbon & Decarbonization</h3>
                            <p class="report-description">Track Scope 1-3 emissions with net-zero alignment and green premium forecasts</p>
                            <div class="mb-3">
                                <span class="tag tag-tcfd">TCFD</span>
                                <span class="tag tag-cdp">CDP</span>
                            </div>
                        </div>

                        <!-- 10. Fund Benchmarking ($399) -->
                        <div class="report-card" onclick="generateReport('fund_benchmarking')">
                            <div class="d-flex justify-content-between align-items-start mb-4">
                                <div style="font-size: 2.5rem;">📉</div>
                                <span class="premium-badge">$399</span>
                            </div>
                            <h3 class="report-title">Fund Benchmarking & Screening</h3>
                            <p class="report-description">Screen investments vs 50,000+ funds with ESG scores and performance analytics</p>
                            <div class="mb-3">
                                <span class="tag tag-morningstar">Morningstar</span>
                            </div>
                        </div>

                        <!-- 11. Regulatory Compliance ($499) -->
                        <div class="report-card" onclick="generateReport('regulatory_compliance')">
                            <div class="d-flex justify-content-between align-items-start mb-4">
                                <div style="font-size: 2.5rem;">⚖️</div>
                                <span class="premium-badge">$499</span>
                            </div>
                            <h3 class="report-title">Regulatory Compliance</h3>
                            <p class="report-description">Ensure SFDR/CSRD compliance with gap analyses and disclosure templates</p>
                            <div class="mb-3">
                                <span class="tag tag-sfdr">SFDR</span>
                                <span class="tag tag-ifrs">IFRS</span>
                            </div>
                        </div>

                        <!-- 12. Policy Risk Watch ($299) -->
                        <div class="report-card" onclick="generateReport('policy_risk_watch')">
                            <div class="d-flex justify-content-between align-items-start mb-4">
                                <div style="font-size: 2.5rem;">🚨</div>
                                <span class="premium-badge">$299</span>
                            </div>
                            <h3 class="report-title">Policy Influence & Risk Watch</h3>
                            <p class="report-description">Track policy shifts with risk heatmaps and advocacy opportunities</p>
                            <div class="mb-3">
                                <span class="tag tag-risk">Risk Analysis</span>
                            </div>
                        </div>

                        <!-- 13. ESG Scorecard ($349) -->
                        <div class="report-card" onclick="generateReport('esg_scorecard')">
                            <div class="d-flex justify-content-between align-items-start mb-4">
                                <div style="font-size: 2.5rem;">📊</div>
                                <span class="premium-badge">$349</span>
                            </div>
                            <h3 class="report-title">ESG Scorecard</h3>
                            <p class="report-description">Dashboard-ready scorecard with E-S-G metrics and radar charts</p>
                            <div class="mb-3">
                                <span class="tag tag-esg">E-S-G</span>
                                <span class="tag tag-benchmarked">Benchmarked</span>
                            </div>
                        </div>

                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Report Generation Status -->
    <div id="report-status">
        <div class="report-status-content">
            <div class="ai-thinking">🤖</div>
            <div class="countdown-timer" id="countdown-timer">45</div>
            <p id="status-message" class="text-xl mb-4">Generating your report...</p>
            <div class="progress-container">
                <div class="progress-bar" id="progress-bar"></div>
            </div>
            <p class="text-sm text-gray-500 mt-4">Using NanoGPT-5 AI • Please wait</p>
        </div>
    </div>

    <!-- Profile Completion Modal -->
    <div class="modal fade" id="profileModal" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Complete Your ESG Education Profile</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="progress mb-4">
                        <div class="progress-bar" style="width: 65%"></div>
                    </div>
                    <p class="mb-4">Complete your profile to unlock personalized impact stories, tailored opportunity ripple, and customized reports that match your investment focus.</p>
                    
                    <form id="profileForm">
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label class="form-label">Organization Name *</label>
                                <input type="text" class="form-control" id="orgName" placeholder="e.g., Gates Foundation">
                            </div>
                            <div class="col-md-6 mb-3">
                                <label class="form-label">Organization Type *</label>
                                <select class="form-select" id="orgType">
                                    <option value="">Select type...</option>
                                    <option value="foundation">Foundation</option>
                                    <option value="fund">Impact Donor Fund</option>
                                    <option value="ngo">NGO</option>
                                    <option value="government">Government Agency</option>
                                    <option value="corporate">Corporate</option>
                                </select>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label class="form-label">Website URL</label>
                                <input type="url" class="form-control" id="websiteUrl" placeholder="https://your-organization.org">
                            </div>
                            <div class="col-md-6 mb-3">
                                <label class="form-label">Primary Geography *</label>
                                <select class="form-select" id="primaryGeo">
                                    <option value="">Select region...</option>
                                    <option value="south-africa">South Africa</option>
                                    <option value="nigeria">Nigeria</option>
                                    <option value="kenya">Kenya</option>
                                    <option value="ghana">Ghana</option>
                                    <option value="africa">Sub-Saharan Africa</option>
                                    <option value="global">Global</option>
                                </select>
                            </div>
                            <div class="col-md-12 mb-3">
                                <label class="form-label">Education Focus Areas *</label>
                                <div class="row">
                                    <div class="col-md-4">
                                        <div class="form-check">
                                            <input class="form-check-input" type="checkbox" id="earlyChildhood">
                                            <label class="form-check-label" for="earlyChildhood">Early Childhood</label>
                                        </div>
                                        <div class="form-check">
                                            <input class="form-check-input" type="checkbox" id="primaryEducation">
                                            <label class="form-check-label" for="primaryEducation">Primary Education</label>
                                        </div>
                                        <div class="form-check">
                                            <input class="form-check-input" type="checkbox" id="secondaryEducation">
                                            <label class="form-check-label" for="secondaryEducation">Secondary Education</label>
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="form-check">
                                            <input class="form-check-input" type="checkbox" id="vocationalTraining">
                                            <label class="form-check-label" for="vocationalTraining">Vocational Training</label>
                                        </div>
                                        <div class="form-check">
                                            <input class="form-check-input" type="checkbox" id="teacherTraining">
                                            <label class="form-check-label" for="teacherTraining">Teacher Training</label>
                                        </div>
                                        <div class="form-check">
                                            <input class="form-check-input" type="checkbox" id="digitalLiteracy">
                                            <label class="form-check-label" for="digitalLiteracy">Digital Literacy</label>
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="form-check">
                                            <input class="form-check-input" type="checkbox" id="stemEducation">
                                            <label class="form-check-label" for="stemEducation">STEM Education</label>
                                        </div>
                                        <div class="form-check">
                                            <input class="form-check-input" type="checkbox" id="genderEquity">
                                            <label class="form-check-label" for="genderEquity">Gender Equity</label>
                                        </div>
                                        <div class="form-check">
                                            <input class="form-check-input" type="checkbox" id="climateEducation">
                                            <label class="form-check-label" for="climateEducation">Climate Education</label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label class="form-label">Priority SDG Goals</label>
                                <select class="form-select" id="sdgGoals" multiple>
                                    <option value="sdg4">SDG 4: Quality Education</option>
                                    <option value="sdg5">SDG 5: Gender Equality</option>
                                    <option value="sdg8">SDG 8: Decent Work</option>
                                    <option value="sdg10">SDG 10: Reduced Inequalities</option>
                                    <option value="sdg13">SDG 13: Climate Action</option>
                                </select>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label class="form-label">Report Frequency</label>
                                <select class="form-select" id="reportFreq">
                                    <option value="weekly">Weekly</option>
                                    <option value="monthly" selected>Monthly</option>
                                    <option value="quarterly">Quarterly</option>
                                </select>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Save for Later</button>
                    <button type="button" class="btn btn-primary" onclick="saveProfile()">Complete Profile</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Premium Report Modal -->
    <div class="modal fade" id="premiumModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Premium Report</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body text-center">
                    <div class="premium-lock">🔒</div>
                    <h4 id="reportTitle">Impact Report</h4>
                    <p id="reportDescription">Unlock detailed insights and analysis with our premium report.</p>
                    <div class="mb-3">
                        <span class="h3" style="color: var(--terminal-gold);" id="reportPrice">$149</span>
                    </div>
                    <div class="mb-3">
                        <small class="text-muted">
                            ✓ Instant generation<br>
                            ✓ Interactive visualizations<br>
                            ✓ Downloadable PDF<br>
                            ✓ 30-day access
                        </small>
                    </div>
                </div>
                <div class="modal-footer justify-content-center">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Maybe Later</button>
                    <button type="button" class="btn btn-premium" onclick="processPayment()">
                        Purchase Report
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Create Collaboration Modal -->
    <div class="modal fade" id="createCollabModal" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Create New Collaboration</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="collabForm">
                        <div class="mb-3">
                            <label class="form-label">Collaboration Type</label>
                            <select class="form-select" id="collabType">
                                <option value="co-investment">Seeking Co-Impact Donors</option>
                                <option value="entrepreneur">Seeking Entrepreneurs/Researchers</option>
                                <option value="full-funding">Fully Funded - Seeking Partners</option>
                            </select>
                        </div>
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label class="form-label">Investment/Initiative Name</label>
                                <input type="text" class="form-control" id="collabName" placeholder="e.g., EduTech Kenya Series A">
                            </div>
                            <div class="col-md-6 mb-3">
                                <label class="form-label">Total Amount</label>
                                <input type="text" class="form-control" id="collabAmount" placeholder="e.g., $2.5M">
                            </div>
                            <div class="col-md-6 mb-3">
                                <label class="form-label">Geographic Focus</label>
                                <select class="form-select" id="collabGeo">
                                    <option value="south-africa">South Africa</option>
                                    <option value="nigeria">Nigeria</option>
                                    <option value="kenya">Kenya</option>
                                    <option value="ghana">Ghana</option>
                                    <option value="africa">Sub-Saharan Africa</option>
                                </select>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label class="form-label">Education Focus</label>
                                <select class="form-select" id="collabFocus">
                                    <option value="digital-literacy">Digital Literacy</option>
                                    <option value="teacher-training">Teacher Training</option>
                                    <option value="stem">STEM Education</option>
                                    <option value="climate">Climate Education</option>
                                    <option value="vocational">Vocational Training</option>
                                </select>
                            </div>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Description</label>
                            <textarea class="form-control" id="collabDescription" rows="4" placeholder="Describe the investment opportunity, impact goals, and what you're seeking from collaborators..."></textarea>
                        </div>
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label class="form-label">Timeline</label>
                                <input type="text" class="form-control" id="collabTimeline" placeholder="e.g., 6 months">
                            </div>
                            <div class="col-md-6 mb-3">
                                <label class="form-label">Expected Impact</label>
                                <input type="text" class="form-control" id="collabImpact" placeholder="e.g., 50K students reached">
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-primary" onclick="createCollaboration()">Create Collaboration</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

    <script>
        // Global variables
        let currentUser = {
            name: 'Sarah Chen',
            organization: 'Gates Foundation',
            profileComplete: 65,
            isPremium: false,
            interests: ['digital-literacy', 'teacher-training', 'stem', 'gender-equity', 'south-africa', 'nigeria', 'kenya']
        };

        let currentReportType = '';
        let charts = {};
        let countdownInterval;

        // Event database
        const eventsDatabase = [
            {
                id: 1,
                title: "African Education Summit 2024",
                description: "Join 500+ education leaders in Nairobi. Keynote on 'AI in African Education'",
                date: "March 15-17, 2024",
                location: "Nairobi, Kenya",
                avatar: "📅",
                tags: ["ai", "leadership", "africa", "policy"],
                matchScore: 92,
                recommendation: "High match: Aligns with your focus on digital literacy and AI in education"
            },
            {
                id: 2,
                title: "ESG Impact Measurement Workshop",
                description: "Hands-on session on measuring education ROI and social impact metrics",
                date: "March 22, 2024",
                location: "Virtual",
                avatar: "🎯",
                tags: ["esg", "measurement", "roi", "metrics"],
                matchScore: 88,
                recommendation: "Strong match: Enhances your ESG reporting capabilities"
            },
            {
                id: 3,
                title: "Co-Investment Roundtable",
                description: "Exclusive session for education Impact Donors. Opportunity ripple and partnership opportunities",
                date: "April 5, 2024",
                location: "Cape Town, SA",
                avatar: "🤝",
                tags: ["investment", "partnerships", "opportunity-ripple", "south-africa"],
                matchScore: 95,
                recommendation: "Perfect match: Direct alignment with your investment focus in South Africa"
            },
            {
                id: 4,
                title: "UNESCO Global Education Forum",
                description: "Policy makers and Impact Donors shaping the future of education in Africa",
                date: "April 18-20, 2024",
                location: "Paris, France",
                avatar: "🌍",
                tags: ["policy", "unesco", "global", "leadership"],
                matchScore: 85,
                recommendation: "Good match: Policy focus aligns with your organizational goals"
            },
            {
                id: 5,
                title: "EdTech Innovation Challenge",
                description: "Pitch competition for African EdTech startups with $1M in funding available",
                date: "May 10-12, 2024",
                location: "Lagos, Nigeria",
                avatar: "💡",
                tags: ["edtech", "startups", "innovation", "nigeria", "funding"],
                matchScore: 90,
                recommendation: "Excellent match: Direct connection to your Nigerian portfolio and EdTech focus"
            },
            {
                id: 6,
                title: "Gender Equity in Education Conference",
                description: "Strategies for advancing girls' education and women's leadership in education",
                date: "June 5-7, 2024",
                location: "Kigali, Rwanda",
                avatar: "⚖️",
                tags: ["gender", "equity", "leadership", "rwanda"],
                matchScore: 87,
                recommendation: "Strong match: Aligns with your gender equity initiatives"
            }
        ];

        // Data Architecture Transformation - Smart Formatting Functions
        const Formatters = {
            number: (value, decimals = 0) => {
                return new Intl.NumberFormat('en-US', {
                    minimumFractionDigits: decimals,
                    maximumFractionDigits: decimals
                }).format(value);
            },
            
            percentage: (value, decimals = 1) => {
                return new Intl.NumberFormat('en-US', {
                    style: 'percent',
                    minimumFractionDigits: decimals,
                    maximumFractionDigits: decimals
                }).format(value / 100);
            },
            
            currency: (value, currency = 'USD', decimals = 0) => {
                return new Intl.NumberFormat('en-US', {
                    style: 'currency',
                    currency: currency,
                    minimumFractionDigits: decimals,
                    maximumFractionDigits: decimals
                }).format(value);
            },
            
            compactNumber: (value) => {
                return new Intl.NumberFormat('en-US', {
                    notation: 'compact',
                    maximumFractionDigits: 1
                }).format(value);
            },
            
            formatMetric: (value, type) => {
                switch(type) {
                    case 'currency':
                        return Formatters.currency(value);
                    case 'percentage':
                        return Formatters.percentage(value);
                    case 'compact':
                        return Formatters.compactNumber(value);
                    default:
                        return Formatters.number(value);
                }
            }
        };

        // Initialize dashboard
        document.addEventListener('DOMContentLoaded', function() {
            initializeCharts();
            updateTimestamp();
            personalizeContent();
            loadAIRecommendedEvents();
            applySmartFormatting();
            
            // Update timestamp every hour
            setInterval(updateTimestamp, 3600000);
            
            // Initialize calculator
            initializeCalculator();
            
            // Check for existing profile
            const savedProfile = localStorage.getItem('esgProfile');
            if (savedProfile) {
                const profile = JSON.parse(savedProfile);
                // Populate profile modal if needed
                Object.keys(profile).forEach(key => {
                    const input = document.querySelector(`[name="${key}"]`);
                    if (input) {
                        if (Array.isArray(profile[key])) {
                            input.value = profile[key].join(', ');
                        } else {
                            input.value = profile[key];
                        }
                    }
                });
            }
        });

        // Apply smart formatting to all metrics
        function applySmartFormatting() {
            // Format all metric values
            document.querySelectorAll('.metric-value').forEach(element => {
                const text = element.textContent.trim();
                let formattedValue = text;
                
                // Detect and format different value types
                if (text.includes('$')) {
                    const numericValue = parseFloat(text.replace(/[$,]/g, ''));
                    if (!isNaN(numericValue)) {
                        formattedValue = Formatters.currency(numericValue);
                    }
                } else if (text.includes('%')) {
                    const numericValue = parseFloat(text.replace('%', ''));
                    if (!isNaN(numericValue)) {
                        formattedValue = Formatters.percentage(numericValue);
                    }
                } else if (text.includes('K') || text.includes('M') || text.includes('B')) {
                    // Already compact formatted
                } else {
                    const numericValue = parseFloat(text.replace(/,/g, ''));
                    if (!isNaN(numericValue) && numericValue > 1000) {
                        formattedValue = Formatters.compactNumber(numericValue);
                    }
                }
                
                element.textContent = formattedValue;
            });

            // Format opportunity metrics
            document.querySelectorAll('.opportunity-metric-value').forEach(element => {
                const text = element.textContent.trim();
                let formattedValue = text;
                
                if (text.includes('$')) {
                    const numericValue = parseFloat(text.replace(/[$,]/g, ''));
                    if (!isNaN(numericValue)) {
                        formattedValue = Formatters.currency(numericValue);
                    }
                } else if (!isNaN(parseFloat(text))) {
                    const numericValue = parseFloat(text);
                    if (numericValue > 1000) {
                        formattedValue = Formatters.compactNumber(numericValue);
                    }
                }
                
                element.textContent = formattedValue;
            });
        }

        // Load AI recommended events
        function loadAIRecommendedEvents() {
            const container = document.getElementById('ai-events-container');
            if (!container) return;
            
            // Sort events by match score (highest first)
            const sortedEvents = [...eventsDatabase].sort((a, b) => b.matchScore - a.matchScore);
            
            // Clear container
            container.innerHTML = '';
            
            // Add events to container
            sortedEvents.forEach(event => {
                const eventElement = document.createElement('div');
                eventElement.className = 'discussion-item';
                eventElement.innerHTML = `
                    <div class="discussion-avatar">${event.avatar}</div>
                    <div class="discussion-content">
                        <div class="discussion-author">
                            ${event.title}
                            <span class="event-match-score">${Formatters.percentage(event.matchScore)} Match</span>
                        </div>
                        <div class="discussion-text">${event.description}</div>
                        <div class="discussion-meta">${event.date} • ${event.location}</div>
                        <div class="event-ai-recommendation">${event.recommendation}</div>
                    </div>
                `;
                container.appendChild(eventElement);
            });
        }

        // Tab navigation
        function showTab(tabName) {
            // Hide all tabs
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Remove active class from nav items
            document.querySelectorAll('.nav-item').forEach(item => {
                item.classList.remove('active');
            });
            
            // Show selected tab
            document.getElementById(tabName).classList.add('active');
            
            // Add active class to clicked nav item
            event.target.closest('.nav-item').classList.add('active');
            
            // Special handling for collaboration tab
            if (tabName === 'collaboration') {
                loadAIRecommendedEvents();
            }
            
            // Apply formatting when switching tabs
            setTimeout(applySmartFormatting, 100);
        }

        // Initialize charts
        function initializeCharts() {
            // Region Chart
            const regionCtx = document.getElementById('regionChart').getContext('2d');
            charts.regionChart = new Chart(regionCtx, {
                type: 'bar',
                data: {
                    labels: ['South Africa', 'Nigeria', 'Kenya', 'Ghana'],
                    datasets: [{
                        label: 'Students Reached',
                        data: [85000, 95000, 65000, 40000],
                        backgroundColor: [
                            'rgba(0, 212, 255, 0.8)',
                            'rgba(139, 92, 246, 0.8)',
                            'rgba(0, 255, 136, 0.8)',
                            'rgba(255, 215, 0, 0.8)'
                        ],
                        borderColor: [
                            'rgb(0, 212, 255)',
                            'rgb(139, 92, 246)',
                            'rgb(0, 255, 136)',
                            'rgb(255, 215, 0)'
                        ],
                        borderWidth: 2
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        title: {
                            display: false
                        },
                        legend: {
                            display: false
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return `Students: ${Formatters.number(context.parsed.y)}`;
                                }
                            }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                color: 'rgba(255, 255, 255, 0.7)',
                                callback: function(value) {
                                    return Formatters.compactNumber(value);
                                }
                            },
                            grid: {
                                color: 'rgba(255, 255, 255, 0.1)'
                            }
                        },
                        x: {
                            ticks: {
                                color: 'rgba(255, 255, 255, 0.7)'
                            },
                            grid: {
                                color: 'rgba(255, 255, 255, 0.1)'
                            }
                        }
                    }
                }
            });

            // ROI Trend Chart
            const roiCtx = document.getElementById('roiChart').getContext('2d');
            charts.roiChart = new Chart(roiCtx, {
                type: 'line',
                data: {
                    labels: ['2022 Q1', '2022 Q2', '2022 Q3', '2022 Q4', '2023 Q1', '2023 Q2', '2023 Q3', '2023 Q4', '2024 Q1'],
                    datasets: [{
                        label: 'Impact ROI',
                        data: [2.1, 2.8, 3.2, 3.9, 4.2, 4.8, 5.1, 5.5, 5.8],
                        borderColor: 'rgb(0, 212, 255)',
                        backgroundColor: 'rgba(0, 212, 255, 0.1)',
                        tension: 0.4,
                        fill: true
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            display: false
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return `ROI: ${Formatters.number(context.parsed.y, 1)}x`;
                                }
                            }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                color: 'rgba(255, 255, 255, 0.7)',
                                callback: function(value) {
                                    return Formatters.number(value, 1) + 'x';
                                }
                            },
                            grid: {
                                color: 'rgba(255, 255, 255, 0.1)'
                            }
                        },
                        x: {
                            ticks: {
                                color: 'rgba(255, 255, 255, 0.7)'
                            },
                            grid: {
                                color: 'rgba(255, 255, 255, 0.1)'
                            }
                        }
                    }
                }
            });

            // Preview charts (blurred)
            createPreviewChart('previewChart');
            createPreviewChart('portfolioPreview');
        }

        function createPreviewChart(canvasId) {
            const ctx = document.getElementById(canvasId).getContext('2d');
            new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: ['High Impact', 'Medium Impact', 'Emerging'],
                    datasets: [{
                        data: [60, 30, 10],
                        backgroundColor: [
                            'rgba(0, 255, 136, 0.8)',
                            'rgba(255, 215, 0, 0.8)',
                            'rgba(139, 92, 246, 0.8)'
                        ]
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            display: false
                        }
                    }
                }
            });
        }

        // Initialize actuarial calculator
        function initializeCalculator() {
            const investmentSlider = document.getElementById('investmentSlider');
            const timeSlider = document.getElementById('timeSlider');
            const riskSelect = document.getElementById('riskSelect');
            const geoSelect = document.getElementById('geoSelect');

            // Add event listeners
            investmentSlider.addEventListener('input', updateCalculator);
            timeSlider.addEventListener('input', updateCalculator);
            riskSelect.addEventListener('change', updateCalculator);
            geoSelect.addEventListener('change', updateCalculator);

            // Initialize projection chart
            const projCtx = document.getElementById('projectionChart').getContext('2d');
            charts.projectionChart = new Chart(projCtx, {
                type: 'line',
                data: {
                    labels: ['Year 1', 'Year 2', 'Year 3', 'Year 4', 'Year 5'],
                    datasets: [{
                        label: 'Conservative',
                        data: [2.5, 5.2, 8.1, 11.3, 14.8],
                        borderColor: 'rgba(255, 215, 0, 0.8)',
                        backgroundColor: 'rgba(255, 215, 0, 0.1)',
                        fill: false
                    }, {
                        label: 'Expected',
                        data: [2.5, 6.1, 10.2, 15.1, 20.8],
                        borderColor: 'rgba(0, 212, 255, 0.8)',
                        backgroundColor: 'rgba(0, 212, 255, 0.1)',
                        fill: false
                    }, {
                        label: 'Optimistic',
                        data: [2.5, 7.3, 13.2, 21.1, 31.2],
                        borderColor: 'rgba(0, 255, 136, 0.8)',
                        backgroundColor: 'rgba(0, 255, 136, 0.1)',
                        fill: false
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        title: {
                            display: true,
                            text: '5-Year Portfolio Value Projection',
                            color: 'rgba(255, 255, 255, 0.9)'
                        },
                        legend: {
                            labels: {
                                color: 'rgba(255, 255, 255, 0.7)'
                            }
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return `${context.dataset.label}: ${Formatters.currency(context.parsed.y, 'USD', 1)}`;
                                }
                            }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                color: 'rgba(255, 255, 255, 0.7)',
                                callback: function(value) {
                                    return Formatters.currency(value, 'USD', 0);
                                }
                            },
                            grid: {
                                color: 'rgba(255, 255, 255, 0.1)'
                            }
                        },
                        x: {
                            ticks: {
                                color: 'rgba(255, 255, 255, 0.7)'
                            },
                            grid: {
                                color: 'rgba(255, 255, 255, 0.1)'
                            }
                        }
                    }
                }
            });

            updateCalculator();
        }

        function updateCalculator() {
            const investment = parseFloat(document.getElementById('investmentSlider').value);
            const timeHorizon = parseInt(document.getElementById('timeSlider').value);
            const risk = document.getElementById('riskSelect').value;
            const geography = document.getElementById('geoSelect').value;

            // Update display values with formatting
            document.getElementById('investmentValue').textContent = Formatters.currency(investment, 'USD', 1);
            document.getElementById('timeValue').textContent = `${timeHorizon} years`;

            // Calculate projections based on inputs
            let baseROI = 3.5;
            let studentsMultiplier = 50000;
            let esgScore = 85;
            let riskLevel = 'Medium';

            // Adjust based on risk tolerance
            switch(risk) {
                case 'conservative':
                    baseROI *= 0.8;
                    riskLevel = 'Low';
                    break;
                case 'aggressive':
                    baseROI *= 1.3;
                    riskLevel = 'High';
                    break;
            }

            // Adjust based on geography
            switch(geography) {
                case 'africa':
                    baseROI *= 1.2;
                    studentsMultiplier *= 1.5;
                    break;
                case 'asia':
                    baseROI *= 1.1;
                    studentsMultiplier *= 1.3;
                    break;
                case 'global':
                    baseROI *= 0.9;
                    studentsMultiplier *= 0.8;
                    break;
            }

            // Calculate final projections
            const finalROI = (baseROI * (timeHorizon / 5)).toFixed(1);
            const finalStudents = Math.round(investment * studentsMultiplier);
            const finalESG = Math.min(95, esgScore + (timeHorizon * 2));

            // Update display with formatted values
            document.getElementById('projectedROI').textContent = `${finalROI}x`;
            document.getElementById('projectedStudents').textContent = Formatters.compactNumber(finalStudents);
            document.getElementById('projectedESG').textContent = finalESG;
            document.getElementById('projectedRisk').textContent = riskLevel;

            // Update chart data
            const chart = charts.projectionChart;
            const multiplier = investment / 2.5; // Base case is 2.5M
            
            chart.data.datasets[0].data = [
                investment,
                investment * 1.8 * multiplier,
                investment * 2.6 * multiplier,
                investment * 3.2 * multiplier,
                investment * 3.8 * multiplier
            ];
            
            chart.data.datasets[1].data = [
                investment,
                investment * 2.1 * multiplier,
                investment * 3.2 * multiplier,
                investment * 4.5 * multiplier,
                investment * 5.8 * multiplier
            ];
            
            chart.data.datasets[2].data = [
                investment,
                investment * 2.5 * multiplier,
                investment * 4.1 * multiplier,
                investment * 6.2 * multiplier,
                investment * 8.9 * multiplier
            ];
            
            chart.update();
        }

        // Update timestamp
        function updateTimestamp() {
            const now = new Date();
            const timeString = now.toLocaleString('en-US', {
                month: 'short',
                day: 'numeric',
                hour: '2-digit',
                minute: '2-digit'
            });
            document.getElementById('lastUpdate').textContent = timeString;
        }

        // Personalize content based on user profile
        function personalizeContent() {
            // Update story titles with user organization
            const stories = document.querySelectorAll('.story-title');
            if (stories.length > 0) {
                stories[0].textContent = `${currentUser.organization} Empowers Nomsa's Teaching Revolution in South Africa`;
            }
        }

        // Show profile modal
        function showProfileModal() {
            const modal = new bootstrap.Modal(document.getElementById('profileModal'));
            modal.show();
        }

        // Save profile
        function saveProfile() {
            const formData = {
                orgName: document.getElementById('orgName').value,
                orgType: document.getElementById('orgType').value,
                websiteUrl: document.getElementById('websiteUrl').value,
                primaryGeo: document.getElementById('primaryGeo').value,
                educationFocus: getSelectedCheckboxes('input[type="checkbox"]:checked'),
                sdgGoals: Array.from(document.getElementById('sdgGoals').selectedOptions).map(option => option.value),
                reportFreq: document.getElementById('reportFreq').value
            };

            // Validate required fields
            if (!formData.orgName || !formData.orgType || !formData.primaryGeo) {
                alert('Please fill in all required fields.');
                return;
            }

            // Save to backend (simulated)
            console.log('Saving profile:', formData);
            
            // Update UI
            currentUser.profileComplete = 100;
            document.querySelector('.profile-completion').innerHTML = `
                <i class="fas fa-check-circle"></i>
                Profile: Complete
                <div class="progress mt-1">
                    <div class="progress-bar" style="width: 100%"></div>
                </div>
            `;

            // Close modal
            bootstrap.Modal.getInstance(document.getElementById('profileModal')).hide();
            
            // Show success message
            alert('Profile saved successfully! Your dashboard will now show personalized content.');
            
            // Refresh personalized content
            personalizeContent();
        }

        function getSelectedCheckboxes(selector) {
            return Array.from(document.querySelectorAll(selector)).map(cb => cb.id);
        }

        // Generate report function
        async function generateReport(reportType) {
            const statusEl = document.getElementById('report-status');
            const messageEl = document.getElementById('status-message');
            const countdownEl = document.getElementById('countdown-timer');
            const progressBar = document.getElementById('progress-bar');
            
            const profileData = localStorage.getItem('esgProfile');
            if (!profileData) {
                alert('⚠️ Please complete your profile first!');
                showProfileModal();
                return;
            }
            
            const profile = JSON.parse(profileData);
            statusEl.style.display = 'flex';
            
            // Progress messages array
            const progressMessages = [
                'Initializing AI analysis...',
                'Scraping your website for latest data...',
                'Analyzing sector benchmarks...',
                'Generating insights with NanoGPT-5...',
                'Creating impact narratives...',
                'Calculating ROI projections...',
                'Compiling policy insights...',
                'Generating visualizations...',
                'Finalizing your report...'
            ];
            
            let messageIndex = 0;
            messageEl.textContent = progressMessages[0];
            let countdown = 45;
            countdownEl.textContent = countdown;
            
            // Start countdown
            clearInterval(countdownInterval);
            countdownInterval = setInterval(() => {
                countdown--;
                countdownEl.textContent = countdown;
                
                // Update progress bar
                const progress = ((45 - countdown) / 45) * 100;
                progressBar.style.width = `${progress}%`;
                
                if (countdown <= 0) {
                    clearInterval(countdownInterval);
                }
            }, 1000);
            
            // Rotate through progress messages every 8 seconds
            const progressInterval = setInterval(() => {
                messageIndex = (messageIndex + 1) % progressMessages.length;
                messageEl.textContent = progressMessages[messageIndex];
            }, 8000);
            
            try {
                const startTime = Date.now();
                
                // Simulate API call (replace with actual API call)
                await new Promise(resolve => setTimeout(resolve, 45000));
                
                clearInterval(progressInterval);
                clearInterval(countdownInterval);
                
                // Generate PDF report
                const { jsPDF } = window.jspdf;
                const doc = new jsPDF();
                
                // Add content to PDF
                doc.setFontSize(18);
                doc.text(`Impact Report - ${reportType.replace(/_/g, ' ').toUpperCase()}`, 20, 20);
                doc.setFontSize(12);
                doc.text(`Generated for: ${profile.orgName}`, 20, 40);
                doc.text(`Date: ${new Date().toLocaleDateString()}`, 20, 50);
                doc.text('Powered by NanoGPT-5 AI + Auxeira Analytics', 20, 80);
                
                const filename = `${reportType}_${profile.orgName.replace(/\s+/g,'_')}_${Date.now()}.pdf`;
                doc.save(filename);
                
                statusEl.style.display = 'none';
                
                const elapsedTime = Math.round((Date.now() - startTime) / 1000);
                alert(`✅ AI Report Generated in ${elapsedTime}s!\n\nFile: ${filename}\n\nPowered by NanoGPT-5`);
                
            } catch (error) {
                clearInterval(progressInterval);
                clearInterval(countdownInterval);
                console.error('Error:', error);
                statusEl.style.display = 'none';
                
                let errorMsg = '❌ Error generating report:\n\n';
                if (error.message.includes('504')) {
                    errorMsg += 'Request timeout. The AI is taking longer than expected.\n\nTip: Try again - the system is processing complex analysis.';
                } else if (error.message.includes('CORS') || error.message.includes('Failed to fetch')) {
                    errorMsg += 'Connection issue. Please refresh and try again.';
                } else {
                    errorMsg += error.message;
                }
                
                alert(errorMsg);
            }
        }

        // Show premium modal
        function showPremiumModal(reportType) {
            currentReportType = reportType;
            
            const reportData = {
                'impact-report': {
                    title: 'Impact Report',
                    description: 'Emotional narratives showcasing real-world impact of your education investments.',
                    price: '$149'
                },
                'portfolio-analysis': {
                    title: 'Executive Portfolio Analysis',
                    description: 'Comprehensive portfolio analysis with strategic opportunities and risk assessment.',
                    price: '$299'
                }
            };

            const report = reportData[reportType];
            if (report) {
                document.getElementById('reportTitle').textContent = report.title;
                document.getElementById('reportDescription').textContent = report.description;
                document.getElementById('reportPrice').textContent = report.price;
            }

            const modal = new bootstrap.Modal(document.getElementById('premiumModal'));
            modal.show();
        }

        // Process payment with Paystack
        function processPayment() {
            const reportPrices = {
                'impact-report': 14900,
                'portfolio-analysis': 29900
            };

            const amount = reportPrices[currentReportType] || 14900;

            const handler = PaystackPop.setup({
                key: 'pk_test_your_paystack_public_key',
                email: 'user@example.com',
                amount: amount,
                currency: 'USD',
                ref: 'auxeira_report_' + Math.floor((Math.random() * 1000000000) + 1),
                metadata: {
                    reportType: currentReportType,
                    userId: currentUser.id || 'demo_user'
                },
                callback: function(response) {
                    console.log('Payment successful:', response);
                    bootstrap.Modal.getInstance(document.getElementById('premiumModal')).hide();
                    alert('Payment successful! Generating your report...');
                    generateReport(currentReportType);
                },
                onClose: function() {
                    console.log('Payment window closed');
                }
            });

            handler.openIframe();
        }

        // Play story audio (simulated)
        function playStoryAudio(storyId) {
            console.log(`Playing audio for story: ${storyId}`);
            alert(`Playing audio narration for ${storyId}. This would use NanoGPT-5 generated audio.`);
        }

        // Show create collaboration modal
        function showCreateCollabModal() {
            const modal = new bootstrap.Modal(document.getElementById('createCollabModal'));
            modal.show();
        }

        // Create collaboration
        function createCollaboration() {
            const formData = {
                type: document.getElementById('collabType').value,
                name: document.getElementById('collabName').value,
                amount: document.getElementById('collabAmount').value,
                geography: document.getElementById('collabGeo').value,
                focus: document.getElementById('collabFocus').value,
                description: document.getElementById('collabDescription').value,
                timeline: document.getElementById('collabTimeline').value,
                impact: document.getElementById('collabImpact').value
            };

            // Validate required fields
            if (!formData.name || !formData.amount || !formData.description) {
                alert('Please fill in all required fields.');
                return;
            }

            // Save collaboration (simulated)
            console.log('Creating collaboration:', formData);
            
            // Close modal
            bootstrap.Modal.getInstance(document.getElementById('createCollabModal')).hide();
            
            // Show success message
            alert('Collaboration created successfully! Other Impact Donors will be notified of this opportunity.');
            
            // Reset form
            document.getElementById('collabForm').reset();
        }

        // Accessibility enhancements
        document.addEventListener('keydown', function(e) {
            if (e.key === 'ArrowRight' || e.key === 'ArrowLeft') {
                const activeTab = document.querySelector('.nav-item.active');
                if (activeTab) {
                    const tabs = Array.from(document.querySelectorAll('.nav-item'));
                    const currentIndex = tabs.indexOf(activeTab);
                    let nextIndex;
                    
                    if (e.key === 'ArrowRight') {
                        nextIndex = (currentIndex + 1) % tabs.length;
                    } else {
                        nextIndex = (currentIndex - 1 + tabs.length) % tabs.length;
                    }
                    
                    tabs[nextIndex].click();
                    tabs[nextIndex].focus();
                }
            }
        });

        // Add ARIA labels to charts
        document.querySelectorAll('canvas').forEach(canvas => {
            canvas.setAttribute('role', 'img');
            canvas.setAttribute('aria-label', 'Chart displaying education impact metrics');
        });

        // High contrast mode detection
        if (window.matchMedia('(prefers-contrast: high)').matches) {
            document.documentElement.style.setProperty('--glass-bg', 'rgba(255, 255, 255, 0.15)');
            document.documentElement.style.setProperty('--glass-border', 'rgba(255, 255, 255, 0.3)');
        }

        // Reduced motion detection
        if (window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
            document.documentElement.style.setProperty('--animation-duration', '0.01ms');
        }
    </script>
</body>
</html>
