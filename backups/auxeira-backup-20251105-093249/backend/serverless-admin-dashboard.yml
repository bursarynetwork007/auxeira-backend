service: auxeira-admin-dashboard
frameworkVersion: '3'

provider:
  name: aws
  runtime: nodejs18.x
  region: us-east-1
  stage: prod
  memorySize: 512
  timeout: 30
  environment:
    JWT_SECRET: ${env:JWT_SECRET, 'your-super-secret-jwt-key-change-in-production'}
    AWS_REGION: us-east-1
  iamRoleStatements:
    - Effect: Allow
      Action:
        - dynamodb:Query
        - dynamodb:Scan
        - dynamodb:GetItem
      Resource:
        - "arn:aws:dynamodb:us-east-1:*:table/auxeira-backend-users-prod"
        - "arn:aws:dynamodb:us-east-1:*:table/auxeira-backend-users-prod/index/*"
        - "arn:aws:dynamodb:us-east-1:*:table/auxeira-startup-profiles-prod"
        - "arn:aws:dynamodb:us-east-1:*:table/auxeira-startup-profiles-prod/index/*"
        - "arn:aws:dynamodb:us-east-1:*:table/auxeira-startup-activities-prod"
        - "arn:aws:dynamodb:us-east-1:*:table/auxeira-startup-activities-prod/index/*"
        - "arn:aws:dynamodb:us-east-1:*:table/auxeira-user-startup-mapping-prod"
        - "arn:aws:dynamodb:us-east-1:*:table/auxeira-user-startup-mapping-prod/index/*"
        - "arn:aws:dynamodb:us-east-1:*:table/auxeira-subscriptions"
        - "arn:aws:dynamodb:us-east-1:*:table/auxeira-subscriptions/index/*"
        - "arn:aws:dynamodb:us-east-1:*:table/auxeira-backend-sessions-prod"
        - "arn:aws:dynamodb:us-east-1:*:table/auxeira-backend-sessions-prod/index/*"

functions:
  admin:
    handler: lambda-admin-dashboard.handler
    url:
      cors:
        allowedOrigins:
          - '*'
        allowedHeaders:
          - '*'
        allowedMethods:
          - '*'
        maxAge: 86400

package:
  patterns:
    - lambda-admin-dashboard.js
    - node_modules/**
    - '!node_modules/aws-sdk/**'
    - '!**/*.zip'
    - '!**/*.backup'
