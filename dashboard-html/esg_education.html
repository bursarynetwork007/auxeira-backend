<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Auxeira ESG Education Impact Dashboard</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns/dist/chartjs-adapter-date-fns.bundle.min.js"></script>
    <script src="https://js.paystack.co/v1/inline.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <style>
        :root {
            --terminal-dark: #0a0a0a;
            --terminal-darker: #050505;
            --terminal-blue: #00d4ff;
            --terminal-purple: #8b5cf6;
            --terminal-green: #00ff88;
            --terminal-gold: #ffd700;
            --terminal-white: #ffffff;
            --terminal-gray: #cccccc;
            --glass-bg: rgba(255, 255, 255, 0.05);
            --glass-border: rgba(255, 255, 255, 0.1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, var(--terminal-dark) 0%, var(--terminal-darker) 100%);
            color: var(--terminal-white);
            min-height: 100vh;
            overflow-x: hidden;
            font-size: 16px;
            line-height: 1.6;
        }

        .terminal-header {
            background: var(--glass-bg);
            backdrop-filter: blur(20px);
            border-bottom: 1px solid var(--glass-border);
            padding: 1rem 2rem;
            position: sticky;
            top: 0;
            z-index: 1000;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            font-size: 1.8rem;
            font-weight: bold;
            background: linear-gradient(45deg, var(--terminal-blue), var(--terminal-purple));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .profile-completion {
            background: var(--glass-bg);
            border: 1px solid var(--glass-border);
            border-radius: 20px;
            padding: 0.5rem 1rem;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.3s ease;
            color: var(--terminal-white);
            text-decoration: none;
        }

        .profile-completion:hover {
            background: var(--terminal-blue);
            color: var(--terminal-dark);
        }

        .data-refresh {
            font-size: 0.8rem;
            opacity: 0.7;
            color: var(--terminal-green);
        }

        .main-container {
            display: flex;
            min-height: calc(100vh - 80px);
        }

        .sidebar {
            width: 280px;
            background: var(--glass-bg);
            backdrop-filter: blur(20px);
            border-right: 1px solid var(--glass-border);
            padding: 2rem 0;
            position: sticky;
            top: 80px;
            height: calc(100vh - 80px);
            overflow-y: auto;
        }

        .nav-item {
            padding: 1rem 2rem;
            cursor: pointer;
            transition: all 0.3s ease;
            border-left: 3px solid transparent;
            display: flex;
            align-items: center;
            gap: 1rem;
            color: var(--terminal-white);
        }

        .nav-item:hover, .nav-item.active {
            background: var(--glass-bg);
            border-left-color: var(--terminal-blue);
            color: var(--terminal-blue);
        }

        .content-area {
            flex: 1;
            padding: 2rem;
            overflow-y: auto;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
            animation: fadeIn 0.5s ease-in-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .glass-card {
            background: var(--glass-bg);
            backdrop-filter: blur(20px);
            border: 1px solid var(--glass-border);
            border-radius: 16px;
            padding: 2rem;
            margin-bottom: 2rem;
            transition: all 0.3s ease;
        }

        .glass-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 40px rgba(0, 212, 255, 0.1);
        }

        .hero-impact {
            text-align: center;
            padding: 3rem 0;
            background: linear-gradient(135deg, var(--terminal-blue), var(--terminal-purple));
            border-radius: 20px;
            margin-bottom: 3rem;
            position: relative;
            overflow: hidden;
        }

        .hero-impact::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><defs><pattern id="grid" width="10" height="10" patternUnits="userSpaceOnUse"><path d="M 10 0 L 0 0 0 10" fill="none" stroke="rgba(255,255,255,0.1)" stroke-width="0.5"/></pattern></defs><rect width="100" height="100" fill="url(%23grid)"/></svg>');
            opacity: 0.3;
        }

        .hero-content {
            position: relative;
            z-index: 2;
        }

        .impact-number {
            font-size: 4rem;
            font-weight: bold;
            color: var(--terminal-white);
            text-shadow: 0 0 20px rgba(255, 255, 255, 0.5);
            animation: countUp 2s ease-out;
        }

        @keyframes countUp {
            from { opacity: 0; transform: scale(0.5); }
            to { opacity: 1; transform: scale(1); }
        }

        .impact-label {
            font-size: 1.2rem;
            opacity: 0.9;
            margin-top: 0.5rem;
        }

        .story-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 2rem;
            margin: 2rem 0;
        }

        .story-card {
            background: var(--glass-bg);
            border: 1px solid var(--glass-border);
            border-radius: 16px;
            padding: 2rem;
            transition: all 0.3s ease;
            cursor: pointer;
            position: relative;
            overflow: hidden;
        }

        .story-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 4px;
            height: 100%;
            background: linear-gradient(45deg, var(--terminal-blue), var(--terminal-purple));
        }

        .story-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 20px 40px rgba(139, 92, 246, 0.2);
        }

        .story-title {
            font-size: 1.3rem;
            font-weight: bold;
            margin-bottom: 1rem;
            color: var(--terminal-blue);
        }

        .story-content {
            line-height: 1.6;
            margin-bottom: 1.5rem;
            color: var(--terminal-white);
        }

        .story-metrics {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding-top: 1rem;
            border-top: 1px solid var(--glass-border);
        }

        .metric-item {
            text-align: center;
        }

        .metric-value {
            font-size: 1.5rem;
            font-weight: bold;
            color: var(--terminal-green);
        }

        .metric-label {
            font-size: 0.9rem;
            opacity: 0.7;
            color: var(--terminal-gray);
        }

        /* FIXED: Chart container with proper dimensions */
        .chart-container {
            background: var(--glass-bg);
            border-radius: 16px;
            padding: 2rem;
            margin: 2rem 0;
            position: relative;
            width: 100%;
            height: 400px;
            overflow: hidden;
        }

        .chart-container canvas {
            max-width: 100% !important;
            max-height: 100% !important;
            width: 100% !important;
            height: calc(100% - 60px) !important; /* Account for title */
        }

        .chart-title {
            font-size: 1.4rem;
            font-weight: bold;
            margin-bottom: 1.5rem;
            color: var(--terminal-blue);
            text-align: center;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* FIXED: Portfolio specific chart containers */
        .portfolio-chart-container {
            background: var(--glass-bg);
            border-radius: 16px;
            padding: 2rem;
            margin: 2rem 0;
            position: relative;
            width: 100%;
            min-height: 400px;
        }

        .portfolio-chart-container canvas {
            width: 100% !important;
            height: 350px !important;
            max-width: 100% !important;
            max-height: 350px !important;
        }

        .btn-primary {
            background: linear-gradient(45deg, var(--terminal-blue), var(--terminal-purple));
            border: none;
            border-radius: 25px;
            padding: 0.8rem 2rem;
            font-weight: bold;
            transition: all 0.3s ease;
            color: var(--terminal-white);
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(0, 212, 255, 0.3);
            color: var(--terminal-white);
        }

        .btn-premium {
            background: linear-gradient(45deg, var(--terminal-gold), #ff6b35);
            border: none;
            border-radius: 25px;
            padding: 0.8rem 2rem;
            font-weight: bold;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            color: var(--terminal-dark);
        }

        .btn-premium::before {
            content: 'üëë';
            margin-right: 0.5rem;
        }

        .btn-premium:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(255, 215, 0, 0.3);
            color: var(--terminal-dark);
        }

        .premium-badge {
            background: linear-gradient(45deg, var(--terminal-gold), #ff6b35);
            color: var(--terminal-dark);
            padding: 0.3rem 0.8rem;
            border-radius: 15px;
            font-size: 0.9rem;
            font-weight: bold;
        }

        .report-card {
            background: var(--glass-bg);
            border: 1px solid var(--glass-border);
            border-radius: 16px;
            padding: 2rem;
            margin-bottom: 1.5rem;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
        }

        .report-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 30px rgba(0, 212, 255, 0.1);
            border-color: var(--terminal-blue);
        }

        .report-title {
            font-size: 1.3rem;
            font-weight: bold;
            color: var(--terminal-blue);
            margin-bottom: 0.5rem;
        }

        .report-description {
            color: var(--terminal-gray);
            margin-bottom: 1rem;
        }

        .tag {
            display: inline-block;
            padding: 0.2rem 0.6rem;
            border-radius: 12px;
            font-size: 0.8rem;
            font-weight: bold;
            margin-right: 0.5rem;
            margin-bottom: 0.5rem;
        }

        .tag-sfdr { background: var(--terminal-blue); color: var(--terminal-dark); }
        .tag-csrd { background: var(--terminal-green); color: var(--terminal-dark); }
        .tag-tcfd { background: var(--terminal-purple); color: var(--terminal-white); }
        .tag-unesco { background: var(--terminal-gold); color: var(--terminal-dark); }
        .tag-gri { background: #00ffff; color: var(--terminal-dark); }

        /* Accessibility Controls */
        .accessibility-controls {
            position: fixed;
            top: 100px;
            right: 20px;
            z-index: 1000;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .accessibility-btn {
            background: var(--terminal-dark);
            border: 1px solid var(--terminal-blue);
            color: var(--terminal-white);
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .accessibility-btn:hover {
            background: var(--terminal-blue);
            color: var(--terminal-dark);
        }

        /* High Contrast Mode */
        .high-contrast {
            --glass-bg: rgba(0, 0, 0, 0.8);
            --glass-border: rgba(255, 255, 255, 0.8);
        }

        .high-contrast .glass-card,
        .high-contrast .story-card,
        .high-contrast .report-card {
            background: rgba(0, 0, 0, 0.9);
            border: 2px solid var(--terminal-white);
        }

        /* Portfolio Health Indicators */
        .portfolio-health {
            display: flex;
            gap: 1rem;
            margin-bottom: 2rem;
        }

        .health-indicator {
            flex: 1;
            background: var(--glass-bg);
            border-radius: 12px;
            padding: 1.5rem;
            text-align: center;
            border: 1px solid var(--glass-border);
        }

        .health-indicator.healthy {
            border-color: var(--terminal-green);
        }

        .health-indicator.warning {
            border-color: var(--terminal-gold);
        }

        .health-indicator.critical {
            border-color: #ff0040;
        }

        .health-icon {
            font-size: 2rem;
            margin-bottom: 0.5rem;
        }

        .health-label {
            font-size: 0.9rem;
            opacity: 0.8;
            color: var(--terminal-white);
        }

        .health-value {
            font-size: 1.5rem;
            font-weight: bold;
            margin: 0.5rem 0;
        }

        .healthy .health-value { color: var(--terminal-green); }
        .warning .health-value { color: var(--terminal-gold); }
        .critical .health-value { color: #ff0040; }

        /* Responsive Design */
        @media (max-width: 768px) {
            .main-container {
                flex-direction: column;
            }
            
            .sidebar {
                width: 100%;
                height: auto;
                position: relative;
                top: 0;
            }
            
            .nav-item {
                padding: 0.8rem 1rem;
            }
            
            .content-area {
                padding: 1rem;
            }
            
            .impact-number {
                font-size: 2.5rem;
            }
            
            .story-grid {
                grid-template-columns: 1fr;
            }
            
            .chart-container {
                height: 300px;
            }
            
            .portfolio-chart-container {
                min-height: 300px;
            }
            
            .portfolio-chart-container canvas {
                height: 250px !important;
                max-height: 250px !important;
            }
            
            .accessibility-controls {
                position: relative;
                top: auto;
                right: auto;
                flex-direction: row;
                justify-content: center;
                margin: 20px 0;
            }

            .terminal-header {
                padding: 1rem;
                flex-direction: column;
                gap: 1rem;
            }

            .user-info {
                flex-direction: column;
                gap: 0.5rem;
            }
        }

        /* Modal Styles */
        .modal-content {
            background: var(--terminal-dark);
            border: 1px solid var(--glass-border);
            color: var(--terminal-white);
        }

        .modal-header {
            border-bottom: 1px solid var(--glass-border);
        }

        .modal-footer {
            border-top: 1px solid var(--glass-border);
        }

        .modal-title {
            color: var(--terminal-blue);
        }

        .form-control, .form-select {
            background: var(--terminal-dark);
            border: 1px solid var(--glass-border);
            color: var(--terminal-white);
        }

        .form-control:focus, .form-select:focus {
            background: var(--terminal-dark);
            border-color: var(--terminal-blue);
            color: var(--terminal-white);
            box-shadow: 0 0 0 0.2rem rgba(0, 212, 255, 0.25);
        }

        .form-label {
            color: var(--terminal-white);
        }

        .btn-close-white {
            filter: invert(1) grayscale(100%) brightness(200%);
        }

        /* Premium Modal Styles */
        .premium-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 9999;
        }

        .premium-modal-content {
            background: var(--glass-bg);
            backdrop-filter: blur(20px);
            border: 1px solid var(--glass-border);
            border-radius: 20px;
            padding: 3rem;
            text-align: center;
            max-width: 500px;
            margin: 2rem;
        }

        .premium-lock-icon {
            font-size: 4rem;
            color: var(--terminal-gold);
            margin-bottom: 1rem;
        }

        /* Live indicator */
        .live-indicator {
            display: inline-block;
            width: 8px;
            height: 8px;
            background: var(--terminal-green);
            border-radius: 50%;
            animation: pulse 2s infinite;
            margin-left: 0.5rem;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.1); opacity: 0.7; }
        }

        /* Compliance badges */
        .compliance-badges {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            margin-bottom: 2rem;
        }

        /* Animation for numbers */
        .animated-number {
            animation: countUp 2s ease-out;
        }
    </style>
    <link rel="stylesheet" href="leaderboard_styles.css">
</head>
<body>
    <!-- Accessibility Controls -->
    <div class="accessibility-controls">
        <button class="accessibility-btn" onclick="toggleHighContrast()" aria-label="Toggle high contrast mode">
            <i class="fas fa-adjust"></i>
        </button>
        <button class="accessibility-btn" onclick="increaseFontSize()" aria-label="Increase font size">
            <i class="fas fa-search-plus"></i>
        </button>
        <button class="accessibility-btn" onclick="decreaseFontSize()" aria-label="Decrease font size">
            <i class="fas fa-search-minus"></i>
        </button>
    </div>

    <!-- Header -->
    <div class="terminal-header">
        <div class="logo">
            <i class="fas fa-graduation-cap me-2"></i>Auxeira | ESG Education Intelligence
        </div>
        <div class="user-info">
            <div class="profile-completion" onclick="showProfileModal()">
                <i class="fas fa-user-circle me-2"></i>
                <span id="profileCompletion">Profile: 65% Complete</span>
            </div>
            <div class="data-refresh">
                <i class="fas fa-sync-alt me-1"></i>
                <span id="timestamp">Last updated: 2024-10-17 14:30:00 UTC</span>
                <span class="live-indicator"></span>
            </div>
        </div>
    </div>

    <!-- Main Container -->
    <div class="main-container">
        <!-- Sidebar Navigation -->
        <div class="sidebar">
            <div class="nav-item active" onclick="showTab('overview')">
                <i class="fas fa-chart-line"></i>
                <span>Impact Overview</span>
            </div>
            <div class="nav-item" onclick="showTab('opportunity-ripple')">
                <i class="fas fa-handshake"></i>
                <span>Opportunity Ripple</span>
            </div>
            <div class="nav-item" onclick="showTab('portfolio')">
                <i class="fas fa-briefcase"></i>
                <span>Living Portfolio</span>
            </div>
            <div class="nav-item" onclick="showTab('analytics')">
                <i class="fas fa-brain"></i>
                <span>AI Analytics</span>
            </div>
            <div class="nav-item" onclick="showTab('leaderboard')">
                <i class="fas fa-trophy"></i>
                <span>Competitive Intelligence</span>
            </div>
            <div class="nav-item" onclick="showTab('collaboration')">
                <i class="fas fa-users"></i>
                <span>Collaboration Zone</span>
            </div>
            <div class="nav-item" onclick="showTab('reports')">
                <i class="fas fa-file-alt"></i>
                <span>Impact Reports</span>
            </div>
        </div>

        <!-- Content Area -->
        <div class="content-area">
            <!-- Overview Tab -->
            <div id="overview" class="tab-content active">
                <!-- Compliance Badges -->
                <div class="compliance-badges">
                    <span class="tag tag-sfdr">SFDR Article 9</span>
                    <span class="tag tag-csrd">CSRD Compliant</span>
                    <span class="tag tag-tcfd">TCFD Aligned</span>
                    <span class="tag tag-unesco">UNESCO Standards</span>
                    <span class="tag tag-gri">GRI Compliant</span>
                </div>

                <!-- Hero Impact Section -->
                <div class="hero-impact">
                    <div class="hero-content">
                        <div class="impact-number animated-number" id="heroImpactNumber">285,000</div>
                        <div class="impact-label">Lives Transformed Through Education</div>
                        <div class="mt-3">
                            <span style="font-size: 1.1rem; opacity: 0.9;">Your R2.4M Investment ‚Ä¢ 5.8x Impact ROI ‚Ä¢ 94% Literacy Improvement</span>
                        </div>
                    </div>
                </div>

                <!-- Visual Analytics Section -->
                <div class="row mb-4">
                    <div class="col-md-6">
                        <div class="chart-container">
                            <div class="chart-title">Students Reached by Region</div>
                            <canvas id="regionChart" aria-label="Bar chart showing students reached by region" role="img"></canvas>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="chart-container">
                            <div class="chart-title">Impact ROI Trends (3 Years)</div>
                            <canvas id="roiChart" aria-label="Line chart showing ROI trends over 3 years" role="img"></canvas>
                        </div>
                    </div>
                </div>

                <!-- Living Stories Grid -->
                <div class="story-grid">
                    <div class="story-card" onclick="playStoryAudio('nomsa')">
                        <div class="story-title org-placeholder">Gates Foundation Empowers Nomsa's Teaching Revolution in South Africa</div>
                        <div class="story-content">
                            From a rural classroom with 45 students and no electricity, Nomsa Mthembu transformed into a digital literacy champion. Through your education investment, she now trains 200+ teachers monthly using solar-powered tablets, reaching 12,000 students across KwaZulu-Natal.
                        </div>
                        <div class="story-metrics">
                            <div class="metric-item">
                                <div class="metric-value">12,000</div>
                                <div class="metric-label">Students Reached</div>
                            </div>
                            <div class="metric-item">
                                <div class="metric-value">200+</div>
                                <div class="metric-label">Teachers Trained</div>
                            </div>
                            <div class="metric-item">
                                <div class="metric-value">85%</div>
                                <div class="metric-label">Literacy Gain</div>
                            </div>
                        </div>
                        <div class="mt-2 text-center">
                            <i class="fas fa-play-circle" style="color: var(--terminal-blue);"></i>
                            <small>Click to hear Nomsa's story</small>
                        </div>
                    </div>

                    <div class="story-card" onclick="playStoryAudio('stem-sisters')">
                        <div class="story-title">STEM Sisters: Breaking Barriers in Nigerian Tech Education</div>
                        <div class="story-content">
                            In Lagos, 16-year-old Amina Yusuf leads a coding club of 150 girls. Your investment in gender-focused STEM education helped establish 25 similar clubs across Nigeria, with 89% of participants now pursuing tech careers‚Äîa 340% increase from 2021.
                        </div>
                        <div class="story-metrics">
                            <div class="metric-item">
                                <div class="metric-value">3,750</div>
                                <div class="metric-label">Girls in STEM</div>
                            </div>
                            <div class="metric-item">
                                <div class="metric-value">89%</div>
                                <div class="metric-label">Tech Career Rate</div>
                            </div>
                            <div class="metric-item">
                                <div class="metric-value">340%</div>
                                <div class="metric-label">Growth Rate</div>
                            </div>
                        </div>
                        <div class="mt-2 text-center">
                            <i class="fas fa-play-circle" style="color: var(--terminal-purple);"></i>
                            <small>Listen to Amina's journey</small>
                        </div>
                    </div>

                    <div class="story-card" onclick="playStoryAudio('climate-champions')">
                        <div class="story-title">Climate Champions: Kenya's Green Education Revolution</div>
                        <div class="story-content">
                            In Nairobi's Kibera slum, environmental science teacher James Kiprotich uses VR headsets to show students melting glaciers. His climate education program, funded through your ESG portfolio, now operates in 80 schools, training 15,000 young climate advocates.
                        </div>
                        <div class="story-metrics">
                            <div class="metric-item">
                                <div class="metric-value">15,000</div>
                                <div class="metric-label">Climate Advocates</div>
                            </div>
                            <div class="metric-item">
                                <div class="metric-value">80</div>
                                <div class="metric-label">Schools</div>
                            </div>
                            <div class="metric-item">
                                <div class="metric-value">92%</div>
                                <div class="metric-label">Engagement Rate</div>
                            </div>
                        </div>
                        <div class="mt-2 text-center">
                            <i class="fas fa-play-circle" style="color: var(--terminal-green);"></i>
                            <small>Experience the VR classroom</small>
                        </div>
                    </div>
                </div>

                <!-- Key Metrics Dashboard -->
                <div class="row">
                    <div class="col-md-3">
                        <div class="glass-card text-center">
                            <div class="metric-value animated-number" style="font-size: 2.5rem; color: var(--terminal-green);">5.8x</div>
                            <div class="metric-label">Impact ROI</div>
                            <small class="text-muted">vs 2.14x Financial ROI</small>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="glass-card text-center">
                            <div class="metric-value animated-number" style="font-size: 2.5rem; color: var(--terminal-blue);">94%</div>
                            <div class="metric-label">Literacy Improvement</div>
                            <small class="text-muted">Above UNESCO targets</small>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="glass-card text-center">
                            <div class="metric-value animated-number" style="font-size: 2.5rem; color: var(--terminal-purple);">87</div>
                            <div class="metric-label">ESG Score</div>
                            <small class="text-muted">Top 10% globally</small>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="glass-card text-center">
                            <div class="metric-value animated-number" style="font-size: 2.5rem; color: var(--terminal-gold);">12.5K</div>
                            <div class="metric-label">Teachers Trained</div>
                            <small class="text-muted">Multiplier effect: 285K students</small>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Portfolio Tab -->
            <div id="portfolio" class="tab-content">
                <h2 style="color: var(--terminal-blue);" class="mb-4">
                    <i class="fas fa-briefcase"></i> Living Education Portfolio
                </h2>

                <!-- Portfolio Health Indicators -->
                <div class="portfolio-health">
                    <div class="health-indicator healthy">
                        <div class="health-icon">üíö</div>
                        <div class="health-value">87%</div>
                        <div class="health-label">Portfolio Health</div>
                    </div>
                    <div class="health-indicator healthy">
                        <div class="health-icon">üìà</div>
                        <div class="health-value">+24%</div>
                        <div class="health-label">YoY Growth</div>
                    </div>
                    <div class="health-indicator warning">
                        <div class="health-icon">‚ö†Ô∏è</div>
                        <div class="health-value">3</div>
                        <div class="health-label">Risk Alerts</div>
                    </div>
                    <div class="health-indicator healthy">
                        <div class="health-icon">üéØ</div>
                        <div class="health-value">94%</div>
                        <div class="health-label">Target Achievement</div>
                    </div>
                </div>

                <!-- FIXED: Portfolio Performance Chart with proper container -->
                <div class="portfolio-chart-container">
                    <h5 class="text-success mb-3">Portfolio Performance vs Education Index</h5>
                    <div style="position: relative; width: 100%; height: 350px;">
                        <canvas id="portfolioChart" role="img" aria-label="Portfolio performance comparison chart"></canvas>
                    </div>
                </div>

                <!-- Investment Projections -->
                <div class="glass-card mt-4">
                    <h5 class="text-success mb-3">Investment Impact Projections</h5>
                    <div class="row">
                        <div class="col-md-8">
                            <div style="position: relative; width: 100%; height: 300px;">
                                <canvas id="projectionChart" role="img" aria-label="Investment impact projections chart"></canvas>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="glass-card">
                                <h6 class="text-warning mb-3">Key Projections</h6>
                                <ul class="list-unstyled">
                                    <li class="mb-2">
                                        <i class="fas fa-arrow-up text-success me-2"></i>
                                        <strong>450K students</strong> by 2025
                                    </li>
                                    <li class="mb-2">
                                        <i class="fas fa-chart-line text-warning me-2"></i>
                                        <strong>6.2x Impact ROI</strong> projected
                                    </li>
                                    <li class="mb-2">
                                        <i class="fas fa-globe text-info me-2"></i>
                                        <strong>8 countries</strong> expansion
                                    </li>
                                    <li class="mb-2">
                                        <i class="fas fa-graduation-cap text-purple me-2"></i>
                                        <strong>18K teachers</strong> trained
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Analytics Tab -->
            <div id="analytics" class="tab-content">
                <h2 style="color: var(--terminal-blue);" class="mb-4">
                    <i class="fas fa-brain"></i> AI-Powered Education Analytics
                </h2>

                <!-- Education Impact Chart -->
                <div class="chart-container">
                    <div class="chart-title">Education Impact Trends with AI Projections</div>
                    <canvas id="impactTrendsChart" role="img" aria-label="Education impact trends with AI projections"></canvas>
                </div>
            </div>

            <!-- Leaderboard Tab -->
            <div id="leaderboard" class="tab-content">
                <h2 style="color: var(--terminal-blue);" class="mb-4">
                    <i class="fas fa-trophy"></i> Education Impact Leaderboard
                </h2>
                <div class="glass-card">
                    <p class="text-center text-muted">Leaderboard features coming soon...</p>
                </div>
            </div>

            <!-- Collaboration Tab -->
            <div id="collaboration" class="tab-content">
                <h2 style="color: var(--terminal-blue);" class="mb-4">
                    <i class="fas fa-users"></i> Collaboration Zone
                </h2>
                <div class="glass-card">
                    <p class="text-center text-muted">Collaboration and partnership features coming soon...</p>
                </div>
            </div>

            <!-- Reports Tab -->
            <div id="reports" class="tab-content">
                <h2 style="color: var(--terminal-blue);" class="mb-4">
                    <i class="fas fa-file-alt"></i> Education Impact Intelligence Reports
                </h2>

                <div class="row">
                    <!-- Free Report -->
                    <div class="col-lg-6 mb-4">
                        <div class="report-card">
                            <div class="d-flex justify-content-between align-items-start mb-4">
                                <div style="font-size: 2.5rem;">üìö</div>
                                <span class="badge bg-success">Free</span>
                            </div>
                            <h3 class="report-title">Global Education Outlook</h3>
                            <p class="report-description">Comprehensive analysis of education trends, policy impacts, and investment opportunities across emerging markets</p>
                            <div class="mb-3">
                                <span class="tag tag-unesco">UNESCO</span>
                                <span class="tag tag-gri">GRI</span>
                            </div>
                            <button class="btn btn-primary" onclick="downloadFreeReport()">Download Report</button>
                        </div>
                    </div>

                    <!-- Premium Reports -->
                    <div class="col-lg-6 mb-4">
                        <div class="report-card" onclick="generateReport('impact_assessment')">
                            <div class="d-flex justify-content-between align-items-start mb-4">
                                <div style="font-size: 2.5rem;">üí°</div>
                                <span class="premium-badge">$149</span>
                            </div>
                            <h3 class="report-title">Impact Assessment Report</h3>
                            <p class="report-description">Detailed analysis of your education portfolio's social and economic impact with ROI calculations</p>
                            <div class="mb-3">
                                <span class="tag tag-sfdr">SFDR</span>
                                <span class="tag tag-tcfd">TCFD</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Premium Modal -->
    <div id="premiumModal" class="premium-modal">
        <div class="premium-modal-content">
            <div class="premium-lock-icon">üîí</div>
            <h3 style="color: var(--terminal-blue); margin-bottom: 1rem;">Premium Feature</h3>
            <p class="mb-3">Unlock detailed analytics and insights with our premium subscription.</p>
            <button class="btn btn-premium mb-2" onclick="subscribePremium()">
                Upgrade to Premium - $99/month
            </button>
            <br>
            <button class="btn btn-outline-secondary" onclick="closePremiumModal()">
                Maybe Later
            </button>
        </div>
    </div>

    <!-- Profile Completion Modal -->
    <div class="modal fade" id="profileModal" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Complete Your ESG Education Profile</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <p class="mb-4">Complete your profile to unlock personalized impact stories and customized reports.</p>
                    <form id="profileForm">
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label class="form-label">Organization Name *</label>
                                <input type="text" class="form-control" id="orgName" placeholder="e.g., Gates Foundation">
                            </div>
                            <div class="col-md-6 mb-3">
                                <label class="form-label">Organization Type *</label>
                                <select class="form-select" id="orgType">
                                    <option value="">Select type...</option>
                                    <option value="foundation">Foundation</option>
                                    <option value="fund">Impact Fund</option>
                                    <option value="ngo">NGO</option>
                                    <option value="government">Government Agency</option>
                                    <option value="corporate">Corporate</option>
                                </select>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Later</button>
                    <button type="button" class="btn btn-primary" onclick="saveProfile()">Save Profile</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- JavaScript -->
    <script>
        let fontSize = 16;
        let currentTab = 'overview';
        let charts = {};
        
        // Accessibility Functions
        function toggleHighContrast() {
            document.body.classList.toggle('high-contrast');
            localStorage.setItem('highContrast', document.body.classList.contains('high-contrast'));
        }
        
        function increaseFontSize() {
            fontSize += 2;
            document.body.style.fontSize = fontSize + 'px';
            localStorage.setItem('fontSize', fontSize);
        }
        
        function decreaseFontSize() {
            if (fontSize > 12) {
                fontSize -= 2;
                document.body.style.fontSize = fontSize + 'px';
                localStorage.setItem('fontSize', fontSize);
            }
        }

        // Tab Navigation
        function showTab(tabName) {
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            
            document.querySelectorAll('.nav-item').forEach(item => {
                item.classList.remove('active');
            });
            
            document.getElementById(tabName).classList.add('active');
            event.target.closest('.nav-item').classList.add('active');
            
            currentTab = tabName;
            
            // Trigger chart resize
            setTimeout(() => {
                Object.values(charts).forEach(chart => {
                    if (chart && typeof chart.resize === 'function') {
                        chart.resize();
                    }
                });
            }, 100);
        }

        // Profile Modal
        function showProfileModal() {
            const modal = new bootstrap.Modal(document.getElementById('profileModal'));
            modal.show();
        }

        function saveProfile() {
            const profileData = {
                orgName: document.getElementById('orgName').value,
                orgType: document.getElementById('orgType').value
            };
            
            localStorage.setItem('userProfile', JSON.stringify(profileData));
            bootstrap.Modal.getInstance(document.getElementById('profileModal')).hide();
            document.getElementById('profileCompletion').textContent = 'Profile: 100% Complete';
        }

        // Premium Modal
        function showPremiumModal(reportType) {
            document.getElementById('premiumModal').style.display = 'flex';
        }

        function closePremiumModal() {
            document.getElementById('premiumModal').style.display = 'none';
        }

        function subscribePremium() {
            closePremiumModal();
            alert('Premium subscription activated!');
        }

        // Story Audio
        function playStoryAudio(storyId) {
            console.log('Playing audio for story:', storyId);
        }

        // Report Generation
        function generateReport(reportType) {
            alert('Generating report: ' + reportType);
        }

        function downloadFreeReport() {
            alert('Downloading free report...');
        }

        function updateTimestamp() {
            const now = new Date();
            const timestamp = document.getElementById('timestamp');
            if (timestamp) {
                timestamp.innerHTML = `Last updated: ${now.toISOString().replace('T', ' ').substr(0, 19)} UTC <span class="live-indicator"></span>`;
            }
        }

        // FIXED: Chart initialization with proper responsive settings
        function initializeCharts() {
            const commonOptions = {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: {
                        labels: { 
                            color: '#ffffff',
                            font: { size: 12 }
                        }
                    }
                },
                scales: {
                    y: {
                        ticks: { 
                            color: '#ffffff',
                            font: { size: 12 }
                        },
                        grid: { 
                            color: 'rgba(255, 255, 255, 0.1)',
                            borderColor: 'rgba(255, 255, 255, 0.2)'
                        }
                    },
                    x: {
                        ticks: { 
                            color: '#ffffff',
                            font: { size: 12 }
                        },
                        grid: { 
                            color: 'rgba(255, 255, 255, 0.1)',
                            borderColor: 'rgba(255, 255, 255, 0.2)'
                        }
                    }
                }
            };

            // Region Chart
            const regionCtx = document.getElementById('regionChart');
            if (regionCtx) {
                charts.regionChart = new Chart(regionCtx, {
                    type: 'bar',
                    data: {
                        labels: ['South Africa', 'Nigeria', 'Kenya', 'Ghana', 'Other'],
                        datasets: [{
                            label: 'Students Reached (Thousands)',
                            data: [85, 67, 52, 41, 40],
                            backgroundColor: [
                                'rgba(0, 212, 255, 0.7)',
                                'rgba(139, 92, 246, 0.7)',
                                'rgba(0, 255, 136, 0.7)',
                                'rgba(255, 215, 0, 0.7)',
                                'rgba(255, 64, 0, 0.7)'
                            ],
                            borderColor: [
                                '#00d4ff',
                                '#8b5cf6',
                                '#00ff88',
                                '#ffd700',
                                '#ff4000'
                            ],
                            borderWidth: 2
                        }]
                    },
                    options: {
                        ...commonOptions,
                        plugins: {
                            legend: { display: false }
                        }
                    }
                });
            }

            // ROI Chart
            const roiCtx = document.getElementById('roiChart');
            if (roiCtx) {
                charts.roiChart = new Chart(roiCtx, {
                    type: 'line',
                    data: {
                        labels: ['2022', '2023', '2024', '2025 (Proj)', '2026 (Proj)'],
                        datasets: [{
                            label: 'Impact ROI',
                            data: [3.2, 4.1, 5.8, 6.8, 7.2],
                            borderColor: '#00ff88',
                            backgroundColor: 'rgba(0, 255, 136, 0.1)',
                            tension: 0.4,
                            fill: true
                        }, {
                            label: 'Financial ROI',
                            data: [1.8, 2.0, 2.14, 2.3, 2.5],
                            borderColor: '#00d4ff',
                            backgroundColor: 'rgba(0, 212, 255, 0.1)',
                            tension: 0.4,
                            fill: true
                        }]
                    },
                    options: commonOptions
                });
            }

            // FIXED: Portfolio Chart with proper container sizing
            const portfolioCtx = document.getElementById('portfolioChart');
            if (portfolioCtx) {
                charts.portfolioChart = new Chart(portfolioCtx, {
                    type: 'line',
                    data: {
                        labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct'],
                        datasets: [{
                            label: 'Portfolio Performance (%)',
                            data: [12.5, 14.2, 16.8, 18.1, 19.5, 21.2, 22.8, 24.1, 25.6, 26.9],
                            borderColor: '#00ff88',
                            backgroundColor: 'rgba(0, 255, 136, 0.1)',
                            tension: 0.4,
                            fill: true
                        }, {
                            label: 'Education Index',
                            data: [10.2, 11.5, 12.8, 14.1, 15.2, 16.8, 17.9, 18.5, 19.2, 20.1],
                            borderColor: '#00d4ff',
                            backgroundColor: 'rgba(0, 212, 255, 0.1)',
                            tension: 0.4,
                            fill: false
                        }]
                    },
                    options: {
                        ...commonOptions,
                        interaction: {
                            intersect: false,
                            mode: 'index'
                        }
                    }
                });
            }

            // Projection Chart
            const projectionCtx = document.getElementById('projectionChart');
            if (projectionCtx) {
                charts.projectionChart = new Chart(projectionCtx, {
                    type: 'bar',
                    data: {
                        labels: ['Current', '2025 Target', '2026 Projection'],
                        datasets: [{
                            label: 'Students Reached',
                            data: [285000, 450000, 620000],
                            backgroundColor: [
                                'rgba(0, 212, 255, 0.7)',
                                'rgba(139, 92, 246, 0.7)',
                                'rgba(0, 255, 136, 0.7)'
                            ],
                            borderColor: [
                                '#00d4ff',
                                '#8b5cf6',
                                '#00ff88'
                            ],
                            borderWidth: 2
                        }]
                    },
                    options: {
                        ...commonOptions,
                        plugins: {
                            legend: { display: false }
                        },
                        scales: {
                            ...commonOptions.scales,
                            y: {
                                ...commonOptions.scales.y,
                                beginAtZero: true,
                                ticks: {
                                    ...commonOptions.scales.y.ticks,
                                    callback: function(value) {
                                        return (value/1000) + 'K';
                                    }
                                }
                            }
                        }
                    }
                });
            }

            // Impact Trends Chart
            const trendsCtx = document.getElementById('impactTrendsChart');
            if (trendsCtx) {
                charts.impactTrendsChart = new Chart(trendsCtx, {
                    type: 'line',
                    data: {
                        labels: ['2020', '2021', '2022', '2023', '2024', '2025 (AI)', '2026 (AI)'],
                        datasets: [{
                            label: 'Students Reached (K)',
                            data: [120, 145, 180, 220, 285, 350, 420],
                            borderColor: '#00d4ff',
                            backgroundColor: 'rgba(0, 212, 255, 0.1)',
                            tension: 0.4,
                            fill: true
                        }, {
                            label: 'AI Projection',
                            data: [null, null, null, null, 285, 350, 420],
                            borderColor: '#8b5cf6',
                            borderDash: [5, 5],
                            tension: 0.4
                        }]
                    },
                    options: commonOptions
                });
            }
        }

        // Initialize everything when DOM is loaded
        document.addEventListener('DOMContentLoaded', function() {
            initializeCharts();
            updateTimestamp();
            setInterval(updateTimestamp, 30000);
            
            // Load saved profile
            const savedProfile = localStorage.getItem('userProfile');
            if (savedProfile) {
                document.getElementById('profileCompletion').textContent = 'Profile: 100% Complete';
            }
        });

        // Window resize handler for charts
        window.addEventListener('resize', function() {
            setTimeout(() => {
                Object.values(charts).forEach(chart => {
                    if (chart && typeof chart.resize === 'function') {
                        chart.resize();
                    }
                });
            }, 100);
        });
    </script>
    
    <!-- Enhanced Framework Integration -->
    <script src="esg_leaderboard_system.js"></script>
    <script src="esg_enhanced_framework.js"></script>
    <script src="ai_dashboard_administrator.js"></script>
</body>
</html>
