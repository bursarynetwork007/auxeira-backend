<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Auxeira ESG Education Impact Donor Dashboard</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns/dist/chartjs-adapter-date-fns.bundle.min.js"></script>
    <script src="https://js.paystack.co/v1/inline.js"></script>
    <style>
        :root {
            --terminal-dark: #0a0a0a;
            --terminal-darker: #050505;
            --terminal-blue: #00d4ff;
            --terminal-purple: #8b5cf6;
            --terminal-green: #00ff88;
            --terminal-gold: #ffd700;
            --terminal-white: #ffffff;
            --terminal-gray: #666666;
            --glass-bg: rgba(255, 255, 255, 0.05);
            --glass-border: rgba(255, 255, 255, 0.1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, var(--terminal-dark) 0%, var(--terminal-darker) 100%);
            color: var(--terminal-white);
            min-height: 100vh;
            overflow-x: hidden;
        }

        .terminal-header {
            background: var(--glass-bg);
            backdrop-filter: blur(20px);
            border-bottom: 1px solid var(--glass-border);
            padding: 1rem 2rem;
            position: sticky;
            top: 0;
            z-index: 1000;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            font-size: 1.8rem;
            font-weight: bold;
            background: linear-gradient(45deg, var(--terminal-blue), var(--terminal-purple));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .profile-completion {
            background: var(--glass-bg);
            border: 1px solid var(--glass-border);
            border-radius: 20px;
            padding: 0.5rem 1rem;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .profile-completion:hover {
            background: var(--terminal-blue);
            color: var(--terminal-dark);
        }

        .data-refresh {
            font-size: 0.8rem;
            opacity: 0.7;
            color: var(--terminal-green);
        }

        .main-container {
            display: flex;
            min-height: calc(100vh - 80px);
        }

        .sidebar {
            width: 280px;
            background: var(--glass-bg);
            backdrop-filter: blur(20px);
            border-right: 1px solid var(--glass-border);
            padding: 2rem 0;
            position: sticky;
            top: 80px;
            height: calc(100vh - 80px);
            overflow-y: auto;
        }

        .nav-item {
            padding: 1rem 2rem;
            cursor: pointer;
            transition: all 0.3s ease;
            border-left: 3px solid transparent;
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .nav-item:hover, .nav-item.active {
            background: var(--glass-bg);
            border-left-color: var(--terminal-blue);
            color: var(--terminal-blue);
        }

        .content-area {
            flex: 1;
            padding: 2rem;
            overflow-y: auto;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
            animation: fadeIn 0.5s ease-in-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .glass-card {
            background: var(--glass-bg);
            backdrop-filter: blur(20px);
            border: 1px solid var(--glass-border);
            border-radius: 16px;
            padding: 2rem;
            margin-bottom: 2rem;
            transition: all 0.3s ease;
        }

        .glass-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 40px rgba(0, 212, 255, 0.1);
        }

        .hero-impact {
            text-align: center;
            padding: 3rem 0;
            background: linear-gradient(135deg, var(--terminal-blue), var(--terminal-purple));
            border-radius: 20px;
            margin-bottom: 3rem;
            position: relative;
            overflow: hidden;
        }

        .hero-impact::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><defs><pattern id="grid" width="10" height="10" patternUnits="userSpaceOnUse"><path d="M 10 0 L 0 0 0 10" fill="none" stroke="rgba(255,255,255,0.1)" stroke-width="0.5"/></pattern></defs><rect width="100" height="100" fill="url(%23grid)"/></svg>');
            opacity: 0.3;
        }

        .hero-content {
            position: relative;
            z-index: 2;
        }

        .impact-number {
            font-size: 4rem;
            font-weight: bold;
            color: var(--terminal-white);
            text-shadow: 0 0 20px rgba(255, 255, 255, 0.5);
        }

        .impact-label {
            font-size: 1.2rem;
            opacity: 0.9;
            margin-top: 0.5rem;
        }

        .story-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 2rem;
            margin: 2rem 0;
        }

        .story-card {
            background: var(--glass-bg);
            border: 1px solid var(--glass-border);
            border-radius: 16px;
            padding: 2rem;
            transition: all 0.3s ease;
            cursor: pointer;
            position: relative;
            overflow: hidden;
        }

        .story-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 4px;
            height: 100%;
            background: linear-gradient(45deg, var(--terminal-blue), var(--terminal-purple));
        }

        .story-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 20px 40px rgba(139, 92, 246, 0.2);
        }

        .story-title {
            font-size: 1.3rem;
            font-weight: bold;
            margin-bottom: 1rem;
            color: var(--terminal-blue);
        }

        .story-content {
            line-height: 1.6;
            margin-bottom: 1.5rem;
        }

        .story-metrics {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding-top: 1rem;
            border-top: 1px solid var(--glass-border);
        }

        .metric-item {
            text-align: center;
        }

        .metric-value {
            font-size: 1.5rem;
            font-weight: bold;
            color: var(--terminal-green);
        }

        .metric-label {
            font-size: 0.9rem;
            opacity: 0.7;
        }

        .badge-icon {
            position: absolute;
            top: 1rem;
            right: 1rem;
            font-size: 1.5rem;
            opacity: 0.7;
        }

        .badge-leaf { color: var(--terminal-green); }
        .badge-rocket { color: var(--terminal-gold); }
        .badge-handshake { color: var(--terminal-purple); }

        .chart-container {
            background: var(--glass-bg);
            border-radius: 16px;
            padding: 2rem;
            margin: 2rem 0;
            position: relative;
        }

        .chart-title {
            font-size: 1.4rem;
            font-weight: bold;
            margin-bottom: 1.5rem;
            color: var(--terminal-blue);
            text-align: center;
        }

        .btn-primary {
            background: linear-gradient(45deg, var(--terminal-blue), var(--terminal-purple));
            border: none;
            border-radius: 25px;
            padding: 0.8rem 2rem;
            font-weight: bold;
            transition: all 0.3s ease;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(0, 212, 255, 0.3);
        }

        .btn-premium {
            background: linear-gradient(45deg, var(--terminal-gold), #ff6b35);
            border: none;
            border-radius: 25px;
            padding: 0.8rem 2rem;
            font-weight: bold;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .btn-premium::before {
            content: '👑';
            margin-right: 0.5rem;
        }

        .btn-premium:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(255, 215, 0, 0.3);
        }

        .premium-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(10px);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            border-radius: 16px;
            z-index: 10;
        }

        .premium-lock {
            font-size: 3rem;
            color: var(--terminal-gold);
            margin-bottom: 1rem;
        }

        .premium-text {
            text-align: center;
            margin-bottom: 2rem;
        }

        .opportunity-card {
            background: var(--glass-bg);
            border: 1px solid var(--glass-border);
            border-radius: 16px;
            padding: 1.5rem;
            margin-bottom: 1rem;
            transition: all 0.3s ease;
        }

        .opportunity-card:hover {
            transform: translateX(10px);
            border-color: var(--terminal-blue);
        }

        .opportunity-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }

        .opportunity-title {
            font-size: 1.2rem;
            font-weight: bold;
            color: var(--terminal-blue);
        }

        .compatibility-score {
            background: var(--terminal-green);
            color: var(--terminal-dark);
            padding: 0.3rem 0.8rem;
            border-radius: 20px;
            font-weight: bold;
            font-size: 0.9rem;
        }

        .opportunity-details {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 1rem;
            margin-bottom: 1rem;
        }

        .opportunity-metric {
            text-align: center;
        }

        .opportunity-metric-value {
            font-size: 1.1rem;
            font-weight: bold;
            color: var(--terminal-white);
        }

        .opportunity-metric-label {
            font-size: 0.8rem;
            opacity: 0.7;
        }

        .portfolio-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
            margin: 2rem 0;
        }

        .portfolio-item {
            background: var(--glass-bg);
            border: 1px solid var(--glass-border);
            border-radius: 16px;
            padding: 1.5rem;
            transition: all 0.3s ease;
        }

        .portfolio-item:hover {
            transform: scale(1.02);
            box-shadow: 0 15px 30px rgba(0, 212, 255, 0.1);
        }

        .portfolio-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }

        .company-name {
            font-size: 1.2rem;
            font-weight: bold;
            color: var(--terminal-blue);
        }

        .health-indicator {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: var(--terminal-green);
        }

        .health-indicator.warning {
            background: var(--terminal-gold);
        }

        .health-indicator.danger {
            background: #ff4757;
        }

        .portfolio-metrics {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 1rem;
            margin-bottom: 1rem;
        }

        .leaderboard-item {
            display: flex;
            align-items: center;
            padding: 1rem;
            background: var(--glass-bg);
            border: 1px solid var(--glass-border);
            border-radius: 12px;
            margin-bottom: 1rem;
            transition: all 0.3s ease;
        }

        .leaderboard-item:hover {
            background: rgba(0, 212, 255, 0.1);
        }

        .rank-number {
            font-size: 1.5rem;
            font-weight: bold;
            color: var(--terminal-gold);
            margin-right: 1rem;
            min-width: 40px;
        }

        .rank-change {
            margin-left: auto;
            font-size: 1.2rem;
        }

        .rank-up {
            color: var(--terminal-green);
        }

        .rank-down {
            color: #ff4757;
        }

        .rank-same {
            color: var(--terminal-gray);
        }

        .collaboration-card {
            background: var(--glass-bg);
            border: 1px solid var(--glass-border);
            border-radius: 16px;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            transition: all 0.3s ease;
        }

        .collaboration-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 30px rgba(139, 92, 246, 0.2);
        }

        .collab-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }

        .collab-title {
            font-size: 1.2rem;
            font-weight: bold;
            color: var(--terminal-purple);
        }

        .alignment-score {
            background: var(--terminal-purple);
            color: var(--terminal-white);
            padding: 0.3rem 0.8rem;
            border-radius: 20px;
            font-weight: bold;
            font-size: 0.9rem;
        }

        .report-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 2rem;
            margin: 2rem 0;
        }

        .report-card {
            background: var(--glass-bg);
            border: 1px solid var(--glass-border);
            border-radius: 16px;
            padding: 2rem;
            transition: all 0.3s ease;
            position: relative;
        }

        .report-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 40px rgba(0, 212, 255, 0.1);
        }

        .report-title {
            font-size: 1.3rem;
            font-weight: bold;
            color: var(--terminal-blue);
            margin-bottom: 1rem;
        }

        .report-description {
            line-height: 1.6;
            margin-bottom: 1.5rem;
            opacity: 0.9;
        }

        .report-price {
            font-size: 1.2rem;
            font-weight: bold;
            color: var(--terminal-gold);
            margin-bottom: 1rem;
        }

        .calendar-widget {
            background: var(--glass-bg);
            border: 1px solid var(--glass-border);
            border-radius: 16px;
            padding: 1.5rem;
            margin-bottom: 2rem;
        }

        .calendar-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }

        .calendar-title {
            font-size: 1.2rem;
            font-weight: bold;
            color: var(--terminal-purple);
        }

        .event-item {
            display: flex;
            align-items: center;
            padding: 0.8rem;
            margin-bottom: 0.5rem;
            background: rgba(139, 92, 246, 0.1);
            border-radius: 8px;
            border-left: 3px solid var(--terminal-purple);
        }

        .event-date {
            font-size: 0.8rem;
            color: var(--terminal-purple);
            margin-right: 1rem;
            min-width: 60px;
        }

        .event-title {
            font-weight: bold;
            flex: 1;
        }

        .network-insights {
            background: var(--glass-bg);
            border: 1px solid var(--glass-border);
            border-radius: 16px;
            padding: 1.5rem;
            margin-bottom: 2rem;
        }

        .insights-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }

        .insights-title {
            font-size: 1.2rem;
            font-weight: bold;
            color: var(--terminal-blue);
        }

        .insight-metric {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.8rem 0;
            border-bottom: 1px solid var(--glass-border);
        }

        .insight-metric:last-child {
            border-bottom: none;
        }

        .insight-label {
            font-weight: 500;
        }

        .insight-value {
            font-weight: bold;
            color: var(--terminal-green);
        }

        .modal {
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(10px);
        }

        .modal-content {
            background: var(--terminal-dark);
            border: 1px solid var(--glass-border);
            border-radius: 16px;
            color: var(--terminal-white);
        }

        .modal-header {
            border-bottom: 1px solid var(--glass-border);
        }

        .modal-footer {
            border-top: 1px solid var(--glass-border);
        }

        .form-control {
            background: var(--glass-bg);
            border: 1px solid var(--glass-border);
            color: var(--terminal-white);
            border-radius: 8px;
        }

        .form-control:focus {
            background: var(--glass-bg);
            border-color: var(--terminal-blue);
            color: var(--terminal-white);
            box-shadow: 0 0 0 0.2rem rgba(0, 212, 255, 0.25);
        }

        .form-select {
            background: var(--glass-bg);
            border: 1px solid var(--glass-border);
            color: var(--terminal-white);
        }

        .form-select:focus {
            background: var(--glass-bg);
            border-color: var(--terminal-blue);
            color: var(--terminal-white);
            box-shadow: 0 0 0 0.2rem rgba(0, 212, 255, 0.25);
        }

        .progress {
            background: var(--glass-bg);
            border-radius: 10px;
            height: 8px;
        }

        .progress-bar {
            background: linear-gradient(45deg, var(--terminal-blue), var(--terminal-purple));
            border-radius: 10px;
        }

        .time-toggle {
            display: flex;
            gap: 1rem;
            margin-bottom: 2rem;
            justify-content: center;
        }

        .time-toggle button {
            background: var(--glass-bg);
            border: 1px solid var(--glass-border);
            color: var(--terminal-white);
            padding: 0.5rem 1rem;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .time-toggle button.active {
            background: var(--terminal-blue);
            color: var(--terminal-dark);
        }

        .time-toggle button:hover {
            background: var(--terminal-blue);
            color: var(--terminal-dark);
        }

        /* AI Integration Styles */
        .ai-status {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: var(--glass-bg);
            backdrop-filter: blur(20px);
            border: 1px solid var(--glass-border);
            border-radius: 50px;
            padding: 0.5rem 1rem;
            font-size: 0.8rem;
            z-index: 1000;
        }

        .ai-status.active {
            color: var(--terminal-green);
        }

        .ai-status.processing {
            color: var(--terminal-gold);
        }

        .thunderbit-indicator {
            display: inline-block;
            width: 8px;
            height: 8px;
            background: var(--terminal-green);
            border-radius: 50%;
            margin-right: 0.5rem;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.5; }
            100% { opacity: 1; }
        }

        @media (max-width: 768px) {
            .main-container {
                flex-direction: column;
            }

            .sidebar {
                width: 100%;
                height: auto;
                position: static;
                order: 2;
            }

            .content-area {
                order: 1;
                padding: 1rem;
            }

            .terminal-header {
                padding: 1rem;
                flex-direction: column;
                gap: 1rem;
            }

            .user-info {
                width: 100%;
                justify-content: space-between;
            }

            .story-grid, .portfolio-grid, .report-grid {
                grid-template-columns: 1fr;
            }

            .impact-number {
                font-size: 2.5rem;
            }
        }

        /* High contrast mode for accessibility */
        @media (prefers-contrast: high) {
            :root {
                --glass-bg: rgba(255, 255, 255, 0.15);
                --glass-border: rgba(255, 255, 255, 0.3);
            }
        }

        /* Reduced motion for accessibility */
        @media (prefers-reduced-motion: reduce) {
            *, *::before, *::after {
                animation-duration: 0.01ms !important;
                animation-iteration-count: 1 !important;
                transition-duration: 0.01ms !important;
            }
        }
    </style>
</head>
<body>
    <!-- AI Status Indicator -->
    <div class="ai-status" id="aiStatus">
        <span class="thunderbit-indicator"></span>
        <span id="aiStatusText">AI Ready</span>
    </div>

    <!-- Terminal Header -->
    <div class="terminal-header">
        <div class="logo">
            <i class="fas fa-chart-line"></i> Auxeira ESG Education
        </div>
        <div class="user-info">
            <div class="profile-completion" onclick="showProfileModal()" aria-label="Profile completion status">
                <i class="fas fa-user-circle"></i>
                Profile: <span data-bind="profile_completion">65</span>% Complete
                <div class="progress mt-1">
                    <div class="progress-bar" style="width: 65%" aria-valuenow="65" aria-valuemin="0" aria-valuemax="100"></div>
                </div>
            </div>
            <div class="data-refresh">
                <i class="fas fa-sync-alt"></i>
                Data Refreshed: <span id="lastUpdate" data-bind="last_update">2 hours ago</span>
            </div>
            <div class="time-toggle" style="display: none;" id="timeToggle">
                <button class="active" onclick="toggleTimeRange(365)" aria-label="Show 365 day data">365 Days</button>
                <button onclick="toggleTimeRange(1825)" aria-label="Show 5 year data">5 Years</button>
            </div>
        </div>
    </div>

    <!-- Main Container -->
    <div class="main-container">
        <!-- Sidebar Navigation -->
        <div class="sidebar">
            <div class="nav-item active" onclick="showTab('overview')" aria-label="Overview dashboard">
                <i class="fas fa-tachometer-alt"></i>
                <span>Overview</span>
            </div>
            <div class="nav-item" onclick="showTab('opportunity-ripple')" aria-label="Opportunity ripple dashboard">
                <i class="fas fa-water"></i>
                <span>Opportunity Ripple</span>
            </div>
            <div class="nav-item" onclick="showTab('portfolio')" aria-label="Portfolio dashboard">
                <i class="fas fa-briefcase"></i>
                <span>Portfolio</span>
            </div>
            <div class="nav-item" onclick="showTab('leaderboard')" aria-label="Leaderboard dashboard">
                <i class="fas fa-trophy"></i>
                <span>Leaderboard</span>
            </div>
            <div class="nav-item" onclick="showTab('collaboration')" aria-label="Collaboration zone dashboard">
                <i class="fas fa-users"></i>
                <span>Collaboration Zone</span>
            </div>
            <div class="nav-item" onclick="showTab('reports')" aria-label="Reports dashboard">
                <i class="fas fa-file-alt"></i>
                <span>Reports</span>
            </div>
        </div>

        <!-- Content Area -->
        <div class="content-area">
            <!-- Overview Tab -->
            <div id="overview" class="tab-content active">
                <!-- Hero Impact Section -->
                <div class="hero-impact">
                    <div class="hero-content">
                        <div class="impact-number" data-bind="students_reached | number" aria-label="Total students reached">285,000</div>
                        <div class="impact-label">Lives Transformed Through Education</div>
                        <div class="mt-3">
                            <span style="font-size: 1.1rem; opacity: 0.9;">
                                Your <span data-bind="total_investment | currency">R2.4M</span> Investment • 
                                <span data-bind="lives_per_grant | number">5.8</span>x Lives-per-Grant • 
                                <span data-bind="literacy_improvement | percentage">94%</span> Literacy Improvement
                            </span>
                        </div>
                    </div>
                </div>

                <!-- Visual Analytics Section -->
                <div class="row mb-4">
                    <div class="col-md-6">
                        <div class="chart-container">
                            <div class="chart-title">Students Reached by Region</div>
                            <canvas id="regionChart" aria-label="Bar chart showing students reached by region"></canvas>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="chart-container">
                            <div class="chart-title">Lives-per-Grant Trends (3 Years)</div>
                            <canvas id="livesPerGrantChart" aria-label="Line chart showing lives-per-grant trends over 3 years"></canvas>
                        </div>
                    </div>
                </div>

                <!-- Overview Tab Reports -->
                <div class="row mb-4">
                    <div class="col-md-6">
                        <div class="glass-card">
                            <h4 style="color: var(--terminal-blue);">
                                <i class="fas fa-expand-arrows-alt"></i> Scalability & Impact Expansion Report
                            </h4>
                            <p>Comprehensive analysis of scaling opportunities and impact multiplication strategies.</p>
                            <button class="btn btn-premium" onclick="generateAIReport('scalability-report')">
                                Generate Report - $199
                            </button>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="glass-card">
                            <h4 style="color: var(--terminal-green);">
                                <i class="fas fa-leaf"></i> ESG Scorecard
                            </h4>
                            <p>Detailed environmental, social, and governance performance metrics and benchmarks.</p>
                            <button class="btn btn-premium" onclick="generateAIReport('esg-scorecard')">
                                View Scorecard - $149
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Impact Stories Grid -->
                <div class="story-grid">
                    <div class="story-card">
                        <div class="badge-icon badge-leaf">🌱</div>
                        <div class="story-title" data-bind="story_title_1">Nomsa's Teaching Revolution</div>
                        <div class="story-content" data-bind="story_content_1">
                            In rural KwaZulu-Natal, teacher Nomsa Mthembu transformed her classroom with digital literacy tools. 
                            Her innovative approach increased student engagement by 85% and became a model for 200+ schools across the province.
                        </div>
                        <div class="story-metrics">
                            <div class="metric-item">
                                <div class="metric-value" data-bind="story_1_students">1,200</div>
                                <div class="metric-label">Students Impacted</div>
                            </div>
                            <div class="metric-item">
                                <div class="metric-value" data-bind="story_1_improvement">85%</div>
                                <div class="metric-label">Engagement Boost</div>
                            </div>
                            <div class="metric-item">
                                <div class="metric-value" data-bind="story_1_schools">200+</div>
                                <div class="metric-label">Schools Replicated</div>
                            </div>
                        </div>
                    </div>

                    <div class="story-card">
                        <div class="badge-icon badge-rocket">🚀</div>
                        <div class="story-title" data-bind="story_title_2">STEM Sisters Breaking Barriers</div>
                        <div class="story-content" data-bind="story_content_2">
                            The STEM Sisters program in Lagos empowered 500 girls with coding and robotics skills. 
                            92% of participants now pursue STEM careers, breaking generational cycles of limited opportunities.
                        </div>
                        <div class="story-metrics">
                            <div class="metric-item">
                                <div class="metric-value" data-bind="story_2_girls">500</div>
                                <div class="metric-label">Girls Empowered</div>
                            </div>
                            <div class="metric-item">
                                <div class="metric-value" data-bind="story_2_stem">92%</div>
                                <div class="metric-label">STEM Careers</div>
                            </div>
                            <div class="metric-item">
                                <div class="metric-value" data-bind="story_2_income">3.2x</div>
                                <div class="metric-label">Income Increase</div>
                            </div>
                        </div>
                    </div>

                    <div class="story-card">
                        <div class="badge-icon badge-handshake">🤝</div>
                        <div class="story-title" data-bind="story_title_3">Community Learning Hubs</div>
                        <div class="story-content" data-bind="story_content_3">
                            Partnership with local communities created 50 learning hubs across Ghana. 
                            These spaces serve 15,000 learners daily, providing internet access and digital skills training.
                        </div>
                        <div class="story-metrics">
                            <div class="metric-item">
                                <div class="metric-value" data-bind="story_3_hubs">50</div>
                                <div class="metric-label">Learning Hubs</div>
                            </div>
                            <div class="metric-item">
                                <div class="metric-value" data-bind="story_3_learners">15,000</div>
                                <div class="metric-label">Daily Learners</div>
                            </div>
                            <div class="metric-item">
                                <div class="metric-value" data-bind="story_3_skills">78%</div>
                                <div class="metric-label">Skills Certified</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Impact Report Teaser -->
                <div class="glass-card">
                    <div class="d-flex justify-content-between align-items-center mb-3">
                        <h3 style="color: var(--terminal-blue);">
                            <i class="fas fa-heart"></i> Impact Report
                        </h3>
                        <span class="badge bg-warning text-dark">Premium Feature</span>
                    </div>
                    <div class="row">
                        <div class="col-md-8">
                            <p class="mb-3">Are you maximizing learning outcomes? Our Impact Report reveals untapped opportunities in your education portfolio, mapping clear actionable strategies for 2024.</p>
                            <div class="mb-3">
                                <strong>What's New:</strong> 
                                <ul class="mt-2">
                                    <li><span data-bind="new_partnerships">12</span> new partnership opportunities identified</li>
                                    <li><span data-bind="underperforming_programs">3</span> underperforming programs with <span data-bind="improvement_potential | percentage">40%</span> improvement potential</li>
                                    <li>Regional expansion into <span data-bind="expansion_region">Nigeria</span> showing <span data-bind="expansion_roi | percentage">200%</span> Lives-per-Grant potential</li>
                                </ul>
                            </div>
                            <div class="mb-3">
                                <strong>What's Next:</strong> Strategic recommendations for Q1 2024 based on UNESCO frameworks and real-time policy changes.
                            </div>
                        </div>
                        <div class="col-md-4 text-center">
                            <div style="filter: blur(3px); opacity: 0.7;">
                                <canvas id="previewChart" width="200" height="150" aria-label="Blurred preview chart"></canvas>
                            </div>
                            <button class="btn btn-premium mt-3" onclick="generateAIReport('impact-report')">
                                Unlock Full Report - $149
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Opportunity Ripple Tab -->
            <div id="opportunity-ripple" class="tab-content">
                <h2 class="mb-4" style="color: var(--terminal-blue);">
                    <i class="fas fa-water"></i> Opportunity Ripple
                </h2>

                <!-- Opportunity Ripple Tab Report -->
                <div class="glass-card mb-4">
                    <h4 style="color: var(--terminal-purple);">
                        <i class="fas fa-chart-bar"></i> Fund Benchmarking & Screening Report
                    </h4>
                    <p>Compare your impact donor performance against global education funds and identify top-performing opportunities.</p>
                    <button class="btn btn-premium" onclick="generateAIReport('fund-benchmarking')">
                        Generate Benchmarking Report - $299
                    </button>
                </div>

                <!-- Opportunity Cards -->
                <div class="opportunity-card">
                    <div class="opportunity-header">
                        <div class="opportunity-title" data-bind="opportunity_1_title">Digital Literacy Initiative - Kenya</div>
                        <div class="compatibility-score" data-bind="opportunity_1_score">94%</div>
                    </div>
                    <div class="opportunity-details">
                        <div class="opportunity-metric">
                            <div class="opportunity-metric-value" data-bind="opportunity_1_funding">$250K</div>
                            <div class="opportunity-metric-label">Funding Needed</div>
                        </div>
                        <div class="opportunity-metric">
                            <div class="opportunity-metric-value" data-bind="opportunity_1_reach">12,000</div>
                            <div class="opportunity-metric-label">Students Reached</div>
                        </div>
                        <div class="opportunity-metric">
                            <div class="opportunity-metric-value" data-bind="opportunity_1_lpg">6.2x</div>
                            <div class="opportunity-metric-label">Lives-per-Grant</div>
                        </div>
                        <div class="opportunity-metric">
                            <div class="opportunity-metric-value" data-bind="opportunity_1_timeline">18 months</div>
                            <div class="opportunity-metric-label">Timeline</div>
                        </div>
                    </div>
                    <p class="mt-3" data-bind="opportunity_1_description">
                        Expand digital literacy programs to rural schools in Kenya, focusing on teacher training and sustainable technology integration.
                    </p>
                    <button class="btn btn-primary mt-2" onclick="viewOpportunityDetails(1)">View Details</button>
                </div>

                <div class="opportunity-card">
                    <div class="opportunity-header">
                        <div class="opportunity-title" data-bind="opportunity_2_title">Girls' STEM Education - Nigeria</div>
                        <div class="compatibility-score" data-bind="opportunity_2_score">91%</div>
                    </div>
                    <div class="opportunity-details">
                        <div class="opportunity-metric">
                            <div class="opportunity-metric-value" data-bind="opportunity_2_funding">$180K</div>
                            <div class="opportunity-metric-label">Funding Needed</div>
                        </div>
                        <div class="opportunity-metric">
                            <div class="opportunity-metric-value" data-bind="opportunity_2_reach">8,500</div>
                            <div class="opportunity-metric-label">Girls Reached</div>
                        </div>
                        <div class="opportunity-metric">
                            <div class="opportunity-metric-value" data-bind="opportunity_2_lpg">7.1x</div>
                            <div class="opportunity-metric-label">Lives-per-Grant</div>
                        </div>
                        <div class="opportunity-metric">
                            <div class="opportunity-metric-value" data-bind="opportunity_2_timeline">24 months</div>
                            <div class="opportunity-metric-label">Timeline</div>
                        </div>
                    </div>
                    <p class="mt-3" data-bind="opportunity_2_description">
                        Comprehensive STEM education program targeting girls in secondary schools across Lagos and Abuja regions.
                    </p>
                    <button class="btn btn-primary mt-2" onclick="viewOpportunityDetails(2)">View Details</button>
                </div>

                <div class="opportunity-card">
                    <div class="opportunity-header">
                        <div class="opportunity-title" data-bind="opportunity_3_title">Teacher Training Hub - Ghana</div>
                        <div class="compatibility-score" data-bind="opportunity_3_score">88%</div>
                    </div>
                    <div class="opportunity-details">
                        <div class="opportunity-metric">
                            <div class="opportunity-metric-value" data-bind="opportunity_3_funding">$320K</div>
                            <div class="opportunity-metric-label">Funding Needed</div>
                        </div>
                        <div class="opportunity-metric">
                            <div class="opportunity-metric-value" data-bind="opportunity_3_reach">2,500</div>
                            <div class="opportunity-metric-label">Teachers Trained</div>
                        </div>
                        <div class="opportunity-metric">
                            <div class="opportunity-metric-value" data-bind="opportunity_3_lpg">5.8x</div>
                            <div class="opportunity-metric-label">Lives-per-Grant</div>
                        </div>
                        <div class="opportunity-metric">
                            <div class="opportunity-metric-value" data-bind="opportunity_3_timeline">36 months</div>
                            <div class="opportunity-metric-label">Timeline</div>
                        </div>
                    </div>
                    <p class="mt-3" data-bind="opportunity_3_description">
                        Establish regional teacher training centers focusing on modern pedagogy and technology integration.
                    </p>
                    <button class="btn btn-primary mt-2" onclick="viewOpportunityDetails(3)">View Details</button>
                </div>
            </div>

            <!-- Portfolio Tab -->
            <div id="portfolio" class="tab-content">
                <h2 class="mb-4" style="color: var(--terminal-blue);">
                    <i class="fas fa-briefcase"></i> Portfolio
                </h2>

                <!-- Portfolio Tab Report -->
                <div class="glass-card mb-4">
                    <h4 style="color: var(--terminal-green);">
                        <i class="fas fa-chart-line"></i> Lives-per-Grant & Metrics Dashboard Report
                    </h4>
                    <p>Comprehensive analysis of your portfolio performance with detailed Lives-per-Grant calculations and impact metrics.</p>
                    <button class="btn btn-premium" onclick="generateAIReport('lpg-metrics-dashboard')">
                        Generate Dashboard Report - $249
                    </button>
                </div>

                <!-- Portfolio Overview -->
                <div class="row mb-4">
                    <div class="col-md-3">
                        <div class="glass-card text-center">
                            <h3 style="color: var(--terminal-green);" data-bind="portfolio_total_investment | currency">R2.4M</h3>
                            <p>Total Investment</p>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="glass-card text-center">
                            <h3 style="color: var(--terminal-blue);" data-bind="portfolio_active_projects">12</h3>
                            <p>Active Projects</p>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="glass-card text-center">
                            <h3 style="color: var(--terminal-purple);" data-bind="portfolio_avg_lpg">5.8x</h3>
                            <p>Avg Lives-per-Grant</p>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="glass-card text-center">
                            <h3 style="color: var(--terminal-gold);" data-bind="portfolio_total_beneficiaries | number">285,000</h3>
                            <p>Total Beneficiaries</p>
                        </div>
                    </div>
                </div>

                <!-- Portfolio Items -->
                <div class="portfolio-grid">
                    <div class="portfolio-item">
                        <div class="portfolio-header">
                            <div class="company-name" data-bind="portfolio_1_name">EduTech Kenya</div>
                            <div class="health-indicator" data-bind="portfolio_1_health"></div>
                        </div>
                        <div class="portfolio-metrics">
                            <div class="metric-item">
                                <div class="metric-value" data-bind="portfolio_1_investment | currency">R400K</div>
                                <div class="metric-label">Investment</div>
                            </div>
                            <div class="metric-item">
                                <div class="metric-value" data-bind="portfolio_1_lpg">6.2x</div>
                                <div class="metric-label">Lives-per-Grant</div>
                            </div>
                            <div class="metric-item">
                                <div class="metric-value" data-bind="portfolio_1_students | number">45,000</div>
                                <div class="metric-label">Students</div>
                            </div>
                            <div class="metric-item">
                                <div class="metric-value" data-bind="portfolio_1_progress">78%</div>
                                <div class="metric-label">Progress</div>
                            </div>
                        </div>
                        <div class="progress mt-2">
                            <div class="progress-bar" style="width: 78%"></div>
                        </div>
                    </div>

                    <div class="portfolio-item">
                        <div class="portfolio-header">
                            <div class="company-name" data-bind="portfolio_2_name">STEM Sisters Nigeria</div>
                            <div class="health-indicator" data-bind="portfolio_2_health"></div>
                        </div>
                        <div class="portfolio-metrics">
                            <div class="metric-item">
                                <div class="metric-value" data-bind="portfolio_2_investment | currency">R350K</div>
                                <div class="metric-label">Investment</div>
                            </div>
                            <div class="metric-item">
                                <div class="metric-value" data-bind="portfolio_2_lpg">7.1x</div>
                                <div class="metric-label">Lives-per-Grant</div>
                            </div>
                            <div class="metric-item">
                                <div class="metric-value" data-bind="portfolio_2_students | number">28,500</div>
                                <div class="metric-label">Girls</div>
                            </div>
                            <div class="metric-item">
                                <div class="metric-value" data-bind="portfolio_2_progress">92%</div>
                                <div class="metric-label">Progress</div>
                            </div>
                        </div>
                        <div class="progress mt-2">
                            <div class="progress-bar" style="width: 92%"></div>
                        </div>
                    </div>

                    <div class="portfolio-item">
                        <div class="portfolio-header">
                            <div class="company-name" data-bind="portfolio_3_name">Ghana Learning Hubs</div>
                            <div class="health-indicator warning" data-bind="portfolio_3_health"></div>
                        </div>
                        <div class="portfolio-metrics">
                            <div class="metric-item">
                                <div class="metric-value" data-bind="portfolio_3_investment | currency">R280K</div>
                                <div class="metric-label">Investment</div>
                            </div>
                            <div class="metric-item">
                                <div class="metric-value" data-bind="portfolio_3_lpg">4.9x</div>
                                <div class="metric-label">Lives-per-Grant</div>
                            </div>
                            <div class="metric-item">
                                <div class="metric-value" data-bind="portfolio_3_students | number">32,000</div>
                                <div class="metric-label">Learners</div>
                            </div>
                            <div class="metric-item">
                                <div class="metric-value" data-bind="portfolio_3_progress">65%</div>
                                <div class="metric-label">Progress</div>
                            </div>
                        </div>
                        <div class="progress mt-2">
                            <div class="progress-bar" style="width: 65%"></div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Leaderboard Tab -->
            <div id="leaderboard" class="tab-content">
                <h2 class="mb-4" style="color: var(--terminal-blue);">
                    <i class="fas fa-trophy"></i> Leaderboard
                </h2>

                <!-- Leaderboard Tab Report -->
                <div class="glass-card mb-4">
                    <h4 style="color: var(--terminal-gold);">
                        <i class="fas fa-medal"></i> Fund Benchmarking & Screening Report
                    </h4>
                    <p>Detailed benchmarking analysis comparing your performance against top education impact donors globally.</p>
                    <button class="btn btn-premium" onclick="generateAIReport('leaderboard-benchmarking')">
                        Generate Benchmarking Report - $349
                    </button>
                </div>

                <!-- Your Ranking -->
                <div class="glass-card mb-4">
                    <h3 style="color: var(--terminal-gold);">Your Ranking</h3>
                    <div class="row">
                        <div class="col-md-4 text-center">
                            <h2 style="color: var(--terminal-gold);" data-bind="your_rank">#7</h2>
                            <p>Global Rank</p>
                        </div>
                        <div class="col-md-4 text-center">
                            <h2 style="color: var(--terminal-green);" data-bind="your_lpg_score">5.8x</h2>
                            <p>Lives-per-Grant</p>
                        </div>
                        <div class="col-md-4 text-center">
                            <h2 style="color: var(--terminal-blue);" data-bind="your_impact_score">94.2</h2>
                            <p>Impact Score</p>
                        </div>
                    </div>
                </div>

                <!-- Top Performers -->
                <div class="leaderboard-item">
                    <div class="rank-number">1</div>
                    <div>
                        <div style="font-weight: bold;" data-bind="rank_1_name">Gates Foundation Education</div>
                        <div style="font-size: 0.9rem; opacity: 0.7;" data-bind="rank_1_focus">Global Education Access</div>
                    </div>
                    <div style="margin-left: auto; margin-right: 1rem;">
                        <div style="font-weight: bold; color: var(--terminal-green);" data-bind="rank_1_lpg">8.4x</div>
                        <div style="font-size: 0.8rem; opacity: 0.7;">Lives-per-Grant</div>
                    </div>
                    <div class="rank-change rank-same">
                        <i class="fas fa-minus"></i>
                    </div>
                </div>

                <div class="leaderboard-item">
                    <div class="rank-number">2</div>
                    <div>
                        <div style="font-weight: bold;" data-bind="rank_2_name">Mastercard Foundation</div>
                        <div style="font-size: 0.9rem; opacity: 0.7;" data-bind="rank_2_focus">African Youth Education</div>
                    </div>
                    <div style="margin-left: auto; margin-right: 1rem;">
                        <div style="font-weight: bold; color: var(--terminal-green);" data-bind="rank_2_lpg">7.9x</div>
                        <div style="font-size: 0.8rem; opacity: 0.7;">Lives-per-Grant</div>
                    </div>
                    <div class="rank-change rank-up">
                        <i class="fas fa-arrow-up"></i>
                    </div>
                </div>

                <div class="leaderboard-item">
                    <div class="rank-number">3</div>
                    <div>
                        <div style="font-weight: bold;" data-bind="rank_3_name">Dubai Cares</div>
                        <div style="font-size: 0.9rem; opacity: 0.7;" data-bind="rank_3_focus">MENA Education</div>
                    </div>
                    <div style="margin-left: auto; margin-right: 1rem;">
                        <div style="font-weight: bold; color: var(--terminal-green);" data-bind="rank_3_lpg">7.2x</div>
                        <div style="font-size: 0.8rem; opacity: 0.7;">Lives-per-Grant</div>
                    </div>
                    <div class="rank-change rank-down">
                        <i class="fas fa-arrow-down"></i>
                    </div>
                </div>

                <div class="leaderboard-item" style="background: rgba(0, 212, 255, 0.1); border-color: var(--terminal-blue);">
                    <div class="rank-number">7</div>
                    <div>
                        <div style="font-weight: bold; color: var(--terminal-blue);">Your Organization</div>
                        <div style="font-size: 0.9rem; opacity: 0.7;">African Education Focus</div>
                    </div>
                    <div style="margin-left: auto; margin-right: 1rem;">
                        <div style="font-weight: bold; color: var(--terminal-green);">5.8x</div>
                        <div style="font-size: 0.8rem; opacity: 0.7;">Lives-per-Grant</div>
                    </div>
                    <div class="rank-change rank-up">
                        <i class="fas fa-arrow-up"></i>
                    </div>
                </div>
            </div>

            <!-- Collaboration Zone Tab -->
            <div id="collaboration" class="tab-content">
                <h2 class="mb-4" style="color: var(--terminal-blue);">
                    <i class="fas fa-users"></i> Collaboration Zone
                </h2>

                <!-- Collaboration Zone Reports -->
                <div class="row mb-4">
                    <div class="col-md-6">
                        <div class="glass-card">
                            <h4 style="color: var(--terminal-purple);">
                                <i class="fas fa-handshake"></i> Stakeholder Engagement Report
                            </h4>
                            <p>Comprehensive analysis of stakeholder relationships and engagement effectiveness.</p>
                            <button class="btn btn-premium" onclick="generateAIReport('stakeholder-engagement')">
                                Generate Report - $199
                            </button>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="glass-card">
                            <h4 style="color: var(--terminal-blue);">
                                <i class="fas fa-network-wired"></i> Cross-Sector Collaboration Report
                            </h4>
                            <p>Identify and analyze cross-sector partnership opportunities for maximum impact.</p>
                            <button class="btn btn-premium" onclick="generateAIReport('cross-sector-collaboration')">
                                Generate Report - $249
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Upcoming Events Calendar -->
                <div class="calendar-widget">
                    <div class="calendar-header">
                        <div class="calendar-title">
                            <i class="fas fa-calendar-alt"></i> Upcoming Events
                        </div>
                        <button class="btn btn-primary btn-sm" onclick="viewFullCalendar()">View All</button>
                    </div>
                    <div class="event-item">
                        <div class="event-date" data-bind="event_1_date">Dec 15</div>
                        <div class="event-title" data-bind="event_1_title">UNESCO Education Summit</div>
                        <div style="margin-left: auto;">
                            <span class="badge bg-primary" data-bind="event_1_type">Conference</span>
                        </div>
                    </div>
                    <div class="event-item">
                        <div class="event-date" data-bind="event_2_date">Dec 18</div>
                        <div class="event-title" data-bind="event_2_title">African EdTech Roundtable</div>
                        <div style="margin-left: auto;">
                            <span class="badge bg-success" data-bind="event_2_type">Networking</span>
                        </div>
                    </div>
                    <div class="event-item">
                        <div class="event-date" data-bind="event_3_date">Dec 22</div>
                        <div class="event-title" data-bind="event_3_title">Impact Measurement Workshop</div>
                        <div style="margin-left: auto;">
                            <span class="badge bg-warning text-dark" data-bind="event_3_type">Workshop</span>
                        </div>
                    </div>
                </div>

                <!-- Network Insights -->
                <div class="network-insights">
                    <div class="insights-header">
                        <div class="insights-title">
                            <i class="fas fa-network-wired"></i> Network Insights
                        </div>
                        <button class="btn btn-primary btn-sm" onclick="viewNetworkAnalysis()">Deep Dive</button>
                    </div>
                    <div class="insight-metric">
                        <div class="insight-label">Active Connections</div>
                        <div class="insight-value" data-bind="network_connections">156</div>
                    </div>
                    <div class="insight-metric">
                        <div class="insight-label">Partnership Opportunities</div>
                        <div class="insight-value" data-bind="network_opportunities">23</div>
                    </div>
                    <div class="insight-metric">
                        <div class="insight-label">Collaboration Score</div>
                        <div class="insight-value" data-bind="network_score">8.4/10</div>
                    </div>
                    <div class="insight-metric">
                        <div class="insight-label">Network Growth (30d)</div>
                        <div class="insight-value" data-bind="network_growth">+12%</div>
                    </div>
                </div>

                <!-- Partnership Opportunities -->
                <div class="collaboration-card">
                    <div class="collab-header">
                        <div class="collab-title" data-bind="collab_1_title">UNICEF Education Partnership</div>
                        <div class="alignment-score" data-bind="collab_1_score">96%</div>
                    </div>
                    <p data-bind="collab_1_description">
                        Joint initiative to scale digital literacy programs across Sub-Saharan Africa. 
                        Potential to reach 500,000+ students with combined resources.
                    </p>
                    <div class="mt-3">
                        <span class="badge bg-success me-2">Education</span>
                        <span class="badge bg-primary me-2">Digital Literacy</span>
                        <span class="badge bg-warning text-dark">Africa</span>
                    </div>
                    <button class="btn btn-primary mt-3" onclick="viewCollaborationDetails(1)">Explore Partnership</button>
                </div>

                <div class="collaboration-card">
                    <div class="collab-header">
                        <div class="collab-title" data-bind="collab_2_title">Google.org EdTech Initiative</div>
                        <div class="alignment-score" data-bind="collab_2_score">89%</div>
                    </div>
                    <p data-bind="collab_2_description">
                        Technology partnership to provide AI-powered learning tools to underserved communities. 
                        Focus on personalized learning and teacher support systems.
                    </p>
                    <div class="mt-3">
                        <span class="badge bg-success me-2">Technology</span>
                        <span class="badge bg-primary me-2">AI Learning</span>
                        <span class="badge bg-warning text-dark">Global</span>
                    </div>
                    <button class="btn btn-primary mt-3" onclick="viewCollaborationDetails(2)">Explore Partnership</button>
                </div>
            </div>

            <!-- Reports Tab -->
            <div id="reports" class="tab-content">
                <h2 class="mb-4" style="color: var(--terminal-blue);">
                    <i class="fas fa-file-alt"></i> Reports
                </h2>

                <!-- Reports Grid -->
                <div class="report-grid">
                    <div class="report-card">
                        <div class="report-title">Executive Summary</div>
                        <div class="report-description">
                            Comprehensive overview of your education impact portfolio with key metrics and strategic insights.
                        </div>
                        <div class="report-price">Free</div>
                        <button class="btn btn-primary" onclick="generateAIReport('executive-summary')">Generate Report</button>
                    </div>

                    <div class="report-card">
                        <div class="report-title">Scalability & Impact Expansion Report</div>
                        <div class="report-description">
                            Analysis of scaling opportunities and impact multiplication strategies for your education initiatives.
                        </div>
                        <div class="report-price">$199</div>
                        <button class="btn btn-premium" onclick="generateAIReport('scalability-report')">Generate Report</button>
                    </div>

                    <div class="report-card">
                        <div class="report-title">ESG Scorecard</div>
                        <div class="report-description">
                            Detailed environmental, social, and governance performance metrics with industry benchmarks.
                        </div>
                        <div class="report-price">$149</div>
                        <button class="btn btn-premium" onclick="generateAIReport('esg-scorecard')">Generate Report</button>
                    </div>

                    <div class="report-card">
                        <div class="report-title">Learning Outcomes Analysis</div>
                        <div class="report-description">
                            Deep dive into learning outcomes data with predictive analytics and improvement recommendations.
                        </div>
                        <div class="report-price">$249</div>
                        <button class="btn btn-premium" onclick="generateAIReport('learning-outcomes')">Generate Report</button>
                    </div>

                    <div class="report-card">
                        <div class="report-title">Teacher Training Impact</div>
                        <div class="report-description">
                            Comprehensive assessment of teacher training programs and their impact on student outcomes.
                        </div>
                        <div class="report-price">$199</div>
                        <button class="btn btn-premium" onclick="generateAIReport('teacher-training')">Generate Report</button>
                    </div>

                    <div class="report-card">
                        <div class="report-title">Gender Equity & Diversity Report</div>
                        <div class="report-description">
                            Analysis of gender equity initiatives and diversity outcomes in your education portfolio.
                        </div>
                        <div class="report-price">$179</div>
                        <button class="btn btn-premium" onclick="generateAIReport('gender-equity')">Generate Report</button>
                    </div>

                    <div class="report-card">
                        <div class="report-title">Compliance Report</div>
                        <div class="report-description">
                            Regulatory compliance assessment with UNESCO, local education ministry requirements.
                        </div>
                        <div class="report-price">$299</div>
                        <button class="btn btn-premium" onclick="generateAIReport('compliance-report')">Generate Report</button>
                    </div>

                    <div class="report-card">
                        <div class="report-title">Digital Divide Analysis</div>
                        <div class="report-description">
                            Assessment of digital access gaps and strategies to bridge the digital divide in education.
                        </div>
                        <div class="report-price">$229</div>
                        <button class="btn btn-premium" onclick="generateAIReport('digital-divide')">Generate Report</button>
                    </div>

                    <div class="report-card">
                        <div class="report-title">Cost Effectiveness Study</div>
                        <div class="report-description">
                            Detailed cost-benefit analysis of education interventions with Lives-per-Grant optimization.
                        </div>
                        <div class="report-price">$349</div>
                        <button class="btn btn-premium" onclick="generateAIReport('cost-effectiveness')">Generate Report</button>
                    </div>

                    <div class="report-card">
                        <div class="report-title">Policy Influence Report</div>
                        <div class="report-description">
                            Analysis of policy landscape and recommendations for advocacy and influence strategies.
                        </div>
                        <div class="report-price">$399</div>
                        <button class="btn btn-premium" onclick="generateAIReport('policy-influence')">Generate Report</button>
                    </div>

                    <div class="report-card">
                        <div class="report-title">Sustainability Assessment</div>
                        <div class="report-description">
                            Long-term sustainability analysis of education programs with environmental impact assessment.
                        </div>
                        <div class="report-price">$279</div>
                        <button class="btn btn-premium" onclick="generateAIReport('sustainability-assessment')">Generate Report</button>
                    </div>

                    <div class="report-card">
                        <div class="report-title">Carbon & Decarbonization Report</div>
                        <div class="report-description">
                            Carbon footprint analysis of education infrastructure with decarbonization strategies.
                        </div>
                        <div class="report-price">$199</div>
                        <button class="btn btn-premium" onclick="generateAIReport('carbon-report')">Generate Report</button>
                    </div>

                    <div class="report-card">
                        <div class="report-title">Materiality Assessment Report</div>
                        <div class="report-description">
                            ESG materiality assessment identifying key sustainability issues and stakeholder priorities.
                        </div>
                        <div class="report-price">$329</div>
                        <button class="btn btn-premium" onclick="generateAIReport('materiality-assessment')">Generate Report</button>
                    </div>

                    <div class="report-card">
                        <div class="report-title">Lives-per-Grant & Metrics Dashboard Report</div>
                        <div class="report-description">
                            Comprehensive Lives-per-Grant analysis with detailed metrics and performance benchmarks.
                        </div>
                        <div class="report-price">$249</div>
                        <button class="btn btn-premium" onclick="generateAIReport('lpg-metrics')">Generate Report</button>
                    </div>

                    <div class="report-card">
                        <div class="report-title">Fund Benchmarking & Screening Report</div>
                        <div class="report-description">
                            Comparative analysis against global education funds with screening and due diligence insights.
                        </div>
                        <div class="report-price">$299</div>
                        <button class="btn btn-premium" onclick="generateAIReport('fund-benchmarking')">Generate Report</button>
                    </div>

                    <div class="report-card">
                        <div class="report-title">Stakeholder Engagement Report</div>
                        <div class="report-description">
                            Analysis of stakeholder relationships and engagement effectiveness with improvement strategies.
                        </div>
                        <div class="report-price">$199</div>
                        <button class="btn btn-premium" onclick="generateAIReport('stakeholder-engagement')">Generate Report</button>
                    </div>

                    <div class="report-card">
                        <div class="report-title">Cross-Sector Collaboration Report</div>
                        <div class="report-description">
                            Identification and analysis of cross-sector partnership opportunities for amplified impact.
                        </div>
                        <div class="report-price">$249</div>
                        <button class="btn btn-premium" onclick="generateAIReport('cross-sector-collaboration')">Generate Report</button>
                    </div>

                    <div class="report-card">
                        <div class="report-title">Risk-Adjusted Lives-per-Grant Report</div>
                        <div class="report-description">
                            Advanced risk-adjusted analysis of Lives-per-Grant with scenario modeling and mitigation strategies.
                        </div>
                        <div class="report-price">$399</div>
                        <button class="btn btn-premium" onclick="generateAIReport('risk-adjusted-lpg')">Generate Report</button>
                    </div>

                    <div class="report-card">
                        <div class="report-title">Impact Measurement Framework Report</div>
                        <div class="report-description">
                            Comprehensive framework for measuring and tracking education impact with standardized metrics.
                        </div>
                        <div class="report-price">$349</div>
                        <button class="btn btn-premium" onclick="generateAIReport('impact-framework')">Generate Report</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Profile Completion Modal -->
    <div class="modal fade" id="profileModal" tabindex="-1" aria-labelledby="profileModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="profileModalLabel">Complete Your Profile</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="mb-3">
                        <div class="progress mb-3">
                            <div class="progress-bar" style="width: 65%" aria-valuenow="65" aria-valuemin="0" aria-valuemax="100">65% Complete</div>
                        </div>
                    </div>
                    
                    <form id="profileForm">
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="orgName" class="form-label">Organization Name</label>
                                <input type="text" class="form-control" id="orgName" placeholder="e.g., FutureLearn Impact Fund">
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="website" class="form-label">Website/Domain</label>
                                <input type="url" class="form-control" id="website" placeholder="e.g., futurelearnimpact.org">
                            </div>
                        </div>
                        
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="sectorType" class="form-label">Sector Type</label>
                                <select class="form-select" id="sectorType">
                                    <option value="">Select sector type</option>
                                    <option value="ngo">NGO</option>
                                    <option value="foundation">Foundation</option>
                                    <option value="impact-fund">Impact Fund</option>
                                    <option value="policy-unit">Policy Unit</option>
                                    <option value="csr-division">CSR Division</option>
                                </select>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="region" class="form-label">Country/Region</label>
                                <input type="text" class="form-control" id="region" placeholder="e.g., Kenya, India, Global">
                            </div>
                        </div>
                        
                        <div class="mb-3">
                            <label for="focusAreas" class="form-label">Focus Areas in Education (1-3 priorities)</label>
                            <input type="text" class="form-control" id="focusAreas" placeholder="e.g., Teacher training, digital literacy, rural schools">
                        </div>
                        
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="sdgAlignment" class="form-label">SDG Alignment</label>
                                <input type="text" class="form-control" id="sdgAlignment" placeholder="e.g., SDG4, SDG5">
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="annualSpend" class="form-label">Annual Education Spend</label>
                                <input type="text" class="form-control" id="annualSpend" placeholder="e.g., $4.5M">
                            </div>
                        </div>
                        
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="grantSize" class="form-label">Avg. Grant/Ticket Size</label>
                                <input type="text" class="form-control" id="grantSize" placeholder="e.g., $250k">
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="partners" class="form-label">Project Partners</label>
                                <input type="text" class="form-control" id="partners" placeholder="e.g., UNICEF, Room to Read">
                            </div>
                        </div>
                        
                        <div class="mb-3">
                            <label for="kpis" class="form-label">KPIs of Interest</label>
                            <input type="text" class="form-control" id="kpis" placeholder="e.g., Students reached, teacher capacity, literacy gains">
                        </div>
                        
                        <div class="mb-3">
                            <label for="impactGoals" class="form-label">Goal Statement</label>
                            <textarea class="form-control" id="impactGoals" rows="3" placeholder="e.g., Maximize measurable literacy outcomes for girls under 12"></textarea>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Save Later</button>
                    <button type="button" class="btn btn-primary" onclick="saveProfile()">Save Profile</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Premium Report Modal -->
    <div class="modal fade" id="premiumModal" tabindex="-1" aria-labelledby="premiumModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="premiumModalLabel">Premium Report</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="text-center mb-4">
                        <i class="fas fa-crown" style="font-size: 3rem; color: var(--terminal-gold);"></i>
                        <h4 class="mt-3" id="reportTitle">Premium Report</h4>
                        <p id="reportDescription">This premium report provides detailed insights and analysis.</p>
                        <h3 style="color: var(--terminal-gold);" id="reportPrice">$199</h3>
                    </div>
                    <div class="d-grid">
                        <button class="btn btn-premium btn-lg" onclick="processPayment()">
                            <i class="fas fa-credit-card me-2"></i>
                            Purchase Report
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

    <script>
        // Global Configuration
        const CONFIG = {
            API_BASE_URL: '/api/v1',
            NANO_GPT5_ENDPOINT: '/ai/nano-gpt5',
            THUNDERBIT_ENDPOINT: '/crawler/thunderbit',
            PAYSTACK_PUBLIC_KEY: 'pk_test_your_paystack_public_key', // Replace with actual key
            DEFAULT_TIME_RANGE: 365,
            PROFILE_FIELDS: [
                'org_name', 'website', 'sector_type', 'region', 'focus_areas',
                'sdg_alignment', 'annual_spend', 'grant_size', 'partners',
                'kpis', 'impact_goals'
            ]
        };

        // Global State
        let currentTimeRange = CONFIG.DEFAULT_TIME_RANGE;
        let profileData = {};
        let dashboardData = {};

        // Initialize Dashboard
        document.addEventListener('DOMContentLoaded', function() {
            initializeDashboard();
            loadProfileData();
            fetchDashboardData();
            initializeCharts();
            updateAIStatus('ready');
        });

        // Dashboard Initialization
        function initializeDashboard() {
            // Set up event listeners
            setupEventListeners();
            
            // Initialize data refresh
            setInterval(refreshData, 300000); // Refresh every 5 minutes
            
            // Show time toggle if user has premium access
            checkPremiumAccess();
        }

        function setupEventListeners() {
            // Tab navigation
            document.querySelectorAll('.nav-item').forEach(item => {
                item.addEventListener('click', function() {
                    const tabId = this.getAttribute('onclick').match(/'([^']+)'/)[1];
                    showTab(tabId);
                });
            });

            // Profile completion tracking
            document.getElementById('profileForm')?.addEventListener('input', updateProfileProgress);
        }

        // Tab Management
        function showTab(tabId) {
            // Hide all tabs
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Remove active class from nav items
            document.querySelectorAll('.nav-item').forEach(item => {
                item.classList.remove('active');
            });
            
            // Show selected tab
            document.getElementById(tabId).classList.add('active');
            
            // Add active class to clicked nav item
            event.target.closest('.nav-item').classList.add('active');
            
            // Load tab-specific data
            loadTabData(tabId);
        }

        function loadTabData(tabId) {
            switch(tabId) {
                case 'overview':
                    loadOverviewData();
                    break;
                case 'opportunity-ripple':
                    loadOpportunityData();
                    break;
                case 'portfolio':
                    loadPortfolioData();
                    break;
                case 'leaderboard':
                    loadLeaderboardData();
                    break;
                case 'collaboration':
                    loadCollaborationData();
                    break;
                case 'reports':
                    loadReportsData();
                    break;
            }
        }

        // Data Management
        async function fetchDashboardData() {
            try {
                updateAIStatus('processing', 'Fetching latest data...');
                
                const response = await fetch(`${CONFIG.API_BASE_URL}/dashboard-data?days=${currentTimeRange}`, {
                    headers: {
                        'Authorization': `Bearer ${getAuthToken()}`,
                        'Content-Type': 'application/json'
                    }
                });
                
                if (response.ok) {
                    dashboardData = await response.json();
                    bindDataToElements();
                    updateLastRefresh();
                    updateAIStatus('ready', 'Data updated');
                } else {
                    throw new Error('Failed to fetch data');
                }
            } catch (error) {
                console.error('Error fetching dashboard data:', error);
                updateAIStatus('error', 'Data fetch failed');
                // Use mock data for demo
                loadMockData();
            }
        }

        function loadMockData() {
            dashboardData = {
                students_reached: 285000,
                total_investment: 2400000,
                lives_per_grant: 5.8,
                literacy_improvement: 94,
                profile_completion: 65,
                last_update: '2 hours ago',
                new_partnerships: 12,
                underperforming_programs: 3,
                improvement_potential: 40,
                expansion_region: 'Nigeria',
                expansion_roi: 200,
                // Add more mock data as needed
            };
            bindDataToElements();
        }

        function bindDataToElements() {
            document.querySelectorAll('[data-bind]').forEach(element => {
                const bindingInfo = element.getAttribute('data-bind').split('|');
                const key = bindingInfo[0].trim();
                const format = bindingInfo[1]?.trim();
                
                if (dashboardData[key] !== undefined) {
                    const value = dashboardData[key];
                    element.textContent = formatValue(value, format);
                }
            });
        }

        function formatValue(value, format) {
            switch(format) {
                case 'number':
                    return value.toLocaleString();
                case 'currency':
                    return new Intl.NumberFormat('en-ZA', {
                        style: 'currency',
                        currency: 'ZAR'
                    }).format(value);
                case 'percentage':
                    return `${value}%`;
                default:
                    return value;
            }
        }

        // AI Integration Functions
        async function generateAIReport(reportType) {
            try {
                updateAIStatus('processing', 'Generating AI report...');
                
                // Get user profile data for personalization
                const profileContext = await getProfileContext();
                
                // Get Thunderbit crawled data
                const crawledData = await getCrawledData();
                
                // Generate report using nano-GPT-5
                const reportData = await callNanoGPT5(reportType, profileContext, crawledData);
                
                // Process payment if premium report
                if (isPremiumReport(reportType)) {
                    await processReportPayment(reportType, reportData);
                } else {
                    displayReport(reportData);
                }
                
                updateAIStatus('ready', 'Report generated');
            } catch (error) {
                console.error('Error generating AI report:', error);
                updateAIStatus('error', 'Report generation failed');
            }
        }

        async function callNanoGPT5(reportType, profileContext, crawledData) {
            const prompts = {
                'scalability-report': generateScalabilityPrompt(profileContext, crawledData),
                'esg-scorecard': generateESGPrompt(profileContext, crawledData),
                'impact-report': generateImpactPrompt(profileContext, crawledData),
                'fund-benchmarking': generateBenchmarkingPrompt(profileContext, crawledData),
                'lpg-metrics-dashboard': generateLPGPrompt(profileContext, crawledData),
                'stakeholder-engagement': generateStakeholderPrompt(profileContext, crawledData),
                'cross-sector-collaboration': generateCollaborationPrompt(profileContext, crawledData),
                // Add more prompts as needed
            };
            
            const prompt = prompts[reportType] || generateGenericPrompt(reportType, profileContext, crawledData);
            
            const response = await fetch(`${CONFIG.API_BASE_URL}${CONFIG.NANO_GPT5_ENDPOINT}`, {
                method: 'POST',
                headers: {
                    'Authorization': `Bearer ${getAuthToken()}`,
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                    prompt: prompt,
                    model: 'nano-gpt-5',
                    max_tokens: 4000,
                    temperature: 0.7,
                    response_format: 'json'
                })
            });
            
            if (!response.ok) {
                throw new Error('Failed to generate AI report');
            }
            
            return await response.json();
        }

        async function getCrawledData() {
            try {
                const website = profileData.website || 'auxeira.com';
                const response = await fetch(`${CONFIG.API_BASE_URL}${CONFIG.THUNDERBIT_ENDPOINT}`, {
                    method: 'POST',
                    headers: {
                        'Authorization': `Bearer ${getAuthToken()}`,
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        url: website,
                        focus_areas: profileData.focus_areas || 'education',
                        depth: 2,
                        include_related: true
                    })
                });
                
                if (response.ok) {
                    return await response.json();
                } else {
                    return { summary: 'No recent data available', content: [] };
                }
            } catch (error) {
                console.error('Error crawling data:', error);
                return { summary: 'Crawling failed', content: [] };
            }
        }

        // Prompt Generation Functions
        function generateScalabilityPrompt(profileContext, crawledData) {
            return `System: You are Auxeira's Scalability Strategist AI. Generate a report forecasting scalability of education initiatives, aligned with GRI and IRIS+ standards. JSON output: {title, scalability_summary (200 words), growth_matrix (array of {strategy, scale_potential (1-10), cost_estimate, timeline}), expansion_narrative (700 words), risk_factors (array of {risk, mitigation}), visuals (Chart.js configs)}.

User: For ${profileContext.org_name} (${profileContext.sector_type}), forecast scalability of ${profileContext.focus_areas} in ${profileContext.region}. Goals: ${profileContext.impact_goals}. Use crawled data: ${JSON.stringify(crawledData.summary)}. Align with SDG ${profileContext.sdg_alignment}. Narrative: How ${profileContext.org_name} can scale from current reach to 3x impact, cutting costs by 20% via partnerships. Include 3 growth strategies and risks. Project 3-year impact.`;
        }

        function generateESGPrompt(profileContext, crawledData) {
            return `System: You are Auxeira's ESG Analyst AI. Generate comprehensive ESG scorecard for education investments, aligned with SASB and GRI standards. JSON output: {title, esg_summary (150 words), environmental_score (0-100), social_score (0-100), governance_score (0-100), detailed_metrics (array), benchmark_comparison, improvement_recommendations (array), visuals (Chart.js configs)}.

User: Create ESG scorecard for ${profileContext.org_name} (${profileContext.sector_type}) focused on ${profileContext.focus_areas} in ${profileContext.region}. Annual spend: ${profileContext.annual_spend}. Use crawled insights: ${JSON.stringify(crawledData.summary)}. Compare against education fund benchmarks. Include environmental impact of digital infrastructure, social outcomes for beneficiaries, and governance transparency. Provide actionable improvement recommendations.`;
        }

        function generateImpactPrompt(profileContext, crawledData) {
            return `System: You are an ESG storyteller for Auxeira's Education Dashboard. Craft immersive, evidence-based narratives blending user goals with real-world impact. Use vivid language, anonymized case studies, and tie to SDGs. Output in JSON: {title, executive_summary (100 words), full_narrative (800 words), key_metrics (array), recommended_actions (array of 3 nudges), visuals (array of chart ideas)}.

User: Generate an Impact Story Report for ${profileContext.org_name} (${profileContext.sector_type}) focused on ${profileContext.focus_areas}. Their goals: ${profileContext.impact_goals}. Geography: ${profileContext.region}. Crawled data: ${JSON.stringify(crawledData.summary)}. Include policy angles. Weave in SDG ${profileContext.sdg_alignment}. Make it a story of transformation, e.g., a girl's journey empowered by their initiatives. End with ROI projection: 15% enrollment boost leading to economic value.`;
        }

        // Payment Processing
        async function processReportPayment(reportType, reportData) {
            const reportPrices = {
                'scalability-report': 19900, // R199 in cents
                'esg-scorecard': 14900,
                'impact-report': 14900,
                'fund-benchmarking': 29900,
                'lpg-metrics-dashboard': 24900,
                'stakeholder-engagement': 19900,
                'cross-sector-collaboration': 24900,
                'risk-adjusted-lpg': 39900,
                'policy-influence': 39900,
                'materiality-assessment': 32900,
                'cost-effectiveness': 34900,
                'compliance-report': 29900,
            };
            
            const amount = reportPrices[reportType] || 19900;
            
            const handler = PaystackPop.setup({
                key: CONFIG.PAYSTACK_PUBLIC_KEY,
                email: profileData.email || 'user@example.com',
                amount: amount,
                currency: 'ZAR',
                ref: `report_${reportType}_${Date.now()}`,
                metadata: {
                    report_type: reportType,
                    org_name: profileData.org_name,
                    user_id: getUserId()
                },
                callback: function(response) {
                    // Payment successful
                    console.log('Payment successful:', response);
                    displayReport(reportData);
                    trackReportPurchase(reportType, amount);
                },
                onClose: function() {
                    console.log('Payment cancelled');
                    updateAIStatus('ready', 'Payment cancelled');
                }
            });
            
            handler.openIframe();
        }

        function isPremiumReport(reportType) {
            const freeReports = ['executive-summary'];
            return !freeReports.includes(reportType);
        }

        // Profile Management
        async function loadProfileData() {
            try {
                const response = await fetch(`${CONFIG.API_BASE_URL}/profile`, {
                    headers: {
                        'Authorization': `Bearer ${getAuthToken()}`
                    }
                });
                
                if (response.ok) {
                    profileData = await response.json();
                    updateProfileUI();
                } else {
                    // Use default profile data
                    profileData = {
                        org_name: 'Your Organization',
                        profile_completion: 65,
                        sector_type: 'impact-fund',
                        region: 'Africa',
                        focus_areas: 'digital literacy, teacher training',
                        sdg_alignment: 'SDG4, SDG5',
                        annual_spend: '$2.4M',
                        impact_goals: 'Maximize literacy outcomes'
                    };
                }
            } catch (error) {
                console.error('Error loading profile:', error);
            }
        }

        function showProfileModal() {
            const modal = new bootstrap.Modal(document.getElementById('profileModal'));
            populateProfileForm();
            modal.show();
        }

        function populateProfileForm() {
            CONFIG.PROFILE_FIELDS.forEach(field => {
                const element = document.getElementById(field.replace('_', ''));
                if (element && profileData[field]) {
                    element.value = profileData[field];
                }
            });
        }

        async function saveProfile() {
            const formData = new FormData(document.getElementById('profileForm'));
            const profileUpdate = {};
            
            for (let [key, value] of formData.entries()) {
                profileUpdate[key] = value;
            }
            
            try {
                const response = await fetch(`${CONFIG.API_BASE_URL}/profile`, {
                    method: 'PUT',
                    headers: {
                        'Authorization': `Bearer ${getAuthToken()}`,
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(profileUpdate)
                });
                
                if (response.ok) {
                    profileData = { ...profileData, ...profileUpdate };
                    updateProfileUI();
                    bootstrap.Modal.getInstance(document.getElementById('profileModal')).hide();
                    
                    // Refresh dashboard data with new profile context
                    fetchDashboardData();
                }
            } catch (error) {
                console.error('Error saving profile:', error);
            }
        }

        function updateProfileProgress() {
            const form = document.getElementById('profileForm');
            const inputs = form.querySelectorAll('input, select, textarea');
            let completed = 0;
            
            inputs.forEach(input => {
                if (input.value.trim()) completed++;
            });
            
            const percentage = Math.round((completed / inputs.length) * 100);
            
            // Update progress bar
            const progressBar = form.querySelector('.progress-bar');
            if (progressBar) {
                progressBar.style.width = `${percentage}%`;
                progressBar.textContent = `${percentage}% Complete`;
            }
        }

        // Chart Initialization
        function initializeCharts() {
            initializeRegionChart();
            initializeLivesPerGrantChart();
            initializePreviewChart();
        }

        function initializeRegionChart() {
            const ctx = document.getElementById('regionChart');
            if (!ctx) return;
            
            new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: ['South Africa', 'Kenya', 'Nigeria', 'Ghana', 'Tanzania'],
                    datasets: [{
                        label: 'Students Reached',
                        data: [85000, 65000, 58000, 45000, 32000],
                        backgroundColor: [
                            'rgba(0, 212, 255, 0.8)',
                            'rgba(139, 92, 246, 0.8)',
                            'rgba(0, 255, 136, 0.8)',
                            'rgba(255, 215, 0, 0.8)',
                            'rgba(255, 107, 53, 0.8)'
                        ],
                        borderColor: [
                            'rgba(0, 212, 255, 1)',
                            'rgba(139, 92, 246, 1)',
                            'rgba(0, 255, 136, 1)',
                            'rgba(255, 215, 0, 1)',
                            'rgba(255, 107, 53, 1)'
                        ],
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            labels: {
                                color: '#ffffff'
                            }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                color: '#ffffff'
                            },
                            grid: {
                                color: 'rgba(255, 255, 255, 0.1)'
                            }
                        },
                        x: {
                            ticks: {
                                color: '#ffffff'
                            },
                            grid: {
                                color: 'rgba(255, 255, 255, 0.1)'
                            }
                        }
                    }
                }
            });
        }

        function initializeLivesPerGrantChart() {
            const ctx = document.getElementById('livesPerGrantChart');
            if (!ctx) return;
            
            new Chart(ctx, {
                type: 'line',
                data: {
                    labels: ['2021', '2022', '2023', '2024'],
                    datasets: [{
                        label: 'Lives-per-Grant',
                        data: [3.2, 4.1, 5.2, 5.8],
                        borderColor: 'rgba(0, 255, 136, 1)',
                        backgroundColor: 'rgba(0, 255, 136, 0.1)',
                        borderWidth: 3,
                        fill: true,
                        tension: 0.4
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            labels: {
                                color: '#ffffff'
                            }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                color: '#ffffff'
                            },
                            grid: {
                                color: 'rgba(255, 255, 255, 0.1)'
                            }
                        },
                        x: {
                            ticks: {
                                color: '#ffffff'
                            },
                            grid: {
                                color: 'rgba(255, 255, 255, 0.1)'
                            }
                        }
                    }
                }
            });
        }

        function initializePreviewChart() {
            const ctx = document.getElementById('previewChart');
            if (!ctx) return;
            
            new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: ['Literacy', 'STEM', 'Digital Skills'],
                    datasets: [{
                        data: [45, 30, 25],
                        backgroundColor: [
                            'rgba(0, 212, 255, 0.8)',
                            'rgba(139, 92, 246, 0.8)',
                            'rgba(0, 255, 136, 0.8)'
                        ]
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            display: false
                        }
                    }
                }
            });
        }

        // Time Range Management
        function toggleTimeRange(days) {
            currentTimeRange = days;
            
            // Update button states
            document.querySelectorAll('.time-toggle button').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
            
            // Refresh data with new time range
            fetchDashboardData();
        }

        // Utility Functions
        function updateAIStatus(status, message = '') {
            const statusElement = document.getElementById('aiStatus');
            const textElement = document.getElementById('aiStatusText');
            
            statusElement.className = `ai-status ${status}`;
            
            switch(status) {
                case 'ready':
                    textElement.textContent = message || 'AI Ready';
                    break;
                case 'processing':
                    textElement.textContent = message || 'AI Processing...';
                    break;
                case 'error':
                    textElement.textContent = message || 'AI Error';
                    break;
            }
        }

        function updateLastRefresh() {
            const now = new Date();
            const timeString = now.toLocaleTimeString();
            document.getElementById('lastUpdate').textContent = `Just now (${timeString})`;
        }

        function getAuthToken() {
            return localStorage.getItem('auth_token') || 'demo_token';
        }

        function getUserId() {
            return localStorage.getItem('user_id') || 'demo_user';
        }

        function refreshData() {
            fetchDashboardData();
        }

        function checkPremiumAccess() {
            // Check if user has premium access to show 5-year toggle
            const hasPremium = localStorage.getItem('premium_access') === 'true';
            if (hasPremium) {
                document.getElementById('timeToggle').style.display = 'flex';
            }
        }

        function trackReportPurchase(reportType, amount) {
            // Analytics tracking for report purchases
            if (typeof gtag !== 'undefined') {
                gtag('event', 'purchase', {
                    transaction_id: `report_${Date.now()}`,
                    value: amount / 100,
                    currency: 'ZAR',
                    items: [{
                        item_id: reportType,
                        item_name: `ESG Education Report - ${reportType}`,
                        category: 'Premium Reports',
                        quantity: 1,
                        price: amount / 100
                    }]
                });
            }
        }

        // Tab-specific data loading functions
        function loadOverviewData() {
            // Load overview-specific data
            console.log('Loading overview data...');
        }

        function loadOpportunityData() {
            // Load opportunity ripple data
            console.log('Loading opportunity data...');
        }

        function loadPortfolioData() {
            // Load portfolio data
            console.log('Loading portfolio data...');
        }

        function loadLeaderboardData() {
            // Load leaderboard data
            console.log('Loading leaderboard data...');
        }

        function loadCollaborationData() {
            // Load collaboration data
            console.log('Loading collaboration data...');
        }

        function loadReportsData() {
            // Load reports data
            console.log('Loading reports data...');
        }

        // Event handlers for interactive elements
        function viewOpportunityDetails(id) {
            console.log(`Viewing opportunity details for ID: ${id}`);
            // Implement opportunity details view
        }

        function viewCollaborationDetails(id) {
            console.log(`Viewing collaboration details for ID: ${id}`);
            // Implement collaboration details view
        }

        function viewFullCalendar() {
            console.log('Opening full calendar view');
            // Implement full calendar view
        }

        function viewNetworkAnalysis() {
            console.log('Opening network analysis');
            // Implement network analysis view
        }

        function displayReport(reportData) {
            console.log('Displaying report:', reportData);
            // Implement report display functionality
        }

        function updateProfileUI() {
            // Update profile-related UI elements
            const completionElement = document.querySelector('[data-bind="profile_completion"]');
            if (completionElement) {
                completionElement.textContent = profileData.profile_completion || 65;
            }
        }

        // Additional prompt generators for other report types
        function generateBenchmarkingPrompt(profileContext, crawledData) {
            return `System: You are Auxeira's Benchmarking Analyst AI. Generate comprehensive fund benchmarking report comparing education impact performance. JSON output: {title, benchmark_summary (200 words), peer_comparison (array of {fund_name, performance_score, key_metrics}), ranking_analysis, competitive_advantages (array), improvement_areas (array), visuals (Chart.js configs)}.

User: Benchmark ${profileContext.org_name} against global education funds with similar focus on ${profileContext.focus_areas} in ${profileContext.region}. Annual spend: ${profileContext.annual_spend}. Use market data and crawled insights: ${JSON.stringify(crawledData.summary)}. Compare Lives-per-Grant, cost efficiency, and impact scale. Identify competitive positioning and growth opportunities.`;
        }

        function generateLPGPrompt(profileContext, crawledData) {
            return `System: You are Auxeira's Lives-per-Grant Analyst AI. Generate detailed Lives-per-Grant metrics dashboard with optimization recommendations. JSON output: {title, lpg_summary (150 words), current_lpg_score, lpg_breakdown (array of {program, lpg_score, efficiency_rating}), optimization_strategies (array), projected_improvements, visuals (Chart.js configs)}.

User: Analyze Lives-per-Grant performance for ${profileContext.org_name} focused on ${profileContext.focus_areas} in ${profileContext.region}. Current investment: ${profileContext.annual_spend}. Use program data: ${JSON.stringify(crawledData.summary)}. Calculate LPG for each program, identify optimization opportunities, and project 12-month improvement scenarios. Include cost-effectiveness analysis.`;
        }

        function generateStakeholderPrompt(profileContext, crawledData) {
            return `System: You are Auxeira's Stakeholder Engagement Specialist AI. Generate stakeholder engagement analysis with actionable improvement strategies. JSON output: {title, engagement_summary (150 words), stakeholder_map (array of {group, engagement_score, influence_level, satisfaction}), engagement_strategies (array), communication_plan, success_metrics, visuals (Chart.js configs)}.

User: Analyze stakeholder engagement for ${profileContext.org_name} in ${profileContext.region} focusing on ${profileContext.focus_areas}. Key partners: ${profileContext.partners}. Use relationship data: ${JSON.stringify(crawledData.summary)}. Map all stakeholders (beneficiaries, partners, funders, government), assess engagement quality, and recommend improvement strategies. Include communication frequency and satisfaction metrics.`;
        }

        function generateCollaborationPrompt(profileContext, crawledData) {
            return `System: You are Auxeira's Collaboration Strategist AI. Generate cross-sector collaboration opportunities report with partnership recommendations. JSON output: {title, collaboration_summary (150 words), sector_opportunities (array of {sector, synergy_potential, partnership_ideas}), strategic_partnerships (array), implementation_roadmap, success_factors, visuals (Chart.js configs)}.

User: Identify cross-sector collaboration opportunities for ${profileContext.org_name} in ${profileContext.focus_areas} across ${profileContext.region}. Current partners: ${profileContext.partners}. Use market intelligence: ${JSON.stringify(crawledData.summary)}. Explore partnerships with tech companies, government agencies, other NGOs, and private sector. Focus on SDG ${profileContext.sdg_alignment} alignment and impact amplification.`;
        }

        function generateGenericPrompt(reportType, profileContext, crawledData) {
            return `System: You are Auxeira's AI Report Generator. Create a comprehensive ${reportType} report for education impact analysis. JSON output: {title, executive_summary (200 words), key_findings (array), recommendations (array), metrics (array), visuals (Chart.js configs)}.

User: Generate ${reportType} for ${profileContext.org_name} (${profileContext.sector_type}) focused on ${profileContext.focus_areas} in ${profileContext.region}. Goals: ${profileContext.impact_goals}. Use available data: ${JSON.stringify(crawledData.summary)}. Provide actionable insights and data-driven recommendations aligned with SDG ${profileContext.sdg_alignment}.`;
        }
    </script>
</body>
</html>
